(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[1],{"013f":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("q-layout",[i("q-page-container",[i("q-page",{staticClass:"flex flex-center login-page"},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.appUpdater.isLatest,expression:"appUpdater.isLatest"}],staticClass:"form-wrap"},[i("q-form",{staticClass:"q-gutter-sm",on:{submit:t.onLogin}},[i("div",{staticClass:"logo"}),t.requireEmail?i("div",[i("q-input",{attrs:{dark:"",color:"white",label:"Email",rules:[function(t){return t&&t.length>0||"Please input your email address"}]},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}})],1):i("div",[i("q-input",{attrs:{dark:"",color:"white",label:"Sitecode",type:"number",rules:[function(t){return t&&t>0||"Please input your sitecode"}]},model:{value:t.sitecode,callback:function(e){t.sitecode=e},expression:"sitecode"}}),i("q-input",{attrs:{dark:"",color:"white",label:"Encoded",type:"number",rules:[function(t){return t&&t>0||"Please input your encoded"}]},model:{value:t.encoded,callback:function(e){t.encoded=e},expression:"encoded"}}),i("q-input",{attrs:{dark:"",color:"white",label:"First Name",rules:[function(t){return t&&t.length>0||"Please input your first name"}]},model:{value:t.firstName,callback:function(e){t.firstName=e},expression:"firstName"}}),i("q-input",{attrs:{dark:"",color:"white",label:"Last Name",rules:[function(t){return t&&t.length>0||"Please input your last name"}]},model:{value:t.lastName,callback:function(e){t.lastName=e},expression:"lastName"}})],1),i("div",[i("q-btn",{staticClass:"full-width",attrs:{label:"Register",type:"submit",color:"white","text-color":"black"}})],1)]),i("div",{staticClass:"version"},[i("p",[t._v(t._s("Version: "+t.appUpdater.version))])])],1),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.appUpdater.isLatest,expression:"!appUpdater.isLatest"}]},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.appUpdater.isAndroid,expression:"appUpdater.isAndroid"}],staticStyle:{"text-align":"center"}},[i("h5",{staticStyle:{"margin-bottom":"0"}},[t._v(t._s(t.appUpdater.updateTitle))]),i("q-linear-progress",{staticStyle:{height:"20px"},attrs:{value:t.appUpdater.downloadProcessValue/100,rounded:""}},[i("div",{staticClass:"absolute-full flex flex-center"},[i("q-badge",{attrs:{color:"white","text-color":"accent",label:t.appUpdater.downloadProcessValue+"%"}})],1)])],1),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.appUpdater.isAndroid,expression:"!appUpdater.isAndroid"}],staticStyle:{"text-align":"center"}},[i("h5",{staticStyle:{"margin-bottom":"0"}},[t._v(t._s(t.appUpdater.updateTitle))]),i("q-linear-progress",{staticStyle:{height:"20px"},attrs:{value:t.appUpdater.downloadProcessValue/100,rounded:""}},[i("div",{staticClass:"absolute-full flex flex-center"},[i("q-badge",{attrs:{color:"white","text-color":"accent",label:t.appUpdater.downloadProcessValue+"%"}})],1)])],1)])])],1)],1)},a=[],o=i("2b0e"),n=i("bc3a"),r=i.n(n),d=i("9d10"),c=i("d257"),l=o["a"].extend({name:"Login",data(){return{sitecode:0,encoded:0,firstName:"",lastName:"",email:"",pk:"",photo:"",requireEmail:!1,appUpdater:{isLatest:!1,isAndroid:!1,updateTitle:"Checking new version ...",updateBaseUrl:"https://rciupdatetest.azurewebsites.net/RCAppsHome",appName:"VirtualKey",version:"1.0.0",downloadProcessValue:0}}},methods:{notifyError(t){this.$q.notify({type:"negative",message:t})},onLogin(){this.requireEmail?(this.$q.loading.show(),d["a"].UpdateEmail(this.pk,this.email).then(t=>{this.$q.loading.hide(),t.data.ok?(this.$store.commit("UserStore/SET_USER",{pk:this.pk,firstName:this.firstName,lastName:this.lastName,email:this.email,photo:this.photo}),this.$router.push({name:"Activate"})):this.notifyError(t.data.message)}).catch(t=>{this.$q.loading.hide(),this.notifyError(t.message)})):(this.$q.loading.show(),d["a"].Register({sitecode:this.sitecode,encoded:this.encoded,firstName:this.firstName,lastName:this.lastName}).then(t=>{this.$q.loading.hide(),t.data.ok?(c["a"].setAuthorization(t.data.authorization),0===t.data.entity.email.length?(this.pk=t.data.entity.pk,this.photo=t.data.entity.photo,this.requireEmail=!0):(this.$store.commit("UserStore/SET_USER",{pk:t.data.entity.pk,firstName:this.firstName,lastName:this.lastName,email:t.data.entity.email,photo:t.data.entity.photo}),this.$router.push({name:"Activate"}))):this.notifyError(t.data.message)}).catch(t=>{this.$q.loading.hide(),this.notifyError(t.message)}))},autoLogin(){const t=c["a"].getRemeberMe();if(!t)return;this.$q.loading.show();const e="D3000.VirtualKey",i=c["a"].getTicks().toString(),s=c["a"].encryptPassword(i,"7E57C707-F028-45C1-9F80-625A70A60D11");d["a"].Login({userId:e,password:s,ticks:i,pk:t}).then(e=>{this.$q.loading.hide(),e.data.ok&&(c["a"].setAuthorization(e.data.authorization),this.$store.commit("UserStore/SET_USER",{pk:t,firstName:e.data.entity.firstName,lastName:e.data.entity.lastName,email:e.data.entity.email,photo:e.data.entity.photo}),this.$router.replace({name:"Dashboard"}))}).catch(t=>{this.$q.loading.hide(),this.notifyError(t.message)})},checkVersion(t){this.$q.platform.is.android?this.appUpdater.isAndroid=!0:this.appUpdater.isAndroid=!1,this.appUpdater.isAndroid?this.checkAndroidVersion(e=>{e?this.updateApp():t()}):this.checkIOSVersion(e=>{e?this.updateApp():t()})},checkAndroidVersion(t){const e=`${this.appUpdater.updateBaseUrl}/${this.appUpdater.appName}/${this.appUpdater.appName}.txt`;r.a.get(e).then(e=>{const i=e.data.Version;i!=this.appUpdater.version?(this.appUpdater.updateTitle="Downloading new version...",t(!0)):t(!1)}).catch(t=>{this.showUpdateError(t.message)})},checkIOSVersion(t){const e=`${this.appUpdater.updateBaseUrl}/${this.appUpdater.appName}/${this.appUpdater.appName}.plist`;r.a.get(e).then(e=>{let i="";const s=e.data.split(/\r\n|[\r\n]/);for(let t=0;t<s.length;t++){const e=s[t];if(e.endsWith("<key>bundle-version</key>")&&t+1<s.length){const e=s[t+1].indexOf("<string>");i=s[t+1].substring(e+8,e+8+5)}}i.length>0&&i!=this.appUpdater.version?(this.appUpdater.updateTitle="Updating the App, please wait...",t(!0)):t(!1)}).catch(t=>{this.showUpdateError(t.message)})},updateApp(){if(this.appUpdater.isAndroid){const t=(new Date).getTime(),e=`${this.appUpdater.updateBaseUrl}/${this.appUpdater.appName}/${this.appUpdater.appName}.apk?v=${t}`;this.updateAndroid(e)}else{const t=`itms-services://?action=download-manifest&url=${this.appUpdater.updateBaseUrl}/${this.appUpdater.appName}/${this.appUpdater.appName}.plist`;this.updateIOS(t)}},updateAndroid(t){const e=this;window.resolveLocalFileSystemURL(cordova.file.externalDataDirectory,(function(i){i.getFile(e.appUpdater.appName+".apk",{create:!0,exclusive:!1},(function(i){r()({method:"GET",url:t,responseType:"blob",onDownloadProgress(t){t.lengthComputable&&e.$nextTick(()=>{e.appUpdater.downloadProcessValue=Math.round(t.loaded/t.total*100)})}}).then(t=>{const e=new Blob([t.data],{type:"application/vnd.android.package-archive"});i.createWriter((function(t){t.onwriteend=function(){cordova.plugins.fileOpener2.open(i.toInternalURL(),"application/vnd.android.package-archive")},t.write(e)}))}).catch(t=>{e.showUpdateError("download error: "+t.message)})}),t=>{e.showUpdateError("error getting file! "+t.message)})}),t=>{e.showUpdateError("error getting persistent fs! "+t.code)})},updateIOS(t){cordova.InAppBrowser.open(t,"_system","location=no"),this.simulateDownloadIOS()},simulateDownloadIOS(){setTimeout(()=>{this.appUpdater.downloadProcessValue>=100?cordova.plugins.exit():(this.$nextTick(()=>{this.appUpdater.downloadProcessValue+=10}),this.simulateDownloadIOS())},1e3)},showUpdateError(t){navigator.notification.alert(t,()=>{cordova.plugins.exit()})}},mounted(){this.appUpdater.isLatest=!0,this.autoLogin()}}),h=l,u=(i("a6ea"),i("2c53"),i("2877")),p=Object(u["a"])(h,s,a,!1,null,"51615297",null);e["default"]=p.exports},"0b74":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-layout",{attrs:{view:"lHh Lpr lFf"}},[s("q-header",{attrs:{elevated:""}},[s("q-toolbar",[s("q-btn",{attrs:{flat:"",dense:"",round:"",icon:"keyboard_backspace"},on:{click:t.onBack}}),s("q-toolbar-title",[t._v(t._s(t.title))]),s("q-btn",{attrs:{flat:"",dense:"",round:"",icon:"delete"},on:{click:t.onDeleteFavorite}})],1)],1),s("q-page-container",[s("q-page",t._l(t.list,(function(e,a){return s("q-list",{key:a,staticClass:"text-h6",attrs:{bordered:"",separator:""}},[s("q-slide-item",{attrs:{"left-color":"white"},on:{left:function(i){return t.onOpenDoor(e.pk,i)}},scopedSlots:t._u([{key:"left",fn:function(){return[s("q-avatar",{staticClass:"slide-icon",attrs:{color:"green",size:"xl"}},[s("img",{attrs:{src:i("6f8d"),draggable:"false"}})]),s("span",{staticClass:"open-door-name text-h6 text-black q-ml-md"},[t._v(t._s(e.name))])]},proxy:!0}],null,!0)},[s("q-item",[s("q-item-section",{attrs:{avatar:""}},[e.status?s("q-avatar",{staticClass:"green-lock",attrs:{color:"green","text-color":"white",icon:"lock_open"}}):s("q-avatar",{staticClass:"primary-lock",attrs:{color:"primary","text-color":"white",icon:"lock"}})],1),s("q-item-section",[t._v(t._s(e.name))]),s("q-item-section",{attrs:{side:""}},[s("q-item-label",{attrs:{caption:""}},[t._v("Open")]),s("q-item-section",{attrs:{avatar:""}},[s("q-avatar",{staticClass:"arrow",attrs:{rounded:""}},[s("img",{attrs:{src:i("c5d4")}})])],1)],1)],1)],1)],1)})),1)],1)],1)},a=[],o=i("2b0e"),n=i("d257"),r=i("fc00"),d=o["a"].extend({name:"FavoriteList",data(){return{title:"",cardPK:"",buildingPK:"",watchGPSID:0,list:new Array,idleTimebegin:0,idleTimeoutId:0}},methods:{notifyError(t){this.$q.notify({type:"negative",message:t})},startIdleTimout(){this.idleTimeoutId=window.setTimeout(()=>{this.doIdleWork()},1e3)},doIdleWork(){const t=Math.floor(((new Date).getTime()-this.idleTimebegin)/6e4);if(t>1)this.onBack();else{for(const t of this.list)if(t.status&&t.unLockBegin>0){const e=Math.floor(((new Date).getTime()-t.unLockBegin)/1e3);e>8&&(t.status=!1,t.reset());break}this.startIdleTimout()}},onBack(){this.$router.back()},getGPSPosition(t){try{this.$q.loading.show(),this.watchGPSID=navigator.geolocation.watchPosition(e=>{this.$q.platform.is.ios&&e.coords.accuracy>30||(navigator.geolocation.clearWatch(this.watchGPSID),this.$q.loading.hide(),t(e.coords.latitude,e.coords.longitude))},t=>{this.$q.loading.hide(),this.notifyError("The location service must be enabled.("+t.message+")"),this.onBack()},{maximumAge:6e4,timeout:3e4,enableHighAccuracy:!0})}catch(e){this.$q.loading.hide(),this.notifyError(e.message),this.onBack()}},getFavorite(t,e){this.$q.loading.show(),r["a"].GetList({cardPK:this.cardPK,buildingPK:this.buildingPK,latitude:t,longitude:e}).then(t=>{if(this.$q.loading.hide(),t.data.ok){this.title=t.data.address;for(const e of t.data.result)e.isUnLock?this.list.push({pk:e.pk,name:e.name,isUnLock:e.isUnLock,status:!0,unLockBegin:(new Date).getTime(),reset:()=>({})}):this.list.push({pk:e.pk,name:e.name,isUnLock:e.isUnLock,status:!1,unLockBegin:0,reset:()=>({})});this.idleTimebegin=(new Date).getTime(),this.startIdleTimout()}else this.notifyError(t.data.message),this.onBack()}).catch(t=>{this.$q.loading.hide(),this.notifyError(t.message),this.onBack()})},onOpenDoor(t,{reset:e}){this.idleTimebegin=(new Date).getTime();const i=this.getByPK(t);i&&!i.status?(this.$q.loading.show(),i.unLockBegin=0,i.reset=e,r["a"].OpenDoor(t,this.cardPK).then(t=>{this.$q.loading.hide(),this.idleTimebegin=(new Date).getTime(),t.data.ok?(i.status=!0,i.unLockBegin=(new Date).getTime()):(i.status=!1,e(),this.notifyError(t.data.message))}).catch(t=>{this.notifyError(t.message),this.$q.loading.hide(),i.status=!1,e(),this.idleTimebegin=(new Date).getTime()})):e()},getByPK(t){for(const e of this.list)if(e.pk===t)return e},onDeleteFavorite(){this.idleTimebegin=(new Date).getTime();const t=new Array;for(const s of this.list)t.push({label:s.name,value:s.pk});let e=0;const i=this.$q.dialog({title:"Delete from the favorite",message:"",options:{type:"checkbox",model:[],items:t},ok:{rounded:!0,icon:"done",size:"md"},cancel:{rounded:!0,color:"negative",icon:"clear",size:"md"},persistent:!0,maximized:!0}).onOk(t=>{if(t.length>0){const e=new Array;for(const i of t)e.push({pk:i});this.deleteFavorites(e)}}).onDismiss(()=>{clearTimeout(e)});e=window.setTimeout(()=>{i.hide()},3e4)},deleteFavorites(t){this.idleTimebegin=(new Date).getTime(),this.$q.loading.show(),r["a"].Remove(this.cardPK,t).then(e=>{if(this.$q.loading.hide(),this.idleTimebegin=(new Date).getTime(),e.data.ok)for(const i of t)for(let t=0;t<this.list.length;t++)this.list[t].pk===i.pk&&this.list.splice(t,1);else this.notifyError(e.data.message)}).catch(t=>{this.notifyError(t.message),this.$q.loading.hide(),this.idleTimebegin=(new Date).getTime()})}},mounted(){const t=this.$route.params.id;if(!t||t.length<32)return this.notifyError("The parameter does not valid."),void this.onBack();this.buildingPK=n["a"].decryptPK(t);const e=this.$store.getters["UserStore/GET_USER"];this.cardPK=e.pk,this.getGPSPosition((t,e)=>{this.getFavorite(t,e)})},beforeDestroy(){this.idleTimeoutId&&clearTimeout(this.idleTimeoutId)}}),c=d,l=(i("4a0f"),i("2877")),h=Object(l["a"])(c,s,a,!1,null,"1baae041",null);e["default"]=h.exports},"12a4":function(t,e,i){"use strict";var s=i("a063"),a=i.n(s);a.a},1386:function(t,e,i){},"1a47":function(t,e,i){"use strict";var s=i("39ed"),a=i.n(s);a.a},"24b6":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-layout",{attrs:{view:"lHh Lpr lFf"}},[s("q-header",{attrs:{elevated:""}},[s("q-toolbar",[s("q-btn",{attrs:{flat:"",dense:"",round:"",icon:"keyboard_backspace"},on:{click:t.onBack}}),s("q-toolbar-title",[t._v(t._s(t.title))]),t.isTempAccess?t._e():s("q-btn",{attrs:{flat:"",dense:"",round:"",icon:"star"},on:{click:t.onAddToFavorite}})],1)],1),s("q-page-container",[s("q-page",[s("div",{staticClass:"text row q-mt-lg q-mb-xs text-h5 font-weight-bold text-blue-grey-4 justify-center"},[t._v("\n        "+t._s(t.area)+"\n      ")]),t._l(t.list,(function(e,a){return s("q-list",{key:a,staticClass:"text-h6",attrs:{bordered:"",separator:""}},[s("q-slide-item",{attrs:{"left-color":"white"},on:{left:function(i){return t.onOpenDoor(e.pk,i)}},scopedSlots:t._u([{key:"left",fn:function(){return[s("q-avatar",{staticClass:"slide-icon",attrs:{color:"green",size:"xl"}},[s("img",{attrs:{src:i("6f8d"),draggable:"false"}})]),s("span",{staticClass:"open-door-name text-h6 text-black q-ml-md"},[t._v(t._s(e.name))])]},proxy:!0}],null,!0)},[s("q-item",[s("q-item-section",{attrs:{avatar:""}},[e.status?s("q-avatar",{staticClass:"green-lock",attrs:{size:"xl",color:"green"}},[s("img",{attrs:{src:i("6f8d"),draggable:"false"}})]):s("q-avatar",{staticClass:"primary-lock",attrs:{color:"primary","text-color":"white",icon:"lock",size:"xl"}})],1),s("q-item-section",[t._v(t._s(e.name))]),s("q-item-section",{attrs:{side:""}},[s("q-item-label",{attrs:{caption:""}},[t._v("Open")]),s("q-item-section",{attrs:{avatar:""}},[s("q-avatar",{staticClass:"arrow",attrs:{rounded:""}},[s("img",{attrs:{src:i("c5d4")}})])],1)],1)],1)],1)],1)}))],2)],1)],1)},a=[],o=i("2b0e"),n=i("d257"),r=i("2c75");class d{static GetListByCategory(t){return r["a"].post("BizDoor_GetListByCategory",t)}static GetListByReader(t){return r["a"].post("BizDoor_GetListByReader",t)}static GetListByTemp(t){return r["a"].post("BizDoor_GetListByTemp",t)}static OpenDoor(t,e){const i={doorPK:t,cardPK:e};return r["a"].post("BizDoor_OpenDoor",i)}}var c=i("fc00"),l=o["a"].extend({name:"DoorList",data(){return{title:"",area:"",cardPK:"",isCategory:!1,isTempAccess:!1,readerPK:"",categoryPK:"",buildingPK:"",watchGPSID:0,list:new Array,idleTimebegin:0,idleTimeoutId:0}},methods:{notifyError(t){this.$q.notify({type:"negative",message:t})},startIdleTimout(){this.idleTimeoutId=window.setTimeout(()=>{this.doIdleWork()},1e3)},doIdleWork(){const t=Math.floor(((new Date).getTime()-this.idleTimebegin)/6e4);if(t>1)this.onBack();else{for(const t of this.list)if(t.status&&t.unLockBegin>0){const e=Math.floor(((new Date).getTime()-t.unLockBegin)/1e3);e>8&&(t.status=!1,t.reset());break}this.startIdleTimout()}},onBack(){this.$router.back()},getGPSPosition(t){try{this.$q.loading.show(),this.watchGPSID=navigator.geolocation.watchPosition(e=>{this.$q.platform.is.ios&&e.coords.accuracy>30||(navigator.geolocation.clearWatch(this.watchGPSID),this.$q.loading.hide(),t(e.coords.latitude,e.coords.longitude))},t=>{this.$q.loading.hide(),this.notifyError("The location service must be enabled.("+t.message+")"),this.onBack()},{maximumAge:6e4,timeout:3e4,enableHighAccuracy:!0})}catch(e){this.$q.loading.hide(),this.notifyError(e.message),this.onBack()}},getListByReader(t,e){this.$q.loading.show(),d.GetListByReader({cardPK:this.cardPK,readerPK:this.readerPK,latitude:t,longitude:e}).then(t=>{if(this.$q.loading.hide(),t.data.ok){this.title=t.data.address,this.area=t.data.area;for(const e of t.data.result)e.isUnLock?this.list.push({pk:e.pk,name:e.name,status:!0,unLockBegin:(new Date).getTime(),reset:()=>({})}):this.list.push({pk:e.pk,name:e.name,status:!1,unLockBegin:0,reset:()=>({})});this.idleTimebegin=(new Date).getTime(),this.startIdleTimout()}else this.notifyError(t.data.message),this.onBack()}).catch(t=>{this.$q.loading.hide(),this.notifyError(t.message),this.onBack()})},getListByCategory(t,e){this.$q.loading.show(),d.GetListByCategory({cardPK:this.cardPK,categoryPK:this.categoryPK,latitude:t,longitude:e}).then(t=>{if(this.$q.loading.hide(),t.data.ok){this.title=t.data.address,this.area=t.data.area;for(const e of t.data.result)e.isUnLock?this.list.push({pk:e.pk,name:e.name,status:!0,unLockBegin:(new Date).getTime(),reset:()=>({})}):this.list.push({pk:e.pk,name:e.name,status:!1,unLockBegin:0,reset:()=>({})});this.idleTimebegin=(new Date).getTime(),this.startIdleTimout()}else this.notifyError(t.data.message),this.onBack()}).catch(t=>{this.$q.loading.hide(),this.notifyError(t.message),this.onBack()})},getListByTempAccess(t,e){this.$q.loading.show(),d.GetListByTemp({cardPK:this.cardPK,buildingPK:this.buildingPK,latitude:t,longitude:e}).then(t=>{if(this.$q.loading.hide(),t.data.ok){this.title=t.data.address,this.area="Temp Access List";for(const e of t.data.result)e.isUnLock?this.list.push({pk:e.pk,name:e.name,status:!0,unLockBegin:(new Date).getTime(),reset:()=>({})}):this.list.push({pk:e.pk,name:e.name,status:!1,unLockBegin:0,reset:()=>({})});this.idleTimebegin=(new Date).getTime(),this.startIdleTimout()}else this.notifyError(t.data.message),this.onBack()}).catch(t=>{this.$q.loading.hide(),this.notifyError(t.message),this.onBack()})},onOpenDoor(t,{reset:e}){this.idleTimebegin=(new Date).getTime();const i=this.getByPK(t);i&&!i.status?(this.$q.loading.show(),i.unLockBegin=0,i.reset=e,d.OpenDoor(t,this.cardPK).then(t=>{this.$q.loading.hide(),this.idleTimebegin=(new Date).getTime(),t.data.ok?(i.status=!0,i.unLockBegin=(new Date).getTime()):(i.status=!1,e(),this.notifyError(t.data.message))}).catch(t=>{this.notifyError(t.message),this.$q.loading.hide(),i.status=!1,e(),this.idleTimebegin=(new Date).getTime()})):e()},getByPK(t){for(const e of this.list)if(e.pk===t)return e},onAddToFavorite(){this.idleTimebegin=(new Date).getTime();const t=new Array;for(const s of this.list)t.push({label:s.name,value:s.pk});let e=0;const i=this.$q.dialog({title:"Add to favorite",message:"",options:{type:"checkbox",model:[],items:t},ok:{rounded:!0,icon:"done",size:"md"},cancel:{rounded:!0,color:"negative",icon:"clear",size:"md"},persistent:!0,maximized:!0}).onOk(t=>{if(t.length>0){const e=new Array;for(const i of t)e.push({pk:i});this.addFavorites(e)}}).onDismiss(()=>{clearTimeout(e)});e=window.setTimeout(()=>{i.hide()},3e4)},addFavorites(t){this.idleTimebegin=(new Date).getTime(),this.$q.loading.show(),c["a"].Add(this.cardPK,t).then(t=>{this.$q.loading.hide(),this.idleTimebegin=(new Date).getTime(),t.data.ok?this.$q.notify({type:"positive",message:"This has been added to your favorite."}):this.notifyError(t.data.message)}).catch(t=>{this.notifyError(t.message),this.$q.loading.hide(),this.idleTimebegin=(new Date).getTime()})}},mounted(){const t=this.$route.params.id;if(!t||t.length<32)return this.notifyError("The parameter does not valid."),void this.onBack();this.isCategory="category"===this.$route.params.type,this.isTempAccess="tempaccess"===this.$route.params.type,this.isCategory?this.categoryPK=n["a"].decryptPK(t):this.isTempAccess?this.buildingPK=n["a"].decryptPK(t):this.readerPK=n["a"].decryptPK(t);const e=this.$store.getters["UserStore/GET_USER"];this.cardPK=e.pk,this.getGPSPosition((t,e)=>{this.isCategory?this.getListByCategory(t,e):this.isTempAccess?this.getListByTempAccess(t,e):this.getListByReader(t,e)})},beforeDestroy(){this.idleTimeoutId&&clearTimeout(this.idleTimeoutId)}}),h=l,u=(i("12a4"),i("2877")),p=Object(u["a"])(h,s,a,!1,null,"1975a829",null);e["default"]=p.exports},"29af":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("q-layout",{attrs:{view:"lHh Lpr lFf"}},[i("q-header",{attrs:{elevated:""}},[i("q-toolbar",[i("q-btn",{attrs:{flat:"",dense:"",round:"",icon:"keyboard_backspace"},on:{click:t.onBack}}),i("q-toolbar-title",[t._v(t._s(t.title))]),i("q-btn",{attrs:{flat:"",dense:"",round:"",icon:"star"},on:{click:t.onAddToFavorite}})],1)],1),i("q-page-container",[i("q-page",[i("div",{staticClass:"text row q-mt-lg q-mb-xs text-h5 font-weight-bold text-blue-grey-4 justify-center"},[t._v("\n        "+t._s(t.area)+"\n      ")]),i("div",{staticClass:"row q-gutter-y-lg reverse-wrap button-wrapper justify-center"},t._l(t.list,(function(e,s){return i("div",{key:s,staticClass:"col-4"},[i("q-btn",{staticClass:"button text-subtitle1 text-weight-bold",class:{"button-active":e.status},attrs:{"text-color":"black",label:e.name},on:{click:function(i){return t.onOpenElevator(e.pk)}}})],1)})),0)])],1)],1)},a=[],o=i("2b0e"),n=i("d257"),r=i("2c75");class d{static GetListByCategory(t){return r["a"].post("BizElevator_GetListByCategory",t)}static GetListByReader(t){return r["a"].post("BizElevator_GetListByReader",t)}static OpenElevator(t,e){const i={doorPK:t,cardPK:e};return r["a"].post("BizElevator_OpenElevator",i)}}var c=i("fc00"),l=o["a"].extend({name:"ElevatorList",data(){return{title:"",area:"",cardPK:"",readerPK:"",categoryPK:"",watchGPSID:0,list:new Array,idleTimebegin:0,idleTimeoutId:0}},methods:{notifyError(t){this.$q.notify({type:"negative",message:t})},startIdleTimout(){this.idleTimeoutId=window.setTimeout(()=>{this.doIdleWork()},1e3)},doIdleWork(){const t=Math.floor(((new Date).getTime()-this.idleTimebegin)/6e4);if(t>1)this.onBack();else{for(const t of this.list)if(t.status&&t.unLockBegin>0){const e=Math.floor(((new Date).getTime()-t.unLockBegin)/1e3);e>8&&(t.status=!1);break}this.startIdleTimout()}},onBack(){this.$router.back()},getGPSPosition(t){try{this.$q.loading.show(),this.watchGPSID=navigator.geolocation.watchPosition(e=>{this.$q.platform.is.ios&&e.coords.accuracy>30||(navigator.geolocation.clearWatch(this.watchGPSID),this.$q.loading.hide(),t(e.coords.latitude,e.coords.longitude))},t=>{this.$q.loading.hide(),this.notifyError("The location service must be enabled.("+t.message+")"),this.onBack()},{maximumAge:6e4,timeout:3e4,enableHighAccuracy:!0})}catch(e){this.$q.loading.hide(),this.notifyError(e.message),this.onBack()}},getListByReader(t,e){this.$q.loading.show(),d.GetListByReader({cardPK:this.cardPK,readerPK:this.readerPK,latitude:t,longitude:e}).then(t=>{if(this.$q.loading.hide(),t.data.ok){this.title=t.data.address,this.area=t.data.area;for(const e of t.data.result)this.list.push({pk:e.pk,name:e.name,isUnLock:e.isUnLock,status:!1,unLockBegin:0});this.idleTimebegin=(new Date).getTime(),this.startIdleTimout()}else this.notifyError(t.data.message),this.onBack()}).catch(t=>{this.$q.loading.hide(),this.notifyError(t.message),this.onBack()})},getListByCategory(t,e){this.$q.loading.show(),d.GetListByCategory({cardPK:this.cardPK,categoryPK:this.categoryPK,latitude:t,longitude:e}).then(t=>{if(this.$q.loading.hide(),t.data.ok){this.title=t.data.address,this.area=t.data.area;for(const e of t.data.result)this.list.push({pk:e.pk,name:e.name,isUnLock:e.isUnLock,status:!1,unLockBegin:0});this.idleTimebegin=(new Date).getTime(),this.startIdleTimout()}else this.notifyError(t.data.message),this.onBack()}).catch(t=>{this.$q.loading.hide(),this.notifyError(t.message),this.onBack()})},onOpenElevator(t){this.idleTimebegin=(new Date).getTime();const e=this.getByPK(t);e&&!e.status&&(this.$q.loading.show(),e.unLockBegin=0,d.OpenElevator(t,this.cardPK).then(t=>{this.$q.loading.hide(),this.idleTimebegin=(new Date).getTime(),t.data.ok?(e.status=!0,e.unLockBegin=(new Date).getTime()):(e.status=!1,this.notifyError(t.data.message))}).catch(t=>{this.notifyError(t.message),this.$q.loading.hide(),e.status=!1,this.idleTimebegin=(new Date).getTime()}))},getByPK(t){for(const e of this.list)if(e.pk===t)return e},onAddToFavorite(){this.idleTimebegin=(new Date).getTime();const t=new Array;for(const s of this.list)t.push({label:s.name,value:s.pk});let e=0;const i=this.$q.dialog({title:"Add to favorite",message:"",options:{type:"checkbox",model:[],items:t},ok:{rounded:!0,icon:"done",size:"md"},cancel:{rounded:!0,color:"negative",icon:"clear",size:"md"},persistent:!0,maximized:!0}).onOk(t=>{if(t.length>0){const e=new Array;for(const i of t)e.push({pk:i});this.addFavorites(e)}}).onDismiss(()=>{clearTimeout(e)});e=window.setTimeout(()=>{i.hide()},3e4)},addFavorites(t){this.idleTimebegin=(new Date).getTime(),this.$q.loading.show(),c["a"].Add(this.cardPK,t).then(t=>{this.$q.loading.hide(),this.idleTimebegin=(new Date).getTime(),t.data.ok?this.$q.notify({type:"positive",message:"This been added to your favorite."}):this.notifyError(t.data.message)}).catch(t=>{this.notifyError(t.message),this.$q.loading.hide(),this.idleTimebegin=(new Date).getTime()})}},mounted(){const t=this.$route.params.id;if(!t||t.length<32)return this.notifyError("The parameter does not valid."),void this.onBack();let e=!1;e="category"===this.$route.params.type,e?this.categoryPK=n["a"].decryptPK(t):this.readerPK=n["a"].decryptPK(t);const i=this.$store.getters["UserStore/GET_USER"];this.cardPK=i.pk,this.getGPSPosition((t,i)=>{e?this.getListByCategory(t,i):this.getListByReader(t,i)})},beforeDestroy(){this.idleTimeoutId&&clearTimeout(this.idleTimeoutId)}}),h=l,u=(i("f1ab"),i("2877")),p=Object(u["a"])(h,s,a,!1,null,"481dc138",null);e["default"]=p.exports},"2b39":function(t,e,i){},"2c53":function(t,e,i){"use strict";var s=i("b47d"),a=i.n(s);a.a},"2c75":function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var s=i("bc3a"),a=i.n(s);a.a.defaults.timeout=5e4,a.a.defaults.baseURL="https://d3000apitest.azurewebsites.net/api/Virtualkey/",a.a.interceptors.request.use((function(t){const e=sessionStorage.getItem("D3000_VirtualKey_authorization")||"";return e&&(t.headers.Authorization="Basic "+e),t.url=t.url+"?access_token=73FBF94A-3F5E-7190-9252-95924D4DBBD1",t}),(function(t){return Promise.reject(t)})),a.a.interceptors.response.use((function(t){return t}),(function(t){return Promise.reject(t)}));class o{static post(t,e,i){return a.a.post(t,e,i)}}},"39ed":function(t,e,i){},"44ef":function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var s=i("2c75");class a{static GetAreaPeopleList(t,e,i){const a={buildingPK:t,latitude:e,longitude:i};return s["a"].post("BizBuilding_GetAreaPeopleList",a)}static GetBuildingList(t,e,i){const a={cardPK:t,latitude:e,longitude:i};return s["a"].post("BizBuilding_GetBuildingList",a)}static GetCategoryList(t,e,i){const a={buildingPK:t,latitude:e,longitude:i};return s["a"].post("BizBuilding_GetCategoryList",a)}}},"4a0f":function(t,e,i){"use strict";var s=i("9b81"),a=i.n(s);a.a},"5d64":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("q-layout",{attrs:{view:"lHh Lpr lFf"}},[i("q-header",{attrs:{elevated:""}},[i("q-toolbar",[i("q-btn",{attrs:{flat:"",dense:"",round:"",icon:"keyboard_backspace"},on:{click:t.onBack}}),i("q-toolbar-title",[t._v(t._s(t.title))])],1)],1),i("q-page-container",[i("q-page",t._l(t.list,(function(e,s){return i("q-list",{key:s,staticClass:"list"},[i("q-expansion-item",{staticClass:"text-h6 text-weight-regular",attrs:{group:"A",icon:"folder",label:e.category,"header-class":"text-primary","content-inset-level":.5}},t._l(e.children,(function(e,s){return i("q-list",{key:s},[i("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{clickable:""},on:{click:function(i){return t.onOpenCategory(e.pk,e.name,e.qrType)}}},[i("q-item-section",{attrs:{avatar:""}},[i("q-icon",{attrs:{name:"description",color:"primary"}})],1),i("q-item-section",[t._v(t._s(e.name))])],1),i("q-separator")],1)})),1),i("q-separator")],1)})),1)],1)],1)},a=[],o=i("2b0e"),n=i("d257"),r=i("44ef"),d=o["a"].extend({name:"Category",data(){return{title:"Reader List",buildingPK:"",watchGPSID:0,list:new Array,idleTimebegin:0,idleTimeoutId:0}},methods:{notifyError(t){this.$q.notify({type:"negative",message:t})},startIdleTimout(){this.idleTimeoutId=window.setTimeout(()=>{this.doIdleWork()},1e3)},doIdleWork(){const t=Math.floor(((new Date).getTime()-this.idleTimebegin)/6e4);t>1?this.onBack():this.startIdleTimout()},onBack(){this.$router.back()},getGPSPosition(t){try{this.$q.loading.show(),this.watchGPSID=navigator.geolocation.watchPosition(e=>{this.$q.platform.is.ios&&e.coords.accuracy>30||(navigator.geolocation.clearWatch(this.watchGPSID),this.$q.loading.hide(),t(e.coords.latitude,e.coords.longitude))},t=>{this.$q.loading.hide(),this.notifyError("The location service must be enabled.("+t.message+")"),this.onBack()},{maximumAge:6e4,timeout:3e4,enableHighAccuracy:!0})}catch(e){this.$q.loading.hide(),this.notifyError(e.message),this.onBack()}},getList(t,e){this.$q.loading.show(),r["a"].GetCategoryList(this.buildingPK,t,e).then(t=>{this.$q.loading.hide(),t.data.ok?(this.list=t.data.result,this.idleTimebegin=(new Date).getTime(),this.startIdleTimout()):(this.notifyError(t.data.message),this.onBack())}).catch(t=>{this.$q.loading.hide(),this.notifyError(t.message),this.onBack()})},onOpenCategory(t,e,i){this.idleTimebegin=(new Date).getTime();const s=n["a"].encryptPK(t);1===i?this.$router.push({name:"ElevatorList",params:{id:s,type:"category"}}):2===i?this.$router.push({name:"UpDownList",params:{id:s,type:"category"}}):this.$router.push({name:"DoorList",params:{id:s,type:"category"}})}},mounted(){const t=this.$route.params.id;if(!t||t.length<32)return this.notifyError("The parameter does not valid."),void this.onBack();this.buildingPK=n["a"].decryptPK(t),this.getGPSPosition((t,e)=>{this.getList(t,e)})},beforeDestroy(){this.idleTimeoutId&&clearTimeout(this.idleTimeoutId)}}),c=d,l=(i("1a47"),i("2877")),h=Object(l["a"])(c,s,a,!1,null,"3ef2f3ea",null);e["default"]=h.exports},"5d7e":function(t,e,i){t.exports=i.p+"img/dw_logo.d598e255.png"},"6f8d":function(t,e,i){t.exports=i.p+"img/unlock.6865d3f5.png"},7539:function(t,e,i){"use strict";var s=i("c9d3"),a=i.n(s);a.a},"7b4a":function(t,e,i){"use strict";var s=i("c912"),a=i.n(s);a.a},"80d1":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("q-layout",{attrs:{view:"lHh Lpr lFf"}},[i("q-header",{attrs:{elevated:""}},[i("q-toolbar",[i("q-btn",{attrs:{flat:"",dense:"",round:"",icon:"keyboard_backspace"},on:{click:t.onBack}}),i("q-toolbar-title",[t._v(t._s(t.title))]),i("q-btn",{attrs:{flat:"",dense:"",round:"",icon:"star"},on:{click:t.onAddToFavorite}})],1)],1),i("q-page-container",[i("q-page",[i("div",{staticClass:"text row q-mt-lg q-mb-xs text-h5 font-weight-bold text-blue-grey-4 justify-center"},[t._v("\n        "+t._s(t.area)+"\n      ")]),i("div",{staticClass:"column q-gutter-y-xl reverse-wrap justify-center items-center button-wrapper"},[t.upButton.pk.length>0?i("q-btn",{staticClass:"button",attrs:{color:t.upButton.status?"positive":"grey",icon:"arrow_drop_up"},on:{click:function(e){return t.onUp()}}}):t._e(),t.downButton.pk.length>0?i("q-btn",{staticClass:"button",attrs:{color:t.downButton.status?"positive":"grey",icon:"arrow_drop_down"},on:{click:function(e){return t.onDown()}}}):t._e()],1)])],1)],1)},a=[],o=i("2b0e"),n=i("d257"),r=i("2c75");class d{static GetListByCategory(t,e,i){const s={categoryPK:t,latitude:e,longitude:i};return r["a"].post("BizUpDown_GetListByCategory",s)}static GetListByReader(t){return r["a"].post("BizUpDown_GetListByReader",t)}static OpenUpDown(t,e){const i={doorPK:t,cardPK:e};return r["a"].post("BizUpDown_OpenUpDown",i)}}var c=i("fc00"),l=o["a"].extend({name:"UpDownList",data(){return{title:"",area:"",cardPK:"",panelPK:"",upId:"",downId:"",categoryPK:"",watchGPSID:0,downButton:{pk:"",status:!1,unLockBegin:0},upButton:{pk:"",status:!1,unLockBegin:0},idleTimebegin:0,idleTimeoutId:0}},methods:{notifyError(t){this.$q.notify({type:"negative",message:t})},startIdleTimout(){this.idleTimeoutId=window.setTimeout(()=>{this.doIdleWork()},1e3)},doIdleWork(){const t=Math.floor(((new Date).getTime()-this.idleTimebegin)/6e4);if(t>1)this.onBack();else{if(this.downButton.status&&this.downButton.unLockBegin>0){const t=Math.floor(((new Date).getTime()-this.downButton.unLockBegin)/1e3);t>8&&(this.downButton.status=!1)}if(this.upButton.status&&this.upButton.unLockBegin>0){const t=Math.floor(((new Date).getTime()-this.upButton.unLockBegin)/1e3);t>8&&(this.upButton.status=!1)}this.startIdleTimout()}},onBack(){this.$router.back()},getGPSPosition(t){try{this.$q.loading.show(),this.watchGPSID=navigator.geolocation.watchPosition(e=>{this.$q.platform.is.ios&&e.coords.accuracy>30||(navigator.geolocation.clearWatch(this.watchGPSID),this.$q.loading.hide(),t(e.coords.latitude,e.coords.longitude))},t=>{this.$q.loading.hide(),this.notifyError("The location service must be enabled.("+t.message+")"),this.onBack()},{maximumAge:6e4,timeout:3e4,enableHighAccuracy:!0})}catch(e){this.$q.loading.hide(),this.notifyError(e.message),this.onBack()}},getListByReader(t,e){this.$q.loading.show(),d.GetListByReader({panelPK:this.panelPK,up:this.upId,down:this.downId,latitude:t,longitude:e}).then(t=>{this.$q.loading.hide(),t.data.ok?(this.title=t.data.address,this.area=t.data.area,t.data.downPK.length>0&&(this.downButton.pk=t.data.downPK,this.downButton.status=!1,this.downButton.unLockBegin=0),t.data.upPK.length>1&&(this.upButton.pk=t.data.upPK,this.upButton.status=!1,this.upButton.unLockBegin=0),this.idleTimebegin=(new Date).getTime(),this.startIdleTimout()):(this.notifyError(t.data.message),this.onBack())}).catch(t=>{this.$q.loading.hide(),this.notifyError(t.message),this.onBack()})},getListByCategory(t,e){this.$q.loading.show(),d.GetListByCategory(this.categoryPK,t,e).then(t=>{this.$q.loading.hide(),t.data.ok?(this.title=t.data.address,this.area=t.data.area,t.data.downPK.length>0&&(this.downButton.pk=t.data.downPK,this.downButton.status=!1,this.downButton.unLockBegin=0),t.data.upPK.length>1&&(this.upButton.pk=t.data.upPK,this.upButton.status=!1,this.upButton.unLockBegin=0),this.idleTimebegin=(new Date).getTime(),this.startIdleTimout()):(this.notifyError(t.data.message),this.onBack())}).catch(t=>{this.$q.loading.hide(),this.notifyError(t.message),this.onBack()})},onDown(){this.idleTimebegin=(new Date).getTime(),this.downButton.status||(this.$q.loading.show(),this.downButton.unLockBegin=0,d.OpenUpDown(this.downButton.pk,this.cardPK).then(t=>{this.$q.loading.hide(),this.idleTimebegin=(new Date).getTime(),t.data.ok?(this.downButton.status=!0,this.downButton.unLockBegin=(new Date).getTime()):(this.downButton.status=!1,this.notifyError(t.data.message))}).catch(t=>{this.notifyError(t.message),this.$q.loading.hide(),this.downButton.status=!1,this.idleTimebegin=(new Date).getTime()}))},onUp(){this.idleTimebegin=(new Date).getTime(),this.upButton.status||(this.$q.loading.show(),this.upButton.unLockBegin=0,d.OpenUpDown(this.upButton.pk,this.cardPK).then(t=>{this.$q.loading.hide(),this.idleTimebegin=(new Date).getTime(),t.data.ok?(this.upButton.status=!0,this.upButton.unLockBegin=(new Date).getTime()):(this.upButton.status=!1,this.notifyError(t.data.message))}).catch(t=>{this.notifyError(t.message),this.$q.loading.hide(),this.upButton.status=!1,this.idleTimebegin=(new Date).getTime()}))},onAddToFavorite(){this.idleTimebegin=(new Date).getTime();const t=new Array;t.push({label:"Up",value:this.upButton.pk}),t.push({label:"Down",value:this.downButton.pk});let e=0;const i=this.$q.dialog({title:"Add to favorite",message:"",options:{type:"checkbox",model:[],items:t},ok:{rounded:!0,icon:"done",size:"md"},cancel:{rounded:!0,color:"negative",icon:"clear",size:"md"},persistent:!0,maximized:!0}).onOk(t=>{if(t.length>0){const e=new Array;for(const i of t)e.push({pk:i});this.addFavorites(e)}}).onDismiss(()=>{clearTimeout(e)});e=window.setTimeout(()=>{i.hide()},3e4)},addFavorites(t){this.idleTimebegin=(new Date).getTime(),this.$q.loading.show(),c["a"].Add(this.cardPK,t).then(t=>{this.$q.loading.hide(),this.idleTimebegin=(new Date).getTime(),t.data.ok?this.$q.notify({type:"positive",message:"This been added to your favorite."}):this.notifyError(t.data.message)}).catch(t=>{this.notifyError(t.message),this.$q.loading.hide(),this.idleTimebegin=(new Date).getTime()})}},mounted(){const t=this.$route.params.id;if(!t||t.length<32)return this.notifyError("The parameter does not valid."),void this.onBack();let e=!1;36===t.length?(this.panelPK=n["a"].decryptPK(t.substring(0,32)),this.downId=t.substring(32,34),this.upId=t.substring(34,36)):(this.categoryPK=n["a"].decryptPK(t),e="category"===this.$route.params.type);const i=this.$store.getters["UserStore/GET_USER"];this.cardPK=i.pk,this.getGPSPosition((t,i)=>{e?this.getListByCategory(t,i):this.getListByReader(t,i)})},beforeDestroy(){this.idleTimeoutId&&clearTimeout(this.idleTimeoutId)}}),h=l,u=(i("7b4a"),i("2877")),p=Object(u["a"])(h,s,a,!1,null,"5945d5e4",null);e["default"]=p.exports},"88fb":function(t,e,i){"use strict";var s=i("e202"),a=i.n(s);a.a},"9b81":function(t,e,i){},"9d10":function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var s=i("2c75");class a{static Activate(t,e){const i={email:t,verifyCode:e};return s["a"].post("BizLogin_Activate",i)}static GetCardInfo(t){const e={pk:t};return s["a"].post("BizLogin_GetCardInfo",e)}static Login(t){return s["a"].post("BizLogin_Login",t)}static Register(t){return s["a"].post("BizLogin_Register",t)}static SendVerifyCode(t){const e={email:t};return s["a"].post("BizLogin_SendVerifyCode",e)}static UpdateEmail(t,e){const i={pk:t,email:e};return s["a"].post("BizLogin_UpdateEmail",i)}}},a063:function(t,e,i){},a6ea:function(t,e,i){"use strict";var s=i("2b39"),a=i.n(s);a.a},a7e7:function(t,e,i){"use strict";var s=i("e1fc"),a=i.n(s);a.a},b47d:function(t,e,i){},c19d:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("q-layout",[i("q-page-container",[i("q-page",{staticClass:"flex flex-center bg-primary"},[i("div",[i("div",{staticClass:"input-content"},[i("input",{directives:[{name:"model",rawName:"v-model.trim.number",value:t.input1,expression:"input1",modifiers:{trim:!0,number:!0}}],ref:"input1",attrs:{type:"number",maxlength:"1"},domProps:{value:t.input1},on:{keydown:function(e){return t.keydown1(e)},keyup:function(e){return t.keyup1(e)},input:function(e){e.target.composing||(t.input1=t._n(e.target.value.trim()))},blur:function(e){return t.$forceUpdate()}}}),i("input",{directives:[{name:"model",rawName:"v-model.trim.number",value:t.input2,expression:"input2",modifiers:{trim:!0,number:!0}}],ref:"input2",attrs:{type:"number",maxlength:"1"},domProps:{value:t.input2},on:{keydown:function(e){return t.keydown2(e)},keyup:function(e){return t.keyup2(e)},input:function(e){e.target.composing||(t.input2=t._n(e.target.value.trim()))},blur:function(e){return t.$forceUpdate()}}}),i("input",{directives:[{name:"model",rawName:"v-model.trim.number",value:t.input3,expression:"input3",modifiers:{trim:!0,number:!0}}],ref:"input3",attrs:{type:"number",maxlength:"1"},domProps:{value:t.input3},on:{keydown:function(e){return t.keydown3(e)},keyup:function(e){return t.keyup3(e)},input:function(e){e.target.composing||(t.input3=t._n(e.target.value.trim()))},blur:function(e){return t.$forceUpdate()}}}),i("input",{directives:[{name:"model",rawName:"v-model.trim.number",value:t.input4,expression:"input4",modifiers:{trim:!0,number:!0}}],ref:"input4",attrs:{type:"number",maxlength:"1"},domProps:{value:t.input4},on:{keydown:function(e){return t.keydown4(e)},keyup:function(e){return t.keyup4(e)},input:function(e){e.target.composing||(t.input4=t._n(e.target.value.trim()))},blur:function(e){return t.$forceUpdate()}}}),i("input",{directives:[{name:"model",rawName:"v-model.trim.number",value:t.input5,expression:"input5",modifiers:{trim:!0,number:!0}}],ref:"input5",attrs:{type:"number",maxlength:"1"},domProps:{value:t.input5},on:{keydown:function(e){return t.keydown5(e)},keyup:function(e){return t.keyup5(e)},input:function(e){e.target.composing||(t.input5=t._n(e.target.value.trim()))},blur:function(e){return t.$forceUpdate()}}}),i("input",{directives:[{name:"model",rawName:"v-model.trim.number",value:t.input6,expression:"input6",modifiers:{trim:!0,number:!0}}],ref:"input6",attrs:{type:"number",maxlength:"1"},domProps:{value:t.input6},on:{keydown:function(e){return t.keydown6(e)},keyup:function(e){return t.keyup6(e)},input:function(e){e.target.composing||(t.input6=t._n(e.target.value.trim()))},blur:function(e){return t.$forceUpdate()}}})]),i("div",{staticClass:"resend text-center"},[i("p",{staticStyle:{color:"white"}},[t._v(t._s(t.email))]),i("q-btn",{attrs:{disable:t.timeoutSeconds>0,color:0===t.timeoutSeconds?"green":"dark",icon:"mail","icon-right":"send",label:0===t.timeoutSeconds?"Resend Verify code":"Resend Verify code ("+t.timeoutSeconds+")"},on:{click:t.onResendVerifyCode}})],1),i("div",{staticClass:"activate"},[i("q-btn",{staticClass:"full-width",attrs:{label:"Activate",type:"submit",color:"white","text-color":"black"},on:{click:t.onLogin}})],1)])])],1)],1)},a=[],o=i("2b0e"),n=i("9d10"),r=i("d257"),d=o["a"].extend({name:"Activate",data(){return{pk:"",email:"",input1:"",input2:"",input3:"",input4:"",input5:"",input6:"",timeoutSeconds:60}},methods:{notifyError(t){this.$q.notify({type:"negative",message:t})},onResendVerifyCode(){this.$q.loading.show(),n["a"].SendVerifyCode(this.email).then(t=>{this.$q.loading.hide(),t.data.ok?(this.timeoutSeconds=60,this.startResendTimout()):this.notifyError(t.data.message)}).catch(t=>{this.$q.loading.hide(),this.notifyError(t.message)})},onLogin(){if(0===this.input1.length||0===this.input2.length||0===this.input3.length||0===this.input4.length||0===this.input5.length||0===this.input6.length)return void this.notifyError("Please input the verify code firstly.");this.$q.loading.show();const t=this.input1+this.input2+this.input3+this.input4+this.input5+this.input6;n["a"].Activate(this.email,t).then(t=>{this.$q.loading.hide(),t.data.ok?(r["a"].setRemeberMe(this.pk),this.$router.replace({name:"Dashboard"})):this.notifyError(t.data.message)}).catch(t=>{this.$q.loading.hide(),this.notifyError(t.message)})},startResendTimout(){setTimeout(()=>{this.setResendTimout()},1e3)},setResendTimout(){this.timeoutSeconds-=1,this.timeoutSeconds>0&&this.startResendTimout()},keydown1(t){8===t.keyCode&&(this.input1.length>0?this.input1="":this.$nextTick(()=>{this.$refs.input1.focus(),this.input1=""}))},keydown2(t){8===t.keyCode&&(this.input2.length>0?this.input2="":this.$nextTick(()=>{this.$refs.input1.focus(),this.input1=""}))},keydown3(t){8===t.keyCode&&(this.input3.length>0?this.input3="":this.$nextTick(()=>{this.$refs.input2.focus(),this.input2=""}))},keydown4(t){8===t.keyCode&&(this.input4.length>0?this.input4="":this.$nextTick(()=>{this.$refs.input3.focus(),this.input3=""}))},keydown5(t){8===t.keyCode&&(this.input5.length>0?this.input5="":this.$nextTick(()=>{this.$refs.input4.focus(),this.input4=""}))},keydown6(t){8===t.keyCode&&(this.input6.length>0?this.input6="":this.$nextTick(()=>{this.$refs.input5.focus(),this.input5=""}))},keyup1(t){8!==t.keyCode&&this.$nextTick(()=>{this.$refs.input2.focus(),this.input1=this.input1.toString().slice(-1)})},keyup2(t){8!==t.keyCode&&this.$nextTick(()=>{this.$refs.input3.focus(),this.input2=this.input2.toString().slice(-1)})},keyup3(t){8!==t.keyCode&&this.$nextTick(()=>{this.$refs.input4.focus(),this.input3=this.input3.toString().slice(-1)})},keyup4(t){8!==t.keyCode&&this.$nextTick(()=>{this.$refs.input5.focus(),this.input4=this.input4.toString().slice(-1)})},keyup5(t){8!==t.keyCode&&this.$nextTick(()=>{this.$refs.input6.focus(),this.input5=this.input5.toString().slice(-1)})},keyup6(t){8!==t.keyCode&&this.$nextTick(()=>{this.$refs.input6.blur(),this.input6=this.input6.toString().slice(-1)})}},mounted(){const t=this.$store.getters["UserStore/GET_USER"];this.pk=t.pk,this.email=t.email,this.startResendTimout(),this.$refs.input1.focus()}}),c=d,l=(i("a7e7"),i("2877")),h=Object(l["a"])(c,s,a,!1,null,"dc2551b4",null);e["default"]=h.exports},c31d:function(t,e,i){},c5d4:function(t,e,i){t.exports=i.p+"img/arrow.85212db2.png"},c912:function(t,e,i){},c9d3:function(t,e,i){},d257:function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));class s{static setBuildingPK(t){sessionStorage.setItem("D3000_VirtualKey_BuildingPK",t)}static setBuildingAddress(t){sessionStorage.setItem("D3000_VirtualKey_BuildingAddress",t)}static getBuildingPK(){return sessionStorage.getItem("D3000_VirtualKey_BuildingPK")||""}static getBuildingAddress(){return sessionStorage.getItem("D3000_VirtualKey_BuildingAddress")||""}static setRemeberMe(t){localStorage.setItem("D3000_VirtualKey_key",t)}static getRemeberMe(){return localStorage.getItem("D3000_VirtualKey_key")||""}static clearRemeberMe(){localStorage.removeItem("D3000_VirtualKey_key")}static setAuthorization(t){sessionStorage.setItem("D3000_VirtualKey_authorization",t)}static getAuthorization(){return sessionStorage.getItem("D3000_VirtualKey_authorization")||""}static clearAuthorization(){sessionStorage.removeItem("D3000_VirtualKey_authorization")}static hasAuthorization(){const t=sessionStorage.getItem("D3000_VirtualKey_authorization")||"";return t.length>0}static getTicks(){const t=621355968e9,e=1e4;return t+(new Date).getTime()*e}static encryptPassword(t,e){const i=[];for(let s=0;s<e.length;s++)if(s<t.length){const a=e.charCodeAt(s)+t.charCodeAt(s)-35;i.push(a.toString())}else{const t=e.charCodeAt(s)+5;i.push(t.toString())}return i.join(" ")+" "}static encryptPK(t){return t.replace(/-/g,"")}static decryptPK(t){if(32!==t.length)return t;let e=t.substring(0,8);return e+="-",e+=t.substring(8,12),e+="-",e+=t.substring(12,16),e+="-",e+=t.substring(16,20),e+="-",e+=t.substring(20),e}}},d314:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("q-layout",{attrs:{view:"lHh Lpr lFf"}},[i("q-header",{attrs:{elevated:""}},[i("q-toolbar",[i("q-btn",{attrs:{flat:"",dense:"",round:"",icon:"keyboard_backspace"},on:{click:t.onBack}}),i("q-toolbar-title",[t._v(t._s(t.title))])],1)],1),i("q-page-container",[i("q-page",t._l(t.list,(function(e,s){return i("q-list",{key:s,staticClass:"text-h6",attrs:{bordered:"",separator:""}},[i("q-item",[i("q-item-section",[i("q-item-label",[t._v(t._s(e.area))]),i("q-item-label",{attrs:{caption:""}},[t._v(t._s(e.currentTotal+"/"+e.restrictTotal))])],1),i("q-item-section",{attrs:{avatar:""}},[i("q-linear-progress",{staticClass:"q-mt-sm",attrs:{size:"30px",value:e.percent,color:e.color}},[i("div",{staticClass:"absolute-full flex flex-center"},[i("q-badge",{attrs:{color:"white","text-color":"accent",label:(100*e.percent).toFixed()+"%"}})],1)])],1)],1)],1)})),1)],1)],1)},a=[],o=i("2b0e"),n=i("d257"),r=i("44ef"),d=o["a"].extend({name:"AreaDensity",data(){return{title:"Area Density",buildingPK:"",watchGPSID:0,list:new Array,idleTimebegin:0,idleTimeoutId:0}},methods:{notifyError(t){this.$q.notify({type:"negative",message:t})},startIdleTimout(){this.idleTimeoutId=window.setTimeout(()=>{this.doIdleWork()},1e3)},doIdleWork(){const t=Math.floor(((new Date).getTime()-this.idleTimebegin)/6e4);t>1?this.onBack():this.startIdleTimout()},onBack(){this.$router.back()},getGPSPosition(t){try{this.$q.loading.show(),this.watchGPSID=navigator.geolocation.watchPosition(e=>{this.$q.platform.is.ios&&e.coords.accuracy>30||(navigator.geolocation.clearWatch(this.watchGPSID),this.$q.loading.hide(),t(e.coords.latitude,e.coords.longitude))},t=>{this.$q.loading.hide(),this.notifyError("The location service must be enabled.("+t.message+")"),this.onBack()},{maximumAge:6e4,timeout:3e4,enableHighAccuracy:!0})}catch(e){this.$q.loading.hide(),this.notifyError(e.message),this.onBack()}},getAreaDensity(t,e){this.$q.loading.show(),r["a"].GetAreaPeopleList(this.buildingPK,t,e).then(t=>{if(this.$q.loading.hide(),t.data.ok){for(const e of t.data.result){const t=e.currentTotal/e.restrictTotal,i={area:e.area,restrictTotal:e.restrictTotal,currentTotal:e.currentTotal,percent:t,color:"green"};i.color=t<.5?"green":t>=.5&&t<=.8?"yellow":"red",this.list.push(i)}this.idleTimebegin=(new Date).getTime(),this.startIdleTimout()}else this.notifyError(t.data.message),this.onBack()}).catch(t=>{this.$q.loading.hide(),this.notifyError(t.message),this.onBack()})}},mounted(){const t=this.$route.params.id;if(!t||t.length<32)return this.notifyError("The parameter does not valid."),void this.onBack();this.buildingPK=n["a"].decryptPK(t),this.getGPSPosition((t,e)=>{this.getAreaDensity(t,e)})},beforeDestroy(){this.idleTimeoutId&&clearTimeout(this.idleTimeoutId)}}),c=d,l=(i("da44"),i("2877")),h=Object(l["a"])(c,s,a,!1,null,"7907c750",null);e["default"]=h.exports},da44:function(t,e,i){"use strict";var s=i("1386"),a=i.n(s);a.a},e1fc:function(t,e,i){},e202:function(t,e,i){},ec95:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-layout",{attrs:{view:"lHh Lpr lFf"}},[s("q-header",{attrs:{elevated:""}},[s("q-toolbar",[s("q-btn",{attrs:{flat:"",dense:"",round:"",icon:"menu"},on:{click:function(e){t.leftDrawerOpen=!t.leftDrawerOpen}}}),s("q-toolbar-title",[t._v(t._s(t.title))]),s("q-btn",{attrs:{flat:"",dense:"",round:"",icon:"gps_fixed"},on:{click:t.onSearchBuilding}})],1)],1),s("q-footer",{attrs:{elevated:""}},[s("q-toolbar",{staticClass:"row justify-around bg-primary text-white"},[s("q-btn",{attrs:{flat:"",dense:"",stack:"",icon:"dashboard",label:"Reader"},on:{click:t.onCategoryList}}),s("q-btn",{staticClass:"bicode",attrs:{flat:"",dense:"",stack:"",icon:"camera",label:"QRCode"},on:{click:t.onScanReader}}),s("q-btn",{attrs:{flat:"",dense:"",stack:"",icon:"star",label:"Favorite"},on:{click:t.onFavorite}})],1)],1),s("q-drawer",{ref:"drawer",attrs:{"show-if-above":"",bordered:"","content-class":"bg-primary text-white"},model:{value:t.leftDrawerOpen,callback:function(e){t.leftDrawerOpen=e},expression:"leftDrawerOpen"}},[s("q-list",[s("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{clickable:""},on:{click:t.onLogout}},[s("q-item-section",{attrs:{avatar:""}},[s("q-icon",{attrs:{name:"person"}})],1),s("q-item-section",[s("q-item-label",[t._v("Logout")])],1)],1)],1)],1),s("q-page-container",[s("q-page",{staticClass:"flex text-center bg-grey-1"},[s("div",{staticStyle:{width:"100%"}},[s("div",{staticClass:"bg"},[s("img",{staticStyle:{"margin-top":"20px"},attrs:{src:i("5d7e")}})]),t.photo&&t.photo.length>0?s("q-avatar",{staticClass:"photo",attrs:{size:"80px"}},[s("img",{attrs:{src:"data:image/jpeg;base64,"+t.photo}})]):s("q-avatar",{staticClass:"photo",attrs:{icon:"person",color:"white","text-color":"blue-grey-2",size:"80px"}}),s("h6",{staticClass:"text-blue-grey-4"},[t._v("Welcome")]),s("h4",{staticClass:"text-grey-9",staticStyle:{"margin-bottom":"20px"}},[t._v("\n          "+t._s(t.firstName+" "+t.lastName)+"\n        ")]),s("div",[s("q-btn",{attrs:{flat:"",dense:"",stack:"",icon:"people",label:"Area Density"},on:{click:t.onAreaDensity}}),s("q-btn",{attrs:{flat:"",dense:"",stack:"",icon:"schedule",label:"Temp Access"},on:{click:t.onTempAccess}})],1)],1)])],1)],1)},a=[],o=i("2b0e"),n=i("b178");class r{static scanQRCode(t){n["b"].is.cordova?cordova.plugins.barcodeScanner.scan(e=>{e.cancelled||t(e.text)},t=>{r.showError("Scanning failed: "+t.message)},{preferFrontCamera:!1,showFlipCameraButton:!0,showTorchButton:!0,torchOn:!1,saveHistory:!0,prompt:"Place a barcode inside the scan area",resultDisplayDuration:500,formats:"QR_CODE",orientation:"portrait",disableAnimations:!0,disableSuccessBeep:!1}):r.showError("Scanning must be in mobile.")}static takePicture(t){n["b"].is.cordova?r.takePictureByCordova(t):n["b"].is.desktop?r.takePictureByDesktop(t):r.takePictureByMobile(t)}static showError(t){n["a"].create({title:"Error",message:t})}static takePictureByCordova(t){const e=navigator.camera;e?e.getPicture(t,()=>{},{quality:45,destinationType:0,sourceType:1,allowEdit:!0,encodingType:0,targetWidth:250,targetHeight:250}):r.showError("The camera does not exist in the cordova.")}static takePictureByDesktop(t){const e=document.createElement("input");e.setAttribute("type","file"),e.setAttribute("accept","image/*;capture=camera"),e.addEventListener("change",e=>{const i=e.currentTarget;if(!i||!i.files)return;const s=i.files[0];if(!s)return;const a=new FileReader;a.addEventListener("load",e=>{if(!e.target||!e.target.result)return;const i=e.target.result,s=document.createElement("canvas"),a=document.createElement("img");a.addEventListener("error",()=>{alert("Fail to load image(desktop).")}),a.addEventListener("load",()=>{const e=250;s.width=e,s.height=e;const i=s.getContext("2d");if(!i)return;let o,n;i.clearRect(0,0,e,e);let r=0,d=0;a.width>a.height?(o=Math.round(e*a.width/a.height),n=e,r=-Math.round((o-e)/2)):(n=Math.round(e*a.height/a.width),o=e,d=-Math.round((n-e)/2)),i.drawImage(a,r,d,o,n);const c=s.toDataURL("image/jpeg",.5),l=c.substr(23);t(l)},!1),a.setAttribute("src",i)}),a.readAsDataURL(s)}),e.click()}static takePictureByMobile(t){const e=document.createElement("input");e.setAttribute("type","file"),e.setAttribute("accept","image/*;capture=camera"),e.addEventListener("change",e=>{const i=e.currentTarget;if(!i||!i.files)return;const s=i.files[0];if(!s)return;const a=document.createElement("img");a.addEventListener("error",()=>{alert("Fail to load image(mobile).")}),a.addEventListener("load",()=>{window.URL.revokeObjectURL(a.src);const e=document.createElement("canvas"),i=250;e.width=i,e.height=i;const s=e.getContext("2d");if(!s)return;let o,n;s.clearRect(0,0,i,i);let r=0,d=0;a.width>a.height?(o=Math.round(i*a.width/a.height),n=i,r=-Math.round((o-i)/2)):(n=Math.round(i*a.height/a.width),o=i,d=-Math.round((n-i)/2)),s.drawImage(a,r,d,o,n);const c=e.toDataURL("image/jpeg",.5),l=c.substr(23);t(l)},!1),a.setAttribute("src",window.URL.createObjectURL(s))}),e.click()}}var d=i("d257"),c=i("9d10"),l=i("44ef"),h=o["a"].extend({name:"Dashboard",data(){return{leftDrawerOpen:!1,title:"Home",watchGPSID:0,local:{pk:"",address:""},cardPK:"",firstName:"",lastName:"",photo:"",navigateTo:""}},methods:{notifyError(t){this.$q.notify({type:"negative",message:t})},onLogout(){sessionStorage.clear(),localStorage.clear(),this.$router.push({name:"Login"})},getCardInfo(){const t=d["a"].getRemeberMe();t?(this.$q.loading.show(),c["a"].GetCardInfo(t).then(e=>{this.$q.loading.hide(),e.data.ok?(this.$store.commit("UserStore/SET_USER",{pk:t,firstName:e.data.entity.firstName,lastName:e.data.entity.lastName,email:e.data.entity.email,photo:e.data.entity.photo}),this.onSearchBuilding()):(this.notifyError(e.data.message),this.$router.replace({name:"Login"}))}).catch(t=>{this.$q.loading.hide(),this.notifyError(t.message),this.$router.replace({name:"Login"})})):this.$router.replace({name:"Login"})},onAreaDensity(){0!==this.local.pk.length?this.$router.push({name:"AreaDensity",params:{id:this.local.pk}}):this.notifyError("You are not in any buildings.")},onTempAccess(){0!==this.local.pk.length?this.$router.push({name:"DoorList",params:{id:this.local.pk,type:"tempaccess"}}):this.notifyError("You are not in any buildings.")},getGPSPosition(t){try{this.$q.loading.show(),this.watchGPSID=navigator.geolocation.watchPosition(e=>{this.$q.platform.is.ios&&e.coords.accuracy>30||(navigator.geolocation.clearWatch(this.watchGPSID),this.$q.loading.hide(),t(e.coords.latitude,e.coords.longitude))},t=>{this.$q.loading.hide(),this.notifyError("The location service must be enabled.("+t.message+")")},{maximumAge:6e4,timeout:3e4,enableHighAccuracy:!0})}catch(e){this.$q.loading.hide(),this.notifyError(e.message)}},onSearchBuilding(){this.getGPSPosition((t,e)=>{this.getBuildingList(t,e)})},getBuildingList(t,e){this.$q.loading.show(),l["a"].GetBuildingList(this.cardPK,t,e).then(t=>{this.$q.loading.hide(),t.data.ok?this.selectBuilding(t.data.result):this.notifyError(t.data.message)}).catch(t=>{this.$q.loading.hide(),this.notifyError(t.message)})},selectBuilding(t){if(0===t.length)return this.notifyError("You are not in any buildings."),this.local.pk="",this.local.address="",d["a"].setBuildingPK(""),d["a"].setBuildingAddress(""),void(this.title="Home");if(1===t.length)return this.local.pk=t[0].pk,this.local.address=t[0].address,d["a"].setBuildingPK(this.local.pk),d["a"].setBuildingAddress(this.local.address),void(this.title=this.local.address);const e=new Array;for(const i of t)e.push({label:i.address,value:i.pk});this.$q.dialog({title:"Select a building",message:"",options:{type:"radio",model:e[0].value,items:e},cancel:!1,persistent:!0}).onOk(t=>{for(const i of e)i.value===t&&(this.local.pk=i.value,this.local.address=i.label,d["a"].setBuildingPK(this.local.pk),d["a"].setBuildingAddress(this.local.address),this.title=this.local.address)})},onCategoryList(){0!==this.local.pk.length?this.$router.push({name:"Category",params:{id:this.local.pk}}):this.notifyError("You are not in any buildings.")},onFavorite(){0!==this.local.pk.length?this.$router.push({name:"FavoriteList",params:{id:this.local.pk}}):this.notifyError("You are not in any buildings.")},onScanReader(){if(this.$q.platform.is.cordova)r.scanQRCode(t=>{const e=t.lastIndexOf("/"),i=t.substring(e+1);this.scanReader(i)});else{const t="https://d3000disttest.azurewebsites.net/VisitorScan/#/ReaderDetail/35A24C3EE6DF429886CCFE42F7DC4AEB1",e=t.lastIndexOf("/"),i=t.substring(e+1);this.scanReader(i)}},scanReader(t){if(t.length<33)return;const e=t.substring(32,33),i=t.substring(0,32);switch(e){case"1":this.$router.push({name:"ElevatorList",params:{id:i}});break;case"2":{if(t.length<37)return void this.notifyError("The parameter does not valid.");const e=t.substring(33,35),s=t.substring(35,37);this.$router.push({name:"UpDownList",params:{id:i+e+s}})}break;default:this.$router.push({name:"DoorList",params:{id:i}});break}}},mounted(){const t=this.$store.getters["UserStore/GET_USER"];t.pk?(this.cardPK=t.pk,this.firstName=t.firstName,this.lastName=t.lastName,this.photo=t.photo,this.local.pk=d["a"].getBuildingPK(),this.local.address=d["a"].getBuildingAddress(),this.local.pk?this.title=this.local.address:this.onSearchBuilding()):this.getCardInfo()}}),u=h,p=(i("7539"),i("88fb"),i("2877")),g=Object(p["a"])(u,s,a,!1,null,"152244eb",null);e["default"]=g.exports},f1ab:function(t,e,i){"use strict";var s=i("c31d"),a=i.n(s);a.a},fc00:function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var s=i("2c75");class a{static Add(t,e){const i={cardPK:t,doors:e};return s["a"].post("BizFavorite_Add",i)}static GetList(t){return s["a"].post("BizFavorite_GetList",t)}static OpenDoor(t,e){const i={doorPK:t,cardPK:e};return s["a"].post("BizFavorite_OpenDoor",i)}static Remove(t,e){const i={cardPK:t,doors:e};return s["a"].post("BizFavorite_Remove",i)}}}}]);