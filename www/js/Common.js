(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[1],{"013f":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("q-layout",[i("q-page-container",[i("q-page",{staticClass:"flex flex-center login-page"},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.appUpdater.isLatest,expression:"appUpdater.isLatest"}],staticClass:"form-wrap"},[i("q-form",{staticClass:"q-gutter-sm",on:{submit:t.onLogin}},[i("div",{staticClass:"logo"}),t.requireEmail?i("div",[i("q-input",{attrs:{dark:"",color:"white",label:"Email",rules:[function(t){return t&&t.length>0||"Please enter your email address"}]},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}})],1):i("div",[i("q-input",{attrs:{dark:"",color:"white",label:"Sitecode",type:"number",rules:[function(t){return t&&t>0||"Please enter put your sitecode"}]},model:{value:t.sitecode,callback:function(e){t.sitecode=e},expression:"sitecode"}}),i("q-input",{attrs:{dark:"",color:"white",label:"Embossed",type:"number",rules:[function(t){return t&&t>0||"Please enter your encoded"}]},model:{value:t.encoded,callback:function(e){t.encoded=e},expression:"encoded"}}),i("q-input",{attrs:{dark:"",color:"white",label:"First Name",rules:[function(t){return t&&t.length>0||"Please enter your first name"}]},model:{value:t.firstName,callback:function(e){t.firstName=e},expression:"firstName"}}),i("q-input",{attrs:{dark:"",color:"white",label:"Last Name",rules:[function(t){return t&&t.length>0||"Please enter your last name"}]},model:{value:t.lastName,callback:function(e){t.lastName=e},expression:"lastName"}})],1),i("div",[i("q-btn",{staticClass:"full-width",attrs:{label:"Register",type:"submit",color:"white","text-color":"black"}})],1)]),i("div",{staticClass:"version"},[i("p",[t._v(t._s("Version: "+t.appUpdater.version))])])],1),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.appUpdater.isLatest,expression:"!appUpdater.isLatest"}]},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.appUpdater.isAndroid,expression:"appUpdater.isAndroid"}],staticStyle:{"text-align":"center"}},[i("h5",{staticStyle:{color:"#fff","margin-bottom":"0"}},[t._v("\n            "+t._s(t.appUpdater.updateTitle)+"\n          ")]),i("q-linear-progress",{staticStyle:{height:"25px"},attrs:{value:t.appUpdater.downloadProcessValue/100,rounded:""}},[i("div",{staticClass:"absolute-full flex flex-center"},[i("q-badge",{attrs:{color:"white","text-color":"primary",label:t.appUpdater.downloadProcessValue+"%"}})],1)])],1),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.appUpdater.isAndroid,expression:"!appUpdater.isAndroid"}],staticStyle:{"text-align":"center"}},[i("h5",{staticStyle:{color:"#fff","margin-bottom":"0"}},[t._v("\n            "+t._s(t.appUpdater.updateTitle)+"\n          ")]),i("q-linear-progress",{staticStyle:{height:"25px"},attrs:{value:t.appUpdater.downloadProcessValue/100,rounded:""}},[i("div",{staticClass:"absolute-full flex flex-center"},[i("q-badge",{attrs:{color:"white","text-color":"primary",label:t.appUpdater.downloadProcessValue+"%"}})],1)])],1)])])],1)],1)},a=[],o=i("2b0e"),r=i("bc3a"),n=i.n(r),l=i("9d10"),d=i("d257"),c=o["a"].extend({name:"Login",data(){return{sitecode:"",encoded:"",firstName:"",lastName:"",email:"",pk:"",photo:"",requireEmail:!1,appUpdater:{isLatest:!1,isAndroid:!1,updateTitle:"Checking new version ...",updateBaseUrl:"https://rciupdatetest.azurewebsites.net/RCAppsHome",appName:"DirectConnect",version:"1.0.0",downloadProcessValue:0}}},methods:{notifyError(t){this.$q.notify({type:"negative",message:t})},onLogin(){const t=Number.parseInt(this.sitecode),e=Number.parseInt(this.encoded);this.requireEmail?(this.$q.loading.show(),l["a"].UpdateEmail(this.pk,this.email).then(i=>{this.$q.loading.hide(),i.data.ok?(this.$store.commit("UserStore/SET_USER",{pk:this.pk,sitecode:t,encoded:e,firstName:this.firstName,lastName:this.lastName,email:this.email,photo:this.photo}),this.$router.replace({name:"Activate"})):this.notifyError(i.data.message)}).catch(t=>{this.$q.loading.hide(),this.notifyError(t.message)})):(this.$q.loading.show(),l["a"].Register({sitecode:t,encoded:e,firstName:this.firstName,lastName:this.lastName}).then(i=>{this.$q.loading.hide(),i.data.ok?(d["a"].setAuthorization(i.data.authorization),0===i.data.entity.email.length?(this.pk=i.data.entity.pk,this.photo=i.data.entity.photo,this.requireEmail=!0):(this.$store.commit("UserStore/SET_USER",{pk:i.data.entity.pk,sitecode:t,encoded:e,firstName:this.firstName,lastName:this.lastName,email:i.data.entity.email,photo:i.data.entity.photo}),this.$router.replace({name:"Activate"}))):this.notifyError(i.data.message)}).catch(t=>{this.$q.loading.hide(),this.notifyError(t.message)}))},autoLogin(){const t=d["a"].getRemeberMe();if(!t)return;this.$q.loading.show();const e="D3000.VirtualKey",i=d["a"].getTicks().toString(),s=d["a"].encryptPassword(i,"7E57C707-F028-45C1-9F80-625A70A60D11");l["a"].Login({userId:e,password:s,ticks:i,pk:t}).then(e=>{this.$q.loading.hide(),e.data.ok&&(d["a"].setAuthorization(e.data.authorization),this.$store.commit("UserStore/SET_USER",{pk:t,sitecode:e.data.entity.sitecode,encoded:e.data.entity.encoded,firstName:e.data.entity.firstName,lastName:e.data.entity.lastName,email:e.data.entity.email,photo:e.data.entity.photo}),this.$router.replace({name:"Dashboard"}))}).catch(t=>{this.$q.loading.hide(),this.notifyError(t.message)})},checkVersion(t){this.$q.platform.is.android?this.appUpdater.isAndroid=!0:this.appUpdater.isAndroid=!1,this.appUpdater.isAndroid?this.checkAndroidVersion(e=>{e?this.updateApp():t()}):this.checkIOSVersion(e=>{e?this.updateApp():t()})},checkAndroidVersion(t){const e=(new Date).getTime(),i=`${this.appUpdater.updateBaseUrl}/${this.appUpdater.appName}/${this.appUpdater.appName}.txt?timestamp=${e}`;n.a.get(i).then(e=>{const i=e.data.Version;i!=this.appUpdater.version?(this.appUpdater.updateTitle="Downloading new version...",t(!0)):t(!1)}).catch(t=>{this.showUpdateError(t.message)})},checkIOSVersion(t){const e=(new Date).getTime(),i=`${this.appUpdater.updateBaseUrl}/${this.appUpdater.appName}/${this.appUpdater.appName}.plist?timestamp=${e}`;n.a.get(i).then(e=>{let i="";const s=e.data.split(/\r\n|[\r\n]/);for(let t=0;t<s.length;t++){const e=s[t];if(e.endsWith("<key>bundle-version</key>")&&t+1<s.length){const e=s[t+1].indexOf("<string>");i=s[t+1].substring(e+8,e+8+5)}}i.length>0&&i!=this.appUpdater.version?(this.appUpdater.updateTitle="Updating the App, please wait...",t(!0)):t(!1)}).catch(t=>{this.showUpdateError(t.message)})},updateApp(){if(this.appUpdater.isAndroid){const t=(new Date).getTime(),e=`${this.appUpdater.updateBaseUrl}/${this.appUpdater.appName}/${this.appUpdater.appName}.apk?v=${t}`;this.updateAndroid(e)}else{const t=`itms-services://?action=download-manifest&url=${this.appUpdater.updateBaseUrl}/${this.appUpdater.appName}/${this.appUpdater.appName}.plist`;this.updateIOS(t)}},updateAndroid(t){const e=this;window.resolveLocalFileSystemURL(cordova.file.externalDataDirectory,(function(i){i.getFile(e.appUpdater.appName+".apk",{create:!0,exclusive:!1},(function(i){n()({method:"GET",url:t,responseType:"blob",onDownloadProgress(t){t.lengthComputable&&e.$nextTick(()=>{e.appUpdater.downloadProcessValue=Math.round(t.loaded/t.total*100)})}}).then(t=>{const e=new Blob([t.data],{type:"application/vnd.android.package-archive"});i.createWriter((function(t){t.onwriteend=function(){cordova.plugins.fileOpener2.open(i.toInternalURL(),"application/vnd.android.package-archive")},t.write(e)}))}).catch(t=>{e.showUpdateError("download error: "+t.message)})}),t=>{e.showUpdateError("error getting file! "+t.message)})}),t=>{e.showUpdateError("error getting persistent fs! "+t.code)})},updateIOS(t){cordova.InAppBrowser.open(t,"_system","location=no"),this.simulateDownloadIOS()},simulateDownloadIOS(){setTimeout(()=>{this.appUpdater.downloadProcessValue>=100?cordova.plugins.exit():(this.$nextTick(()=>{this.appUpdater.downloadProcessValue+=10}),this.simulateDownloadIOS())},1e3)},showUpdateError(t){navigator.notification.alert(t,()=>{cordova.plugins.exit()})}},mounted(){this.appUpdater.version=d["a"].getVersion(),this.$q.platform.is.cordova?this.checkVersion(()=>{this.appUpdater.isLatest=!0,this.autoLogin()}):(this.appUpdater.isLatest=!0,this.autoLogin())}}),h=c,u=(i("05d2"),i("2c53"),i("2877")),g=Object(u["a"])(h,s,a,!1,null,"1350ad52",null);e["default"]=g.exports},"0205":function(t,e,i){t.exports=i.p+"img/numbersBlue.png"},"05d2":function(t,e,i){"use strict";var s=i("a14e"),a=i.n(s);a.a},"06d0":function(t,e,i){},"0b74":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-layout",{attrs:{view:"lHh Lpr lFf"}},[s("q-header",{attrs:{elevated:""}},[s("q-toolbar",[s("q-btn",{attrs:{flat:"",dense:"",round:"",icon:"keyboard_backspace"},on:{click:t.onBack}}),s("q-toolbar-title",[t._v(t._s(t.title))]),t.$q.platform.is.ios?s("q-btn",{attrs:{flat:"",dense:"",round:"",icon:"star"},on:{click:t.onShowShortCuts}}):t._e()],1)],1),s("q-footer",{attrs:{elevated:""}},[s("q-toolbar",{staticClass:"row justify-around bg-primary text-white"},[s("q-btn",{attrs:{flat:"",dense:"",stack:"",icon:"delete",label:"Delete"},on:{click:t.onShowDeleteFavorite}}),s("q-btn",{attrs:{flat:"",dense:"",stack:"",icon:"sort",label:"Sort"},on:{click:t.onShowSortFavorite}}),s("q-btn",{attrs:{flat:"",dense:"",stack:"",icon:"edit",label:"Edit"},on:{click:t.onShowRenameFavorite}})],1)],1),s("q-dialog",{attrs:{persistent:"",maximized:!0,"transition-show":"slide-up","transition-hide":"slide-down"},model:{value:t.dlgShortCuts.show,callback:function(e){t.$set(t.dlgShortCuts,"show",e)},expression:"dlgShortCuts.show"}},[s("q-card",[s("q-toolbar",{staticClass:"bg-primary text-white"},[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",size:"md",icon:"keyboard_backspace"}}),s("q-toolbar-title",[t._v("Add to ShortCuts")]),s("q-btn",{attrs:{flat:"",dense:"",round:"",size:"md",icon:"save"},on:{click:t.onAddShortCuts}})],1),s("q-card-section",[s("q-option-group",{staticClass:"text-h6 text-weight-regular q-gutter-lg",attrs:{options:t.dlgShortCuts.options,color:"red"},model:{value:t.dlgShortCuts.selectedOption,callback:function(e){t.$set(t.dlgShortCuts,"selectedOption",e)},expression:"dlgShortCuts.selectedOption"}})],1)],1)],1),s("q-dialog",{attrs:{persistent:"",maximized:!0,"transition-show":"slide-up","transition-hide":"slide-down"},model:{value:t.dlgRename.show,callback:function(e){t.$set(t.dlgRename,"show",e)},expression:"dlgRename.show"}},[s("q-card",[s("q-toolbar",{staticClass:"bg-primary text-white"},[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",size:"md",icon:"keyboard_backspace"}}),s("q-toolbar-title",[t._v("Edit Favorite List")]),s("q-btn",{attrs:{flat:"",dense:"",round:"",size:"md",icon:"save"},on:{click:t.onRenameFavorite}})],1),s("q-card-section",[s("q-list",t._l(t.dlgRename.list,(function(e,i){return s("q-item",{key:i,staticClass:"edit-input"},[s("q-item-section",[s("q-input",{staticClass:"text-h6",attrs:{rounded:"",outlined:""},scopedSlots:t._u([{key:"prepend",fn:function(){return[s("q-icon",{attrs:{name:e.icon,color:"primary"}})]},proxy:!0}],null,!0),model:{value:e.name,callback:function(i){t.$set(e,"name",i)},expression:"item.name"}})],1)],1)})),1)],1)],1)],1),s("q-dialog",{attrs:{persistent:"",maximized:!0,"transition-show":"slide-up","transition-hide":"slide-down"},model:{value:t.dlgDelete.show,callback:function(e){t.$set(t.dlgDelete,"show",e)},expression:"dlgDelete.show"}},[s("q-card",[s("q-toolbar",{staticClass:"bg-primary text-white"},[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",size:"md",icon:"keyboard_backspace"}}),s("q-toolbar-title",[t._v("Delete Favorite List")]),s("q-btn",{attrs:{flat:"",dense:"",round:"",size:"md",icon:"save"},on:{click:t.onDeleteFavorite}})],1),s("q-card-section",[s("q-option-group",{staticClass:"text-h6 text-weight-regular q-gutter-lg",attrs:{options:t.dlgDelete.options,color:"red",type:"checkbox"},model:{value:t.dlgDelete.selectedList,callback:function(e){t.$set(t.dlgDelete,"selectedList",e)},expression:"dlgDelete.selectedList"}})],1)],1)],1),s("q-dialog",{attrs:{persistent:"",maximized:!0,"transition-show":"slide-up","transition-hide":"slide-down"},model:{value:t.dlgDraggable.show,callback:function(e){t.$set(t.dlgDraggable,"show",e)},expression:"dlgDraggable.show"}},[s("q-card",[s("q-toolbar",{staticClass:"bg-primary text-white"},[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",size:"md",icon:"keyboard_backspace"}}),s("q-toolbar-title",[t._v("Sort Favorite List")]),s("q-btn",{attrs:{flat:"",dense:"",round:"",size:"md",icon:"save"},on:{click:t.onSortFavorite}})],1),s("q-card-section",{staticClass:"draggable-wrapper"},[s("draggable",{staticClass:"list-group",model:{value:t.dlgDraggable.list,callback:function(e){t.$set(t.dlgDraggable,"list",e)},expression:"dlgDraggable.list"}},t._l(t.dlgDraggable.list,(function(e){return s("q-item",{key:e.pk,staticClass:"list-group-item text-h6 text-weight-regular"},[s("q-avatar",{attrs:{icon:e.icon,"text-color":"primary"}}),s("q-item-section",[t._v("\n              "+t._s(e.name)+"\n            ")])],1)})),1)],1)],1)],1),s("q-page-container",[s("q-page",t._l(t.list,(function(e,a){return s("q-list",{key:a,staticClass:"text-h6",attrs:{bordered:"",separator:""}},[s("q-slide-item",{attrs:{"left-color":"white"},on:{left:function(i){return t.onOpenDevice(e.pk,i)}},scopedSlots:t._u([e.canEnterIn?{key:"left",fn:function(){return[s("q-item",{staticClass:"slide-item-wrapper"},[s("q-avatar",{staticClass:"slide-icon q-mt-xs",attrs:{color:"green",size:"40px"}},[s("img",{attrs:{src:i("6f8d"),draggable:"false"}})]),s("q-item-section",{staticClass:"open-door-name text-h6 text-black q-ml-md"},[t._v("\n                "+t._s(e.name.length>7?e.name.substring(0,6)+"...":e.name)+"\n              ")])],1)]},proxy:!0}:null],null,!0)},[s("q-item",[s("q-item-section",{attrs:{avatar:""}},[s("q-avatar",{class:{"green-lock":e.status,"primary-lock":!e.status},attrs:{color:"primary",size:"40px"}},[1===e.qrType?s("img",{attrs:{src:i("df0f"),draggable:"false"}}):s("img",{attrs:{src:i("5612"),draggable:"false"}})])],1),s("q-item-section",{class:{"canNot-enterIn":!e.canEnterIn}},[t._v(t._s(e.canEnterIn?e.name:e.name+" (Currently At Capacity)")+"\n            ")]),s("q-item-section",{attrs:{side:""}},[s("q-item-label",{attrs:{caption:""}},[t._v("Swipe")]),s("q-item-section",{attrs:{avatar:""}},[s("q-avatar",{staticClass:"arrow",attrs:{rounded:""}},[s("img",{attrs:{src:i("c5d4"),draggable:"false"}})])],1)],1)],1)],1)],1)})),1)],1)],1)},a=[],o=i("2b0e"),r=i("310e"),n=i.n(r),l=i("d257"),d=i("44ef"),c=i("fc00"),h=i("6462"),u=i("3553"),g=o["a"].extend({name:"FavoriteList",components:{draggable:n.a},data(){return{title:"",cardPK:"",buildingPK:"",dlgShortCuts:{show:!1,options:new Array,selectedOption:""},dlgRename:{show:!1,list:new Array},dlgDelete:{show:!1,options:new Array,selectedList:new Array},dlgDraggable:{show:!1,list:new Array},list:new Array,idleTimebegin:0,idleTimeoutId:0}},methods:{notifyError(t){this.$q.notify({type:"negative",message:t})},startIdleTimout(){this.idleTimeoutId=window.setTimeout(()=>{this.doIdleWork()},1e3)},doIdleWork(){const t=Math.floor(((new Date).getTime()-this.idleTimebegin)/6e4);if(t>3)return this.dlgDraggable.show=!1,this.dlgDelete.show=!1,void this.onBack();for(const e of this.list)if(e.status&&e.unLockBegin>0){const t=Math.floor(((new Date).getTime()-e.unLockBegin)/1e3);t>5&&(e.status=!1,e.reset());break}this.startIdleTimout()},onBack(){this.$router.back()},getGPSPosition(t){try{this.$q.loading.show(),navigator.geolocation.getCurrentPosition(e=>{this.$q.loading.hide(),t(e.coords.latitude,e.coords.longitude)},t=>{this.$q.loading.hide(),this.notifyError("The location service must be enabled.("+t.message+")"),this.onBack()},{maximumAge:3e5,timeout:3e4,enableHighAccuracy:!0})}catch(e){this.$q.loading.hide(),this.notifyError(e.message),this.onBack()}},getFavorite(t,e){this.$q.loading.show(),c["a"].GetList({cardPK:this.cardPK,buildingPK:this.buildingPK,latitude:t,longitude:e}).then(t=>{if(this.$q.loading.hide(),t.data.ok){this.title=t.data.address;for(const e of t.data.result){let t="lock",i=!0;switch(e.qrType){case 1:t="swap_vert";break;case 3:t=e.isUnLock?"lock_open":"lock",i=e.canEnterIn;break}const s=e.isUnLock?(new Date).getTime():0;this.list.push({pk:e.pk,name:e.name,groupId:e.groupId,srcFloorId:e.srcFloorId,dstFloorId:e.dstFloorId,canEnterIn:i,status:e.isUnLock,qrType:e.qrType,icon:t,unLockBegin:s,reset:()=>({})})}this.idleTimebegin=(new Date).getTime(),this.startIdleTimout()}else this.notifyError(t.data.message),this.onBack()}).catch(t=>{this.$q.loading.hide(),this.notifyError(t.message),this.onBack()})},onOpenDevice(t,{reset:e}){this.idleTimebegin=(new Date).getTime();const i=this.getByPK(t);i&&!i.status?i.srcFloorId===i.dstFloorId?this.openDoor(t,{reset:e}):this.openElevator(i.groupId,i.srcFloorId,i.dstFloorId):e()},openDoor(t,{reset:e}){const i=this.getByPK(t);i&&(this.$q.loading.show(),i.unLockBegin=0,i.reset=e,u["a"].OpenDoor(t,this.cardPK).then(t=>{this.$q.loading.hide(),this.idleTimebegin=(new Date).getTime(),t.data.ok?(i.status=!0,i.unLockBegin=(new Date).getTime()):(i.status=!1,e(),this.notifyError(t.data.message))}).catch(t=>{this.notifyError(t.message),this.$q.loading.hide(),i.status=!1,e(),this.idleTimebegin=(new Date).getTime()}))},openElevator(t,e,i){this.idleTimebegin=(new Date).getTime(),this.$q.loading.show(),h["a"].OpenCallUpDown({cardPK:this.cardPK,buildingPK:this.buildingPK,groupId:t,srcFloor:e,dstFloor:i}).then(i=>{this.$q.loading.hide(),this.idleTimebegin=(new Date).getTime(),i.data.ok?"NoUp"===i.data.message?this.$q.dialog({title:"Warning",message:"The call buttons have not been wired.  Please push the UP button to call the elevator."}).onOk(()=>{this.onShowMap(t,e)}):"NoDown"===i.data.message?this.$q.dialog({title:"Warning",message:"The call buttons have not been wired.  Please push the DOWN button to call the elevator."}).onOk(()=>{this.onShowMap(t,e)}):this.onShowMap(t,e):(this.notifyError(i.data.message),this.onBack())}).catch(t=>{this.notifyError(t.message),this.$q.loading.hide(),this.onBack()})},onShowMap(t,e){this.$q.loading.show(),d["a"].GetElevatorLayout(this.buildingPK,t,e).then(e=>{if(this.$q.loading.hide(),e.data.ok)switch(this.$store.commit("FloorStore/ADD_LAYOUT",{leftLayout:e.data.result.left,rightLayout:e.data.result.right}),e.data.result.heading){case 0:this.$router.replace({name:"MapNorth",params:{buildingPK:this.buildingPK,groupId:t.toString()}});break;case 1:this.$router.replace({name:"MapEast",params:{buildingPK:this.buildingPK,groupId:t.toString()}});break;case 2:this.$router.replace({name:"MapSouth",params:{buildingPK:this.buildingPK,groupId:t.toString()}});break;case 3:this.$router.replace({name:"MapWest",params:{buildingPK:this.buildingPK,groupId:t.toString()}});break;default:this.$router.replace({name:"MapNorth",params:{buildingPK:this.buildingPK,groupId:t.toString()}});break}else this.notifyError(e.data.message),this.onBack()}).catch(t=>{this.$q.loading.hide(),this.notifyError(t.message),this.onBack()})},getByPK(t){for(const e of this.list)if(e.pk===t)return e},onShowSortFavorite(){this.dlgDraggable.list.length=0;for(const t of this.list)this.dlgDraggable.list.push({pk:t.pk,name:t.name,icon:t.icon});this.dlgDraggable.show=!0},onSortFavorite(){this.idleTimebegin=(new Date).getTime(),this.$q.loading.show();const t=new Array;for(const e of this.dlgDraggable.list)t.push({pk:e.pk});c["a"].SortList(this.cardPK,this.buildingPK,t).then(t=>{if(this.$q.loading.hide(),this.idleTimebegin=(new Date).getTime(),t.data.ok){const t=new Array;for(let e=0;e<this.dlgDraggable.list.length;e++){const i=this.dlgDraggable.list[e].pk;for(let e=0;e<this.list.length;e++)this.list[e].pk===i&&t.push(this.list[e])}this.list.length=0;for(const e of t)this.list.push(e);this.dlgDraggable.show=!1}else this.notifyError(t.data.message)}).catch(t=>{this.notifyError(t.message),this.$q.loading.hide(),this.idleTimebegin=(new Date).getTime()})},onShowDeleteFavorite(){this.dlgDelete.options.length=0;for(const t of this.list)this.dlgDelete.options.push({label:t.name,value:t.pk});this.dlgDelete.selectedList.length=0,this.dlgDelete.show=!0},onDeleteFavorite(){if(0===this.dlgDelete.selectedList.length)return void(this.dlgDelete.show=!1);this.idleTimebegin=(new Date).getTime();const t=new Array;for(const e of this.dlgDelete.selectedList)t.push({pk:e});this.$q.loading.show(),c["a"].Remove(this.cardPK,t).then(e=>{if(this.$q.loading.hide(),this.idleTimebegin=(new Date).getTime(),e.data.ok){for(const e of t)for(let t=0;t<this.list.length;t++)this.list[t].pk===e.pk&&this.list.splice(t,1);this.dlgDelete.show=!1}else this.notifyError(e.data.message)}).catch(t=>{this.notifyError(t.message),this.$q.loading.hide(),this.idleTimebegin=(new Date).getTime()})},onShowRenameFavorite(){this.dlgRename.list.length=0;for(const t of this.list)this.dlgRename.list.push({pk:t.pk,name:t.name,icon:t.icon});this.dlgRename.show=!0},onRenameFavorite(){this.idleTimebegin=(new Date).getTime();const t=new Array;for(const e of this.dlgRename.list)t.push(e);this.$q.loading.show(),c["a"].RenameList({cardPK:this.cardPK,buildingPK:this.buildingPK,doors:t}).then(e=>{if(this.$q.loading.hide(),this.idleTimebegin=(new Date).getTime(),e.data.ok){for(const e of t)for(let t=0;t<this.list.length;t++)this.list[t].pk===e.pk&&(this.list[t].name=e.name);this.dlgRename.show=!1}else this.notifyError(e.data.message)}).catch(t=>{this.notifyError(t.message),this.$q.loading.hide(),this.idleTimebegin=(new Date).getTime()})},onShowShortCuts(){if(0!==this.list.length){this.dlgShortCuts.options.length=0;for(const t of this.list)this.dlgShortCuts.options.push({label:t.name,value:t.pk});this.dlgShortCuts.selectedOption=this.dlgShortCuts.options[0].value,this.dlgShortCuts.show=!0}},onAddShortCuts(){this.idleTimebegin=(new Date).getTime();const t=this.dlgShortCuts.selectedOption,e=this.getByPK(t);e&&(1===e.qrType?this.addElevatorShortCuts(this.buildingPK,this.cardPK,e.name,e.groupId,e.srcFloorId,e.dstFloorId):this.addDoorShortCuts(this.buildingPK,this.cardPK,e.name,e.pk))},addElevatorShortCuts(t,e,i,s,a,o){cordova.plugins.SiriShortcuts.present({persistentIdentifier:`com.redcoats.virtualkey.openelevator|${e}|${t}:${s}:${a}:${o}`,title:i,suggestedInvocationPhrase:"Call elevator",userInfo:{buildingPK:e,cardPK:t,groupId:s,srcFloor:a,dstFloor:o}},()=>{this.$q.notify({type:"positive",message:"Adding elevator shortcuts ok!"})},t=>{this.$q.notify({type:"negative",message:t})})},addDoorShortCuts(t,e,i,s){cordova.plugins.SiriShortcuts.present({persistentIdentifier:`com.redcoats.virtualkey.opendoor|${e}|${t}:${s}`,title:i,suggestedInvocationPhrase:"Open door",userInfo:{buildingPK:e,cardPK:t,doorPK:s}},()=>{this.$q.notify({type:"positive",message:"Adding door shortcuts ok!"})},t=>{this.$q.notify({type:"negative",message:t})})}},mounted(){const t=this.$route.params.id;if(!t)return this.notifyError("The parameter is not valid."),void this.onBack();this.cardPK=l["a"].getRemeberMe(),this.buildingPK=t,this.getGPSPosition((t,e)=>{this.getFavorite(t,e)})},beforeDestroy(){this.idleTimeoutId&&clearTimeout(this.idleTimeoutId)}}),p=g,m=(i("58c2"),i("2877")),b=Object(m["a"])(p,s,a,!1,null,"eadf17fc",null);e["default"]=b.exports},1001:function(t,e,i){"use strict";var s=i("e425"),a=i.n(s);a.a},"1a47":function(t,e,i){"use strict";var s=i("39ed"),a=i.n(s);a.a},"24b6":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-layout",{attrs:{view:"lHh Lpr lFf"}},[s("q-header",{attrs:{elevated:""}},[s("q-toolbar",[s("q-btn",{attrs:{flat:"",dense:"",round:"",icon:"keyboard_backspace"},on:{click:t.onBack}}),s("q-toolbar-title",[t._v(t._s(t.title))]),s("q-btn",{attrs:{flat:"",dense:"",round:"",icon:"star"},on:{click:function(e){t.dlgAddToFavorite.show=!0}}})],1)],1),s("q-dialog",{attrs:{persistent:"",maximized:!0,"transition-show":"slide-up","transition-hide":"slide-down"},model:{value:t.dlgAddToFavorite.show,callback:function(e){t.$set(t.dlgAddToFavorite,"show",e)},expression:"dlgAddToFavorite.show"}},[s("q-card",[s("q-toolbar",{staticClass:"bg-primary text-white"},[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",size:"md",icon:"keyboard_backspace"}}),s("q-toolbar-title",[t._v("Add To Favorite")]),s("q-btn",{attrs:{flat:"",dense:"",round:"",size:"md",icon:"save"},on:{click:t.onAddToFavorite}})],1),s("q-card-section",[s("q-option-group",{staticClass:"text-h6 text-weight-regular q-gutter-lg",attrs:{options:t.dlgAddToFavorite.options,color:"green",type:"checkbox"},model:{value:t.dlgAddToFavorite.selectedList,callback:function(e){t.$set(t.dlgAddToFavorite,"selectedList",e)},expression:"dlgAddToFavorite.selectedList"}})],1)],1)],1),s("q-page-container",[s("q-page",[s("div",{staticClass:"text row q-mt-lg q-mb-md text-h5 font-weight-bold text-blue-grey-4 justify-center"},[t._v("\n        "+t._s(t.area)+"\n      ")]),t._l(t.list,(function(e,a){return s("q-list",{key:a,staticClass:"text-h6",attrs:{bordered:"",separator:""}},[s("q-slide-item",{attrs:{"left-color":"white"},on:{left:function(i){return t.onOpenDoor(e.pk,i)}},scopedSlots:t._u([e.canEnterIn?{key:"left",fn:function(){return[s("q-item",{staticClass:"slide-item-wrapper"},[s("q-avatar",{staticClass:"slide-icon q-mt-xs",attrs:{color:"green",size:"40px"}},[s("img",{attrs:{src:i("6f8d"),draggable:"false"}})]),s("q-item-section",{staticClass:"open-door-name text-h6 text-black q-ml-md"},[t._v("\n                Opening\n              ")])],1)]},proxy:!0}:null],null,!0)},[s("q-item",[s("q-item-section",{attrs:{avatar:""}},[s("q-avatar",{class:{"green-lock":e.status,"primary-lock":!e.status},attrs:{color:e.status?"green":"primary","text-color":"white",icon:e.status?"lock_open":"lock"}})],1),s("q-item-section",{class:{"canNot-enterIn":!e.canEnterIn}},[t._v(t._s(e.canEnterIn?e.name:e.name+" (Currently At Capacity)"))]),s("q-item-section",{attrs:{side:""}},[s("q-item-label",{attrs:{caption:""}},[t._v("Swipe")]),s("q-item-section",{attrs:{avatar:""}},[s("q-avatar",{staticClass:"arrow",attrs:{rounded:""}},[s("img",{attrs:{src:i("c5d4"),draggable:"false"}})])],1)],1)],1)],1)],1)}))],2)],1)],1)},a=[],o=i("2b0e"),r=i("d257"),n=i("3553"),l=i("fc00"),d=o["a"].extend({name:"DoorList",data(){return{title:"",area:"",cardPK:"",categoryPK:"",dlgAddToFavorite:{show:!1,options:new Array,selectedList:new Array},list:new Array,idleTimebegin:0,idleTimeoutId:0}},methods:{notifyError(t){this.$q.notify({type:"negative",message:t})},startIdleTimout(){this.idleTimeoutId=window.setTimeout(()=>{this.doIdleWork()},1e3)},doIdleWork(){const t=Math.floor(((new Date).getTime()-this.idleTimebegin)/6e4);if(t>3)return this.dlgAddToFavorite.show=!1,void this.onBack();for(const e of this.list)if(e.status&&e.unLockBegin>0){const t=Math.floor(((new Date).getTime()-e.unLockBegin)/1e3);t>5&&(e.status=!1,e.reset());break}this.startIdleTimout()},onBack(){this.$router.back()},getListByCategory(){this.$q.loading.show(),n["a"].GetListByCategory(this.cardPK,this.categoryPK).then(t=>{if(this.$q.loading.hide(),t.data.ok){this.title=t.data.address,this.area=t.data.area;for(const e of t.data.result){this.dlgAddToFavorite.options.push({label:e.name,value:e.pk});const t=e.isUnLock?(new Date).getTime():0;this.list.push({pk:e.pk,name:e.name,canEnterIn:e.canEnterIn,status:e.isUnLock,unLockBegin:t,reset:()=>({})})}this.idleTimebegin=(new Date).getTime(),this.startIdleTimout()}else this.notifyError(t.data.message),this.onBack()}).catch(t=>{this.$q.loading.hide(),this.notifyError(t.message),this.onBack()})},onOpenDoor(t,{reset:e}){this.idleTimebegin=(new Date).getTime();const i=this.getByPK(t);i&&!i.status?(this.$q.loading.show(),i.unLockBegin=0,i.reset=e,n["a"].OpenDoor(t,this.cardPK).then(t=>{this.$q.loading.hide(),this.idleTimebegin=(new Date).getTime(),t.data.ok?(i.status=!0,i.unLockBegin=(new Date).getTime()):(i.status=!1,e(),this.notifyError(t.data.message))}).catch(t=>{this.notifyError(t.message),this.$q.loading.hide(),i.status=!1,e(),this.idleTimebegin=(new Date).getTime()})):e()},getByPK(t){for(const e of this.list)if(e.pk===t)return e},onAddToFavorite(){if(0===this.dlgAddToFavorite.selectedList.length)return void(this.dlgAddToFavorite.show=!1);this.idleTimebegin=(new Date).getTime();const t=new Array;for(const e of this.dlgAddToFavorite.selectedList)t.push({pk:e,qrType:3,qrTypeName:"Door",dstFloor:0});this.$q.loading.show(),l["a"].Add({cardPK:this.cardPK,doors:t}).then(t=>{this.$q.loading.hide(),this.idleTimebegin=(new Date).getTime(),t.data.ok?(this.$q.notify({type:"positive",message:"It has been added to your favorites."}),this.dlgAddToFavorite.show=!1):this.notifyError(t.data.message)}).catch(t=>{this.notifyError(t.message),this.$q.loading.hide(),this.idleTimebegin=(new Date).getTime()})}},mounted(){const t=this.$route.params.id;if(!t)return this.notifyError("The parameter is not valid."),void this.onBack();this.cardPK=r["a"].getRemeberMe(),this.categoryPK=t,this.getListByCategory()},beforeDestroy(){this.idleTimeoutId&&clearTimeout(this.idleTimeoutId)}}),c=d,h=(i("ba51"),i("2877")),u=Object(h["a"])(c,s,a,!1,null,"6884ca7b",null);e["default"]=u.exports},"2c53":function(t,e,i){"use strict";var s=i("b47d"),a=i.n(s);a.a},"2c75":function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var s=i("bc3a"),a=i.n(s);a.a.defaults.timeout=5e4,a.a.defaults.baseURL="https://d3000apitest.azurewebsites.net/api/Virtualkey/",a.a.interceptors.request.use((function(t){const e=sessionStorage.getItem("D3000_VirtualKey_authorization")||"";return e&&(t.headers.Authorization="Basic "+e),t.url=t.url+"?access_token=73FBF94A-3F5E-7190-9252-95924D4DBBD1",t}),(function(t){return Promise.reject(t)})),a.a.interceptors.response.use((function(t){return t}),(function(t){return Promise.reject(t)}));class o{static post(t,e,i){return a.a.post(t,e,i)}}},"2ed7":function(t,e,i){"use strict";var s=i("06d0"),a=i.n(s);a.a},"2fd9":function(t,e,i){},3284:function(t,e,i){"use strict";var s=i("366f"),a=i.n(s);a.a},3553:function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var s=i("2c75");class a{static GetListByCategory(t,e){const i={cardPK:t,categoryPK:e};return s["a"].post("BizDoor_GetListByCategory",i)}static GetListByTemp(t){return s["a"].post("BizDoor_GetListByTemp",t)}static OpenByReader(t){return s["a"].post("BizDoor_OpenByReader",t)}static OpenDoor(t,e){const i={doorPK:t,cardPK:e};return s["a"].post("BizDoor_OpenDoor",i)}}},"366f":function(t,e,i){},"39ed":function(t,e,i){},"3bc5":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-layout",{attrs:{view:"lHh Lpr lFf"}},[s("q-header",{attrs:{elevated:""}},[s("q-toolbar",[s("q-btn",{attrs:{flat:"",dense:"",round:"",icon:"keyboard_backspace"},on:{click:t.onBack}}),s("q-toolbar-title",[t._v(t._s(t.title))])],1)],1),s("q-page-container",[s("q-page",{staticClass:"q-pa-sm"},[t._l(t.listNorth,(function(e){return s("div",{directives:[{name:"show",rawName:"v-show",value:"N"===t.direction,expression:"direction === 'N'"}],key:e.leftId,staticClass:"q-pa-xs"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-5"},[s("q-btn",{directives:[{name:"show",rawName:"v-show",value:e.leftId>0,expression:"item.leftId > 0"}],staticClass:"button nl-button text-subtitle1 text-weight-bold",attrs:{"text-color":"black",label:e.leftName},on:{click:function(i){return t.onElevator(e.leftId)}}})],1),s("div",{staticClass:"col"}),s("div",{staticClass:"col-5 column items-end"},[s("q-btn",{directives:[{name:"show",rawName:"v-show",value:e.rightId>0,expression:"item.rightId > 0"}],staticClass:"button nr-button text-subtitle1 text-weight-bold",attrs:{"text-color":"black",label:e.rightName},on:{click:function(i){return t.onElevator(e.rightId)}}})],1)])])})),t._l(t.listSourth,(function(e){return s("div",{directives:[{name:"show",rawName:"v-show",value:"S"===t.direction,expression:"direction === 'S'"}],key:e.leftId,staticClass:"q-pa-xs"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-5"},[s("q-btn",{directives:[{name:"show",rawName:"v-show",value:e.leftId>0,expression:"item.leftId > 0"}],staticClass:"button sl-button text-subtitle1 text-weight-bold",attrs:{"text-color":"black",label:e.leftName},on:{click:function(i){return t.onElevator(e.leftId)}}})],1),s("div",{staticClass:"col"}),s("div",{staticClass:"col-5 column items-end"},[s("q-btn",{directives:[{name:"show",rawName:"v-show",value:e.rightId>0,expression:"item.rightId > 0"}],staticClass:"button sr-button text-subtitle1 text-weight-bold",attrs:{"text-color":"black",label:e.rightName},on:{click:function(i){return t.onElevator(e.rightId)}}})],1)])])})),s("div",{directives:[{name:"show",rawName:"v-show",value:"E"===t.direction,expression:"direction === 'E'"}]},[s("div",{staticClass:"q-pa-sm q-gutter-sm row button-wrapper"},t._l(t.listEastUp,(function(e){return s("div",{key:e.id,staticClass:"col"},[s("q-btn",{directives:[{name:"show",rawName:"v-show",value:e.id>0,expression:"item.id > 0"}],staticClass:"button eu-button text-subtitle1 text-weight-bold",attrs:{"text-color":"black",label:e.name},on:{click:function(i){return t.onElevator(e.id)}}})],1)})),0),s("div",{staticClass:"q-pa-sm q-gutter-sm fixed-bottom row button-wrapper"},t._l(t.listEastDown,(function(e){return s("div",{key:e.id,staticClass:"col"},[s("q-btn",{directives:[{name:"show",rawName:"v-show",value:e.id>0,expression:"item.id > 0"}],staticClass:"button ed-button text-subtitle1 text-weight-bold",attrs:{"text-color":"black",label:e.name},on:{click:function(i){return t.onElevator(e.id)}}})],1)})),0)]),s("div",{directives:[{name:"show",rawName:"v-show",value:"W"===t.direction,expression:"direction === 'W'"}]},[s("div",{staticClass:"q-pa-sm q-gutter-sm row button-wrapper"},t._l(t.listWestUp,(function(e){return s("div",{key:e.id,staticClass:"col"},[s("q-btn",{directives:[{name:"show",rawName:"v-show",value:e.id>0,expression:"item.id > 0"}],staticClass:"button wu-button text-subtitle1 text-weight-bold",attrs:{"text-color":"black",label:e.name},on:{click:function(i){return t.onElevator(e.id)}}})],1)})),0),s("div",{staticClass:"q-pa-sm q-gutter-sm fixed-bottom row button-wrapper"},t._l(t.listWestDown,(function(e){return s("div",{key:e.id,staticClass:"col"},[s("q-btn",{directives:[{name:"show",rawName:"v-show",value:e.id>0,expression:"item.id > 0"}],staticClass:"button wd-button text-subtitle1 text-weight-bold",attrs:{"text-color":"black",label:e.name},on:{click:function(i){return t.onElevator(e.id)}}})],1)})),0)]),s("div",[s("q-avatar",{staticClass:"fixed-center",attrs:{size:"100px",rounded:""}},[s("img",{attrs:{src:i("bbb4"),draggable:"false"}})])],1)],2)],1)],1)},a=[],o=i("2b0e"),r=i("b178"),n=i("d257"),l=i("6462"),d=o["a"].extend({name:"MapSouth",data(){return{title:"Elevator Map",cardPK:"",buildingPK:"",groupId:0,listNorth:new Array,listSourth:new Array,listEastUp:new Array,listEastDown:new Array,listWestUp:new Array,listWestDown:new Array,direction:"S"}},methods:{notifyError(t){this.$q.notify({type:"negative",message:t})},onBack(){this.$router.back()},getList(){const t=this.$store.getters["FloorStore/GET_LAYOUT"],e=t.leftLayout,i=t.rightLayout;for(let s=0;s<e.length;s++)e[s].id>0&&this.listWestDown.push(e[s]);for(let s=0;s<i.length;s++)i[s].id>0&&this.listWestUp.push(i[s]);for(let s=e.length-1;s>=0;s--)e[s].id>0&&this.listEastUp.push(e[s]);for(let s=i.length-1;s>=0;s--)i[s].id>0&&this.listEastDown.push(i[s]);for(let s=0;s<e.length;s++)this.listSourth.push({leftId:e[s].id,leftName:e[s].name,rightId:i[s].id,rightName:i[s].name});for(let s=i.length-1;s>=0;s--)this.listNorth.push({leftId:i[s].id,leftName:i[s].name,rightId:e[s].id,rightName:e[s].name})},onElevator(t){this.$q.loading.show(),l["a"].OpenFloor(this.cardPK,this.buildingPK,t).then(t=>{this.$q.loading.hide(),t.data.ok?(this.$store.commit("FloorStore/REMOVE_FLOOR",this.groupId),this.onBack()):(this.notifyError(t.data.message),this.onBack())}).catch(t=>{this.$q.loading.hide(),this.notifyError(t.message),this.onBack()})},compass(t){t<68||t>292?this.direction="N":t>112&&t<248?this.direction="S":t>=68&&t<=112?this.direction="E":t>=248&&t<=292&&(this.direction="W")}},mounted(){const t=this.$route.params.buildingPK,e=this.$route.params.groupId;if(!t||!e)return this.notifyError("The parameter is not valid."),void this.onBack();this.buildingPK=t,this.groupId=Number.parseInt(e),this.cardPK=n["a"].getRemeberMe(),this.getList(),this.$q.platform.is.ios?window.addEventListener("deviceorientation",Object(r["f"])(t=>{if("webkitCompassHeading"in t){const e=t["webkitCompassHeading"]||0;this.compass(e)}else this.compass(t.alpha||0)},300),!1):window.addEventListener("deviceorientationabsolute",Object(r["f"])(t=>{null!==t.alpha&&this.compass(360-t.alpha)},300),!1)}}),c=d,h=(i("720e"),i("2877")),u=Object(h["a"])(c,s,a,!1,null,"fae593fa",null);e["default"]=u.exports},"44ef":function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var s=i("2c75");class a{static GetAreaPeopleList(t){const e={buildingPK:t};return s["a"].post("BizBuilding_GetAreaPeopleList",e)}static GetBuilding(t){return s["a"].post("BizBuilding_GetBuilding",t)}static GetBuildingList(t,e,i){const a={cardPK:t,latitude:e,longitude:i};return s["a"].post("BizBuilding_GetBuildingList",a)}static GetCategoryList(t){return s["a"].post("BizBuilding_GetCategoryList",t)}static GetElevatorLayout(t,e,i){const a={buildingPK:t,groupId:e,floorId:i};return s["a"].post("BizBuilding_GetElevatorLayout",a)}static GetFloorList(t,e){const i={buildingPK:t,groupId:e};return s["a"].post("BizBuilding_GetFloorList",i)}static SayHiToCommandServer(t){const e={buildingPK:t};return s["a"].post("BizBuilding_SayHiToCommandServer",e)}}},5612:function(t,e,i){t.exports=i.p+"img/lock.png"},"585b":function(t,e,i){"use strict";var s=i("7c80"),a=i.n(s);a.a},"58c2":function(t,e,i){"use strict";var s=i("c75e"),a=i.n(s);a.a},"5d64":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-layout",{attrs:{view:"lHh Lpr lFf"}},[s("q-header",{attrs:{elevated:""}},[s("q-toolbar",[s("q-btn",{attrs:{flat:"",dense:"",round:"",icon:"keyboard_backspace"},on:{click:t.onBack}}),s("q-toolbar-title",[t._v(t._s(t.title))])],1)],1),s("q-page-container",{staticClass:"category"},[s("q-page",t._l(t.list,(function(e,a){return s("q-list",{key:a,staticClass:"list"},[s("q-expansion-item",{staticClass:"text-h6 text-weight-regular",attrs:{group:"A",icon:"sim_card",label:e.category,"header-class":"text-primary","content-inset-level":.5}},t._l(e.children,(function(e,a){return s("q-list",{key:a},[s("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{clickable:""}},[e.srcFloor!=e.dstFloor?s("q-item-section",{attrs:{avatar:""},on:{click:function(i){return t.onAddToFavorite(e.name,e.groupId,e.srcFloor,e.dstFloor,e.srcFloorName,e.dstFloorName)}}},[s("q-avatar",{attrs:{color:"primary","text-color":"white",icon:"star"}})],1):s("q-item-section",{attrs:{avatar:""}},[s("q-avatar",{attrs:{size:"40px"}},[1===e.qrType?s("img",{attrs:{src:i("0205"),draggable:"false"}}):s("img",{attrs:{src:i("6ccd"),draggable:"false"}})])],1),e.srcFloor!=e.dstFloor?s("q-item-section",{on:{click:function(i){return t.onOpenCategory(e.pk,e.qrType,e.groupId)}}},[t._v("\n                "+t._s(e.name+" ("+e.srcFloorName+" --\x3e "+e.dstFloorName+")")+"\n              ")]):s("q-item-section",{on:{click:function(i){return t.onOpenCategory(e.pk,e.qrType,e.groupId)}}},[t._v(t._s(e.name))]),e.srcFloor!=e.dstFloor?s("q-item-section",{attrs:{avatar:""},on:{click:function(i){return t.onShowMap(e.groupId,e.srcFloor)}}},[s("q-avatar",{attrs:{color:"primary"}},[s("img",{attrs:{src:i("b2e9"),draggable:"false"}})])],1):t._e()],1),s("q-separator")],1)})),1),s("q-separator")],1)})),1)],1)],1)},a=[],o=i("2b0e"),r=i("d257"),n=i("44ef"),l=i("6462"),d=o["a"].extend({name:"Category",data(){return{title:"Reader List",cardPK:"",buildingPK:"",list:new Array,idleTimebegin:0,idleTimeoutId:0}},methods:{notifyError(t){this.$q.notify({type:"negative",message:t})},startIdleTimout(){this.idleTimeoutId=window.setTimeout(()=>{this.doIdleWork()},1e3)},doIdleWork(){const t=Math.floor(((new Date).getTime()-this.idleTimebegin)/6e4);t>3?this.onBack():this.startIdleTimout()},onBack(){this.$store.commit("CachedStore/REMOVE_APGE","Category"),this.$router.back()},getGPSPosition(t){try{this.$q.loading.show(),navigator.geolocation.getCurrentPosition(e=>{this.$q.loading.hide(),t(e.coords.latitude,e.coords.longitude)},t=>{this.$q.loading.hide(),this.notifyError("The location service must be enabled.("+t.message+")"),this.onBack()},{maximumAge:3e5,timeout:3e4,enableHighAccuracy:!0})}catch(e){this.$q.loading.hide(),this.notifyError(e.message),this.onBack()}},getList(t,e){this.$q.loading.show(),n["a"].GetCategoryList({buildingPK:this.buildingPK,cardPK:this.cardPK,latitude:t,longitude:e}).then(t=>{if(this.$q.loading.hide(),t.data.ok){for(const e of t.data.result){const t=[];for(const i of e.children)t.push({pk:i.pk,name:i.name,groupId:i.groupId,qrType:i.qrType,srcFloor:0,dstFloor:0,srcFloorName:"",dstFloorName:""});this.list.push({category:e.category,children:t})}this.attachFloors(),this.idleTimebegin=(new Date).getTime(),this.startIdleTimout()}else this.notifyError(t.data.message),this.onBack()}).catch(t=>{this.$q.loading.hide(),this.notifyError(t.message),this.onBack()})},onOpenCategory(t,e,i){this.idleTimebegin=(new Date).getTime();const s=t;1===e?this.$router.push({name:"FloorList",params:{id:this.buildingPK,group:i.toString()}}):this.$router.push({name:"DoorList",params:{id:s}})},onAddToFavorite(t,e,i,s,a,o){this.$q.loading.show();const r=`${t} (${a} --\x3e ${o})`;l["a"].AddToFavorite({cardPK:this.cardPK,buildingPK:this.buildingPK,groupId:e,srcFloor:i,dstFloor:s,displayName:r}).then(t=>{this.$q.loading.hide(),t.data.ok?this.$q.notify({message:"It has been added to your favorite.",color:"green"}):this.notifyError(t.data.message)}).catch(t=>{this.$q.loading.hide(),this.notifyError(t.message)})},onShowMap(t,e){this.$q.loading.show(),n["a"].GetElevatorLayout(this.buildingPK,t,e).then(e=>{if(this.$q.loading.hide(),e.data.ok)switch(this.$store.commit("FloorStore/ADD_LAYOUT",{leftLayout:e.data.result.left,rightLayout:e.data.result.right}),e.data.result.heading){case 0:this.$router.push({name:"MapNorth",params:{buildingPK:this.buildingPK,groupId:t.toString()}});break;case 1:this.$router.push({name:"MapEast",params:{buildingPK:this.buildingPK,groupId:t.toString()}});break;case 2:this.$router.push({name:"MapSouth",params:{buildingPK:this.buildingPK,groupId:t.toString()}});break;case 3:this.$router.push({name:"MapWest",params:{buildingPK:this.buildingPK,groupId:t.toString()}});break;default:this.$router.push({name:"MapNorth",params:{buildingPK:this.buildingPK,groupId:t.toString()}});break}else this.notifyError(e.data.message),this.onBack()}).catch(t=>{this.$q.loading.hide(),this.notifyError(t.message),this.onBack()})},attachFloors(){const t=this.$store.getters["FloorStore/GET_FLOOR"],e=t.srcFloor,i=t.dstFloor,s=t.srcFloorName,a=t.dstFloorName,o=t.selectTime;for(const r of this.list)for(const t of r.children){let r=0;const n=o[t.groupId];n>0&&(r=Math.floor(((new Date).getTime()-n)/6e4)),r>3?(t.srcFloor=0,t.dstFloor=0,t.srcFloorName="",t.dstFloorName=""):(t.srcFloor=e[t.groupId],t.dstFloor=i[t.groupId],t.srcFloorName=s[t.groupId],t.dstFloorName=a[t.groupId])}}},activated(){this.attachFloors()},mounted(){const t=this.$route.params.id;if(!t)return this.notifyError("The parameter is not valid."),void this.onBack();this.cardPK=r["a"].getRemeberMe(),this.buildingPK=t,this.getGPSPosition((t,e)=>{this.getList(t,e)})},beforeDestroy(){this.idleTimeoutId&&clearTimeout(this.idleTimeoutId)}}),c=d,h=(i("f11e"),i("1a47"),i("2877")),u=Object(h["a"])(c,s,a,!1,null,"2bae0250",null);e["default"]=u.exports},"5d7e":function(t,e,i){t.exports=i.p+"img/dw_logo.png"},6462:function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var s=i("2c75");class a{static AddToFavorite(t){return s["a"].post("BizElevator_AddToFavorite",t)}static GetFloorList(t,e,i){const a={cardPK:t,buildingPK:e,groupId:i};return s["a"].post("BizElevator_GetFloorList",a)}static OpenCallUpDown(t){return s["a"].post("BizElevator_OpenCallUpDown",t)}static OpenFloor(t,e,i){const a={cardPK:t,buildingPK:e,elevatorId:i};return s["a"].post("BizElevator_OpenFloor",a)}}},"6c05":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("q-layout",{attrs:{view:"lHh Lpr lFf"}},[i("q-header",{attrs:{elevated:""}},[i("q-toolbar",[i("q-btn",{attrs:{flat:"",dense:"",round:"",icon:"keyboard_backspace"},on:{click:t.onBack}}),i("q-toolbar-title",[t._v(t._s(t.title))])],1)],1),i("q-page-container",[i("q-page",{staticClass:"q-pa-sm"},[i("h3",[t._v("Cordova: "+t._s(t.cordova))]),i("h3",[t._v("H5: "+t._s(t.h5))])])],1)],1)},a=[],o=i("2b0e"),r=i("b178"),n=o["a"].extend({name:"MapTest",data(){return{title:"Compass",cordova:"",h5:"",watchID:Number}},methods:{notifyError(t){this.$q.notify({type:"negative",message:t})},onBack(){this.$router.back()},compass(t){this.h5=t.toFixed(2)}},mounted(){this.$q.platform.is.cordova?(this.title="Compass: cordova",this.watchID=navigator.compass.watchHeading(t=>{this.cordova=t.magneticHeading.toFixed(2)},t=>{this.notifyError("Compass error: "+t.code)},{frequency:300})):this.$q.platform.is.ios?(this.title="Compass: iOS",window.addEventListener("deviceorientation",Object(r["f"])(t=>{if("webkitCompassHeading"in t){const e=t["webkitCompassHeading"]||0;this.compass(e)}else this.compass(t.alpha||0)},300),!1)):(this.title="Compass: android",window.addEventListener("deviceorientationabsolute",Object(r["f"])(t=>{null!==t.alpha&&this.compass(360-t.alpha)},300),!1))},beforeDestroy(){this.$q.platform.is.cordova&&this.watchID&&navigator.compass.clearWatch(this.watchID)}}),l=n,d=i("2877"),c=Object(d["a"])(l,s,a,!1,null,"af1ad4c6",null);e["default"]=c.exports},"6ccd":function(t,e,i){t.exports=i.p+"img/lockBlue.png"},"6f8d":function(t,e,i){t.exports=i.p+"img/unlock.png"},"720e":function(t,e,i){"use strict";var s=i("e34b"),a=i.n(s);a.a},7259:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-layout",{attrs:{view:"lHh Lpr lFf"}},[s("q-header",{attrs:{elevated:""}},[s("q-toolbar",[s("q-btn",{attrs:{flat:"",dense:"",round:"",icon:"keyboard_backspace"},on:{click:t.onBack}}),s("q-toolbar-title",[t._v(t._s(t.title))])],1)],1),s("q-page-container",[s("q-page",{staticClass:"q-pa-sm"},[t._l(t.listNorth,(function(e){return s("div",{directives:[{name:"show",rawName:"v-show",value:"N"===t.direction,expression:"direction === 'N'"}],key:e.leftId,staticClass:"q-pa-xs"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-5"},[s("q-btn",{directives:[{name:"show",rawName:"v-show",value:e.leftId>0,expression:"item.leftId > 0"}],staticClass:"button nl-button text-subtitle1 text-weight-bold",attrs:{"text-color":"black",label:e.leftName},on:{click:function(i){return t.onElevator(e.leftId)}}})],1),s("div",{staticClass:"col"}),s("div",{staticClass:"col-5 column items-end"},[s("q-btn",{directives:[{name:"show",rawName:"v-show",value:e.rightId>0,expression:"item.rightId > 0"}],staticClass:"button nr-button text-subtitle1 text-weight-bold",attrs:{"text-color":"black",label:e.rightName},on:{click:function(i){return t.onElevator(e.rightId)}}})],1)])])})),t._l(t.listSourth,(function(e){return s("div",{directives:[{name:"show",rawName:"v-show",value:"S"===t.direction,expression:"direction === 'S'"}],key:e.leftId,staticClass:"q-pa-xs"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-5"},[s("q-btn",{directives:[{name:"show",rawName:"v-show",value:e.leftId>0,expression:"item.leftId > 0"}],staticClass:"button sl-button text-subtitle1 text-weight-bold",attrs:{"text-color":"black",label:e.leftName},on:{click:function(i){return t.onElevator(e.leftId)}}})],1),s("div",{staticClass:"col"}),s("div",{staticClass:"col-5 column items-end"},[s("q-btn",{directives:[{name:"show",rawName:"v-show",value:e.rightId>0,expression:"item.rightId > 0"}],staticClass:"button sr-button text-subtitle1 text-weight-bold",attrs:{"text-color":"black",label:e.rightName},on:{click:function(i){return t.onElevator(e.rightId)}}})],1)])])})),s("div",{directives:[{name:"show",rawName:"v-show",value:"E"===t.direction,expression:"direction === 'E'"}]},[s("div",{staticClass:"q-pa-sm q-gutter-sm row button-wrapper"},t._l(t.listEastUp,(function(e){return s("div",{key:e.id,staticClass:"col"},[s("q-btn",{directives:[{name:"show",rawName:"v-show",value:e.id>0,expression:"item.id > 0"}],staticClass:"button eu-button text-subtitle1 text-weight-bold",attrs:{"text-color":"black",label:e.name},on:{click:function(i){return t.onElevator(e.id)}}})],1)})),0),s("div",{staticClass:"q-pa-sm q-gutter-sm fixed-bottom row button-wrapper"},t._l(t.listEastDown,(function(e){return s("div",{key:e.id,staticClass:"col"},[s("q-btn",{directives:[{name:"show",rawName:"v-show",value:e.id>0,expression:"item.id > 0"}],staticClass:"button ed-button text-subtitle1 text-weight-bold",attrs:{"text-color":"black",label:e.name},on:{click:function(i){return t.onElevator(e.id)}}})],1)})),0)]),s("div",{directives:[{name:"show",rawName:"v-show",value:"W"===t.direction,expression:"direction === 'W'"}]},[s("div",{staticClass:"q-pa-sm q-gutter-sm row button-wrapper"},t._l(t.listWestUp,(function(e){return s("div",{key:e.id,staticClass:"col"},[s("q-btn",{directives:[{name:"show",rawName:"v-show",value:e.id>0,expression:"item.id > 0"}],staticClass:"button wu-button text-subtitle1 text-weight-bold",attrs:{"text-color":"black",label:e.name},on:{click:function(i){return t.onElevator(e.id)}}})],1)})),0),s("div",{staticClass:"q-pa-sm q-gutter-sm fixed-bottom row button-wrapper"},t._l(t.listWestDown,(function(e){return s("div",{key:e.id,staticClass:"col"},[s("q-btn",{directives:[{name:"show",rawName:"v-show",value:e.id>0,expression:"item.id > 0"}],staticClass:"button wd-button text-subtitle1 text-weight-bold",attrs:{"text-color":"black",label:e.name},on:{click:function(i){return t.onElevator(e.id)}}})],1)})),0)]),s("div",[s("q-avatar",{staticClass:"fixed-center",attrs:{size:"100px",rounded:""}},[s("img",{attrs:{src:i("bbb4"),draggable:"false"}})])],1)],2)],1)],1)},a=[],o=i("2b0e"),r=i("b178"),n=i("d257"),l=i("6462"),d=o["a"].extend({name:"MapNorth",data(){return{title:"Elevator Map",cardPK:"",buildingPK:"",groupId:0,listNorth:new Array,listSourth:new Array,listEastUp:new Array,listEastDown:new Array,listWestUp:new Array,listWestDown:new Array,direction:"N"}},methods:{notifyError(t){this.$q.notify({type:"negative",message:t})},onBack(){this.$router.back()},getList(){const t=this.$store.getters["FloorStore/GET_LAYOUT"],e=t.leftLayout,i=t.rightLayout;for(let s=0;s<e.length;s++)e[s].id>0&&this.listEastDown.push(e[s]);for(let s=0;s<i.length;s++)i[s].id>0&&this.listEastUp.push(i[s]);for(let s=e.length-1;s>=0;s--)e[s].id>0&&this.listWestUp.push(e[s]);for(let s=i.length-1;s>=0;s--)i[s].id>0&&this.listWestDown.push(i[s]);for(let s=0;s<e.length;s++)this.listNorth.push({leftId:e[s].id,leftName:e[s].name,rightId:i[s].id,rightName:i[s].name});for(let s=i.length-1;s>=0;s--)this.listSourth.push({leftId:i[s].id,leftName:i[s].name,rightId:e[s].id,rightName:e[s].name})},onElevator(t){this.$q.loading.show(),l["a"].OpenFloor(this.cardPK,this.buildingPK,t).then(t=>{this.$q.loading.hide(),t.data.ok?(this.$store.commit("FloorStore/REMOVE_FLOOR",this.groupId),this.onBack()):(this.notifyError(t.data.message),this.onBack())}).catch(t=>{this.$q.loading.hide(),this.notifyError(t.message),this.onBack()})},compass(t){t<68||t>292?this.direction="N":t>112&&t<248?this.direction="S":t>=68&&t<=112?this.direction="E":t>=248&&t<=292&&(this.direction="W")}},mounted(){const t=this.$route.params.buildingPK,e=this.$route.params.groupId;if(!t||!e)return this.notifyError("The parameter is not valid."),void this.onBack();this.buildingPK=t,this.groupId=Number.parseInt(e),this.cardPK=n["a"].getRemeberMe(),this.getList(),this.$q.platform.is.ios?window.addEventListener("deviceorientation",Object(r["f"])(t=>{if("webkitCompassHeading"in t){const e=t["webkitCompassHeading"]||0;this.compass(e)}else this.compass(t.alpha||0)},300),!1):window.addEventListener("deviceorientationabsolute",Object(r["f"])(t=>{null!==t.alpha&&this.compass(360-t.alpha)},300),!1)}}),c=d,h=(i("bf07"),i("2877")),u=Object(h["a"])(c,s,a,!1,null,"6f1ed130",null);e["default"]=u.exports},"73c9":function(t,e,i){"use strict";var s=i("e30d"),a=i.n(s);a.a},"7c80":function(t,e,i){},"88fb":function(t,e,i){"use strict";var s=i("e202"),a=i.n(s);a.a},"8be5":function(t,e,i){"use strict";var s=i("e29b"),a=i.n(s);a.a},"8eb7":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-layout",{attrs:{view:"lHh Lpr lFf"}},[s("q-header",{attrs:{elevated:""}},[s("q-toolbar",[s("q-btn",{attrs:{flat:"",dense:"",round:"",icon:"keyboard_backspace"},on:{click:t.onBack}}),s("q-toolbar-title",[t._v(t._s(t.title))])],1)],1),s("q-page-container",[s("q-page",{staticClass:"q-pa-sm"},[t._l(t.listEast,(function(e){return s("div",{directives:[{name:"show",rawName:"v-show",value:"E"===t.direction,expression:"direction === 'E'"}],key:e.leftId,staticClass:"q-pa-xs"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-5"},[s("q-btn",{directives:[{name:"show",rawName:"v-show",value:e.leftId>0,expression:"item.leftId > 0"}],staticClass:"button el-button text-subtitle1 text-weight-bold",attrs:{"text-color":"black",label:e.leftName},on:{click:function(i){return t.onElevator(e.leftId)}}})],1),s("div",{staticClass:"col"}),s("div",{staticClass:"col-5 column items-end"},[s("q-btn",{directives:[{name:"show",rawName:"v-show",value:e.rightId>0,expression:"item.rightId > 0"}],staticClass:"button er-button text-subtitle1 text-weight-bold",attrs:{"text-color":"black",label:e.rightName},on:{click:function(i){return t.onElevator(e.rightId)}}})],1)])])})),t._l(t.listWest,(function(e){return s("div",{directives:[{name:"show",rawName:"v-show",value:"W"===t.direction,expression:"direction === 'W'"}],key:e.leftId,staticClass:"q-pa-xs"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-5"},[s("q-btn",{directives:[{name:"show",rawName:"v-show",value:e.leftId>0,expression:"item.leftId > 0"}],staticClass:"button wl-button text-subtitle1 text-weight-bold",attrs:{"text-color":"black",label:e.leftName},on:{click:function(i){return t.onElevator(e.leftId)}}})],1),s("div",{staticClass:"col"}),s("div",{staticClass:"col-5 column items-end"},[s("q-btn",{directives:[{name:"show",rawName:"v-show",value:e.rightId>0,expression:"item.rightId > 0"}],staticClass:"button wr-button text-subtitle1 text-weight-bold",attrs:{"text-color":"black",label:e.rightName},on:{click:function(i){return t.onElevator(e.rightId)}}})],1)])])})),s("div",{directives:[{name:"show",rawName:"v-show",value:"N"===t.direction,expression:"direction === 'N'"}]},[s("div",{staticClass:"q-pa-sm q-gutter-sm row button-wrapper"},t._l(t.listNorthUp,(function(e){return s("div",{key:e.id,staticClass:"col"},[s("q-btn",{directives:[{name:"show",rawName:"v-show",value:e.id>0,expression:"item.id > 0"}],staticClass:"button nu-button text-subtitle1 text-weight-bold",attrs:{"text-color":"black",label:e.name},on:{click:function(i){return t.onElevator(e.id)}}})],1)})),0),s("div",{staticClass:"q-pa-sm q-gutter-sm fixed-bottom row button-wrapper"},t._l(t.listNorthDown,(function(e){return s("div",{key:e.id,staticClass:"col"},[s("q-btn",{directives:[{name:"show",rawName:"v-show",value:e.id>0,expression:"item.id > 0"}],staticClass:"button nd-button text-subtitle1 text-weight-bold",attrs:{"text-color":"black",label:e.name},on:{click:function(i){return t.onElevator(e.id)}}})],1)})),0)]),s("div",{directives:[{name:"show",rawName:"v-show",value:"S"===t.direction,expression:"direction === 'S'"}]},[s("div",{staticClass:"q-pa-sm q-gutter-sm row button-wrapper"},t._l(t.listSouthUp,(function(e){return s("div",{key:e.id,staticClass:"col"},[s("q-btn",{directives:[{name:"show",rawName:"v-show",value:e.id>0,expression:"item.id > 0"}],staticClass:"button su-button text-subtitle1 text-weight-bold",attrs:{"text-color":"black",label:e.name},on:{click:function(i){return t.onElevator(e.id)}}})],1)})),0),s("div",{staticClass:"q-pa-sm q-gutter-sm fixed-bottom row button-wrapper"},t._l(t.listSouthDown,(function(e){return s("div",{key:e.id,staticClass:"col"},[s("q-btn",{directives:[{name:"show",rawName:"v-show",value:e.id>0,expression:"item.id > 0"}],staticClass:"button sd-button text-subtitle1 text-weight-bold",attrs:{"text-color":"black",label:e.name},on:{click:function(i){return t.onElevator(e.id)}}})],1)})),0)]),s("div",[s("q-avatar",{staticClass:"fixed-center",attrs:{size:"100px",rounded:""}},[s("img",{attrs:{src:i("bbb4"),draggable:"false"}})])],1)],2)],1)],1)},a=[],o=i("2b0e"),r=i("b178"),n=i("d257"),l=i("6462"),d=o["a"].extend({name:"MapEast",data(){return{title:"Elevator Map",cardPK:"",buildingPK:"",groupId:0,listEast:new Array,listWest:new Array,listNorthUp:new Array,listNorthDown:new Array,listSouthUp:new Array,listSouthDown:new Array,direction:"E"}},methods:{notifyError(t){this.$q.notify({type:"negative",message:t})},onBack(){this.$router.back()},getList(){const t=this.$store.getters["FloorStore/GET_LAYOUT"],e=t.leftLayout,i=t.rightLayout;for(let s=0;s<e.length;s++)e[s].id>0&&this.listSouthDown.push(e[s]);for(let s=0;s<i.length;s++)i[s].id>0&&this.listSouthUp.push(i[s]);for(let s=e.length-1;s>=0;s--)e[s].id>0&&this.listNorthUp.push(e[s]);for(let s=i.length-1;s>=0;s--)i[s].id>0&&this.listNorthDown.push(i[s]);for(let s=0;s<e.length;s++)this.listEast.push({leftId:e[s].id,leftName:e[s].name,rightId:i[s].id,rightName:i[s].name});for(let s=i.length-1;s>=0;s--)this.listWest.push({leftId:i[s].id,leftName:i[s].name,rightId:e[s].id,rightName:e[s].name})},onElevator(t){this.$q.loading.show(),l["a"].OpenFloor(this.cardPK,this.buildingPK,t).then(t=>{this.$q.loading.hide(),t.data.ok?(this.$store.commit("FloorStore/REMOVE_FLOOR",this.groupId),this.onBack()):(this.notifyError(t.data.message),this.onBack())}).catch(t=>{this.$q.loading.hide(),this.notifyError(t.message),this.onBack()})},compass(t){t<68||t>292?this.direction="N":t>112&&t<248?this.direction="S":t>=68&&t<=112?this.direction="E":t>=248&&t<=292&&(this.direction="W")}},mounted(){const t=this.$route.params.buildingPK,e=this.$route.params.groupId;if(!t||!e)return this.notifyError("The parameter is not valid."),void this.onBack();this.buildingPK=t,this.groupId=Number.parseInt(e),this.cardPK=n["a"].getRemeberMe(),this.getList(),this.$q.platform.is.ios?window.addEventListener("deviceorientation",Object(r["f"])(t=>{if("webkitCompassHeading"in t){const e=t["webkitCompassHeading"]||0;this.compass(e)}else this.compass(t.alpha||0)},300),!1):window.addEventListener("deviceorientationabsolute",Object(r["f"])(t=>{null!==t.alpha&&this.compass(360-t.alpha)},300),!1)}}),c=d,h=(i("2ed7"),i("2877")),u=Object(h["a"])(c,s,a,!1,null,"6bc2ce53",null);e["default"]=u.exports},"94b5":function(t,e,i){},"980d":function(t,e,i){},"9d10":function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var s=i("2c75");class a{static Activate(t,e){const i={email:t,verifyCode:e};return s["a"].post("BizLogin_Activate",i)}static GetCardInfo(t){const e={pk:t};return s["a"].post("BizLogin_GetCardInfo",e)}static Login(t){return s["a"].post("BizLogin_Login",t)}static Register(t){return s["a"].post("BizLogin_Register",t)}static SendVerifyCode(t){const e={email:t};return s["a"].post("BizLogin_SendVerifyCode",e)}static UpdateEmail(t,e){const i={pk:t,email:e};return s["a"].post("BizLogin_UpdateEmail",i)}}},a014:function(t,e,i){},a14e:function(t,e,i){},a1d1:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("q-layout",[i("q-header",{attrs:{elevated:""}},[i("q-toolbar",[i("q-btn",{attrs:{flat:"",dense:"",round:"",icon:"keyboard_backspace"},on:{click:t.onBack}}),i("q-toolbar-title",[t._v(t._s(t.title))])],1)],1),i("q-page-container",[i("q-page",[i("div",{staticClass:"about"}),i("q-list",{staticClass:"flex justify-center"},[i("q-item",{staticClass:"text-blue-grey-3 text-h5"},[t._v(t._s("Version: "+t.version))])],1),i("q-list",{staticClass:"q-pt-lg text-center",attrs:{dense:""}},[i("q-item",[i("q-item-section",[i("q-item-label",{staticClass:"text-blue-7 text-subtitle2"},[t._v("Credential:\n              "),i("span",{staticClass:"text-grey-8"},[t._v(t._s(t.sitecode)+" - "+t._s(t.encoded))])])],1)],1),i("q-item",[i("q-item-section",[i("q-item-label",{staticClass:"text-blue-7 text-subtitle2"},[t._v("Latitude:\n              "),i("span",{staticClass:"text-grey-8"},[t._v(t._s(t.latitude))])])],1)],1),i("q-item",[i("q-item-section",[i("q-item-label",{staticClass:"text-blue-7 text-subtitle2"},[t._v("Longitude:\n              "),i("span",{staticClass:"text-grey-8"},[t._v(t._s(t.longitude))])])],1)],1),i("q-item",[i("q-item-section",[i("q-item-label",{staticClass:"text-blue-7 text-subtitle2"},[t._v("Orientation:\n              "),i("span",{staticClass:"text-grey-8"},[t._v(t._s(t.orientation))])])],1)],1)],1),i("q-list",{staticClass:"flex justify-center fixed-bottom"},[i("q-item",{attrs:{caption:""}},[t._v(" Datawatch Systems. All rights reserved.")])],1)],1)],1)],1)},a=[],o=i("2b0e"),r=i("b178"),n=i("d257"),l=o["a"].extend({name:"About",data(){return{title:"About",version:"1.1.2",sitecode:"",encoded:"",latitude:0,longitude:0,orientation:0}},methods:{notifyError(t){this.$q.notify({type:"negative",message:t})},onBack(){this.$router.back()},getGPSPosition(t){try{this.$q.loading.show(),navigator.geolocation.getCurrentPosition(e=>{this.$q.loading.hide(),t(e.coords.latitude,e.coords.longitude)},t=>{this.$q.loading.hide(),this.notifyError("The location service must be enabled.("+t.message+")"),this.onBack()},{maximumAge:3e5,timeout:3e4,enableHighAccuracy:!0})}catch(e){this.$q.loading.hide(),this.notifyError(e.message),this.onBack()}},showLocation(t,e){this.latitude=t,this.longitude=e},compass(t){this.orientation=t}},mounted(){this.version=n["a"].getVersion();const t=this.$store.getters["UserStore/GET_USER"];t.pk&&(this.sitecode=t.sitecode,this.encoded=t.encoded),this.getGPSPosition((t,e)=>{this.showLocation(t,e)}),this.$q.platform.is.ios?window.addEventListener("deviceorientation",Object(r["f"])(t=>{if("webkitCompassHeading"in t){const e=t["webkitCompassHeading"]||0;this.compass(e)}else this.compass(t.alpha||0)},300),!1):window.addEventListener("deviceorientationabsolute",Object(r["f"])(t=>{null!==t.alpha&&this.compass(360-t.alpha)},300),!1)}}),d=l,c=(i("585b"),i("2877")),h=Object(c["a"])(d,s,a,!1,null,"9f1c190e",null);e["default"]=h.exports},b2e9:function(t,e,i){t.exports=i.p+"img/elevator.png"},b47d:function(t,e,i){},b616:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("q-layout",{attrs:{view:"lHh Lpr lFf"}},[i("q-header",{attrs:{elevated:""}},[i("q-toolbar",[i("q-btn",{attrs:{flat:"",dense:"",round:"",icon:"keyboard_backspace"},on:{click:t.onBack}}),i("q-toolbar-title",[t._v(t._s(t.title))])],1)],1),i("q-page-container",{staticClass:"q-pl-md q-pr-md"},[i("q-page",[i("div",{staticClass:"row q-gutter-y-lg reverse-wrap button-wrapper justify-center"},t._l(t.list,(function(e,s){return i("div",{key:s,staticClass:"col-4"},[e.authorized&&e.floorId!==t.srcFloor?i("q-btn",{staticClass:"button text-subtitle1 text-weight-bold",attrs:{"text-color":"black",label:e.floorName},on:{click:function(i){return t.onFloor(e.floorId,e.floorName)}}}):i("q-btn",{staticClass:"button text-subtitle1 text-weight-bold",class:{"src-floor":e.floorId===t.srcFloor,"not-authorized-floor":!e.authorized},attrs:{label:e.floorName}})],1)})),0)])],1)],1)},a=[],o=i("2b0e"),r=i("d257"),n=i("6462"),l=o["a"].extend({name:"DstFloorList",data(){return{title:"Select your destination floor",cardPK:"",buildingPK:"",groupId:0,srcFloor:0,srcFloorName:"",list:new Array,idleTimebegin:0,idleTimeoutId:0}},methods:{notifyError(t){this.$q.notify({type:"negative",message:t})},startIdleTimout(){this.idleTimeoutId=window.setTimeout(()=>{this.doIdleWork()},1e3)},doIdleWork(){const t=Math.floor(((new Date).getTime()-this.idleTimebegin)/6e4);t>3?this.onBack():this.startIdleTimout()},onBack(){this.$router.back()},getList(){this.$q.loading.show(),n["a"].GetFloorList(this.cardPK,this.buildingPK,this.groupId).then(t=>{this.$q.loading.hide(),t.data.ok?(this.list=t.data.result,this.idleTimebegin=(new Date).getTime(),this.startIdleTimout()):(this.notifyError(t.data.message),this.onBack())}).catch(t=>{this.$q.loading.hide(),this.notifyError(t.message),this.onBack()})},onFloor(t,e){this.idleTimebegin=(new Date).getTime(),t!==this.srcFloor?(this.$q.loading.show(),n["a"].OpenCallUpDown({cardPK:this.cardPK,buildingPK:this.buildingPK,groupId:this.groupId,srcFloor:this.srcFloor,dstFloor:t}).then(i=>{this.$q.loading.hide(),this.idleTimebegin=(new Date).getTime(),i.data.ok?(this.$store.commit("FloorStore/ADD_FLOOR",{groupId:this.groupId,srcFloor:this.srcFloor,dstFloor:t,srcFloorName:this.srcFloorName,dstFloorName:e,selectTime:(new Date).getTime()}),"NoUp"===i.data.message?this.$q.dialog({title:"Warning",message:"The call buttons have not been wired.  Please push the UP button to call the elevator."}).onOk(()=>{this.onBack()}):"NoDown"===i.data.message?this.$q.dialog({title:"Warning",message:"The call buttons have not been wired.  Please push the DOWN button to call the elevator."}).onOk(()=>{this.onBack()}):this.onBack()):this.notifyError(i.data.message)}).catch(t=>{this.notifyError(t.message),this.$q.loading.hide(),this.idleTimebegin=(new Date).getTime()})):this.onBack()}},mounted(){const t=this.$route.params.id,e=this.$route.params.group,i=this.$route.params.srcFloor,s=this.$route.params.srcFloorName;if(!t||!e||!i||!s)return this.notifyError("The parameter is not valid."),void this.onBack();this.buildingPK=t,this.groupId=Number.parseInt(e),this.srcFloor=Number.parseInt(i),this.srcFloorName=s,this.cardPK=r["a"].getRemeberMe(),this.getList()},beforeDestroy(){this.idleTimeoutId&&clearTimeout(this.idleTimeoutId)}}),d=l,c=(i("ecb6"),i("2877")),h=Object(c["a"])(d,s,a,!1,null,"4f6a94cc",null);e["default"]=h.exports},ba51:function(t,e,i){"use strict";var s=i("d59c"),a=i.n(s);a.a},bbb4:function(t,e,i){t.exports=i.p+"img/guest.png"},bf07:function(t,e,i){"use strict";var s=i("e6c7"),a=i.n(s);a.a},c19d:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("q-layout",[i("q-page-container",[i("q-page",{staticClass:"flex flex-center bg-primary"},[i("div",[i("div",{staticClass:"input-content"},[i("input",{directives:[{name:"model",rawName:"v-model.trim.number",value:t.input1,expression:"input1",modifiers:{trim:!0,number:!0}}],ref:"input1",attrs:{type:"number",maxlength:"1"},domProps:{value:t.input1},on:{keydown:function(e){return t.keydown1(e)},keyup:function(e){return t.keyup1(e)},input:function(e){e.target.composing||(t.input1=t._n(e.target.value.trim()))},blur:function(e){return t.$forceUpdate()}}}),i("input",{directives:[{name:"model",rawName:"v-model.trim.number",value:t.input2,expression:"input2",modifiers:{trim:!0,number:!0}}],ref:"input2",attrs:{type:"number",maxlength:"1"},domProps:{value:t.input2},on:{keydown:function(e){return t.keydown2(e)},keyup:function(e){return t.keyup2(e)},input:function(e){e.target.composing||(t.input2=t._n(e.target.value.trim()))},blur:function(e){return t.$forceUpdate()}}}),i("input",{directives:[{name:"model",rawName:"v-model.trim.number",value:t.input3,expression:"input3",modifiers:{trim:!0,number:!0}}],ref:"input3",attrs:{type:"number",maxlength:"1"},domProps:{value:t.input3},on:{keydown:function(e){return t.keydown3(e)},keyup:function(e){return t.keyup3(e)},input:function(e){e.target.composing||(t.input3=t._n(e.target.value.trim()))},blur:function(e){return t.$forceUpdate()}}}),i("input",{directives:[{name:"model",rawName:"v-model.trim.number",value:t.input4,expression:"input4",modifiers:{trim:!0,number:!0}}],ref:"input4",attrs:{type:"number",maxlength:"1"},domProps:{value:t.input4},on:{keydown:function(e){return t.keydown4(e)},keyup:function(e){return t.keyup4(e)},input:function(e){e.target.composing||(t.input4=t._n(e.target.value.trim()))},blur:function(e){return t.$forceUpdate()}}}),i("input",{directives:[{name:"model",rawName:"v-model.trim.number",value:t.input5,expression:"input5",modifiers:{trim:!0,number:!0}}],ref:"input5",attrs:{type:"number",maxlength:"1"},domProps:{value:t.input5},on:{keydown:function(e){return t.keydown5(e)},keyup:function(e){return t.keyup5(e)},input:function(e){e.target.composing||(t.input5=t._n(e.target.value.trim()))},blur:function(e){return t.$forceUpdate()}}}),i("input",{directives:[{name:"model",rawName:"v-model.trim.number",value:t.input6,expression:"input6",modifiers:{trim:!0,number:!0}}],ref:"input6",attrs:{type:"number",maxlength:"1"},domProps:{value:t.input6},on:{keydown:function(e){return t.keydown6(e)},keyup:function(e){return t.keyup6(e)},input:function(e){e.target.composing||(t.input6=t._n(e.target.value.trim()))},blur:function(e){return t.$forceUpdate()}}})]),i("div",{staticClass:"resend text-center"},[i("p",{staticStyle:{color:"white"}},[t._v(t._s(t.email))]),i("q-btn",{attrs:{disable:t.timeoutSeconds>0,color:0===t.timeoutSeconds?"green":"dark",icon:"mail","icon-right":"send",label:0===t.timeoutSeconds?"Resend Verify code":"Resend Verify code ("+t.timeoutSeconds+")"},on:{click:t.onResendVerifyCode}})],1),i("div",{staticClass:"activate"},[i("q-btn",{staticClass:"full-width",attrs:{label:"Activate",type:"submit",color:"white","text-color":"black"},on:{click:t.onLogin}})],1)])])],1)],1)},a=[],o=i("2b0e"),r=i("9d10"),n=i("d257"),l=o["a"].extend({name:"Activate",data(){return{pk:"",email:"",input1:"",input2:"",input3:"",input4:"",input5:"",input6:"",timeoutSeconds:60}},methods:{notifyError(t){this.$q.notify({type:"negative",message:t})},onResendVerifyCode(){this.$q.loading.show(),r["a"].SendVerifyCode(this.email).then(t=>{this.$q.loading.hide(),t.data.ok?(this.timeoutSeconds=60,this.startResendTimout()):this.notifyError(t.data.message)}).catch(t=>{this.$q.loading.hide(),this.notifyError(t.message)})},onLogin(){if(0===this.input1.length||0===this.input2.length||0===this.input3.length||0===this.input4.length||0===this.input5.length||0===this.input6.length)return void this.notifyError("Please enter the verify code first.");this.$q.loading.show();const t=this.input1+this.input2+this.input3+this.input4+this.input5+this.input6;r["a"].Activate(this.email,t).then(t=>{this.$q.loading.hide(),t.data.ok?(n["a"].setRemeberMe(this.pk),this.$router.replace({name:"Dashboard"})):this.notifyError(t.data.message)}).catch(t=>{this.$q.loading.hide(),this.notifyError(t.message)})},startResendTimout(){setTimeout(()=>{this.setResendTimout()},1e3)},setResendTimout(){this.timeoutSeconds-=1,this.timeoutSeconds>0&&this.startResendTimout()},keydown1(t){8===t.keyCode&&(this.input1.length>0?this.input1="":this.$nextTick(()=>{this.$refs.input1.focus(),this.input1=""}))},keydown2(t){8===t.keyCode&&(this.input2.length>0?this.input2="":this.$nextTick(()=>{this.$refs.input1.focus(),this.input1=""}))},keydown3(t){8===t.keyCode&&(this.input3.length>0?this.input3="":this.$nextTick(()=>{this.$refs.input2.focus(),this.input2=""}))},keydown4(t){8===t.keyCode&&(this.input4.length>0?this.input4="":this.$nextTick(()=>{this.$refs.input3.focus(),this.input3=""}))},keydown5(t){8===t.keyCode&&(this.input5.length>0?this.input5="":this.$nextTick(()=>{this.$refs.input4.focus(),this.input4=""}))},keydown6(t){8===t.keyCode&&(this.input6.length>0?this.input6="":this.$nextTick(()=>{this.$refs.input5.focus(),this.input5=""}))},keyup1(t){8!==t.keyCode&&this.$nextTick(()=>{this.$refs.input2.focus(),this.input1=this.input1.toString().slice(-1)})},keyup2(t){8!==t.keyCode&&this.$nextTick(()=>{this.$refs.input3.focus(),this.input2=this.input2.toString().slice(-1)})},keyup3(t){8!==t.keyCode&&this.$nextTick(()=>{this.$refs.input4.focus(),this.input3=this.input3.toString().slice(-1)})},keyup4(t){8!==t.keyCode&&this.$nextTick(()=>{this.$refs.input5.focus(),this.input4=this.input4.toString().slice(-1)})},keyup5(t){8!==t.keyCode&&this.$nextTick(()=>{this.$refs.input6.focus(),this.input5=this.input5.toString().slice(-1)})},keyup6(t){8!==t.keyCode&&this.$nextTick(()=>{this.$refs.input6.blur(),this.input6=this.input6.toString().slice(-1)})}},mounted(){const t=this.$store.getters["UserStore/GET_USER"];this.pk=t.pk,this.email=t.email,this.startResendTimout(),this.$refs.input1.focus()}}),d=l,c=(i("ef09"),i("2877")),h=Object(c["a"])(d,s,a,!1,null,"77b435af",null);e["default"]=h.exports},c5d4:function(t,e,i){t.exports=i.p+"img/arrow.png"},c75e:function(t,e,i){},d257:function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));class s{static setRemeberMe(t){localStorage.setItem("D3000_VirtualKey_key",t)}static getRemeberMe(){return localStorage.getItem("D3000_VirtualKey_key")||""}static clearRemeberMe(){localStorage.removeItem("D3000_VirtualKey_key")}static setAuthorization(t){sessionStorage.setItem("D3000_VirtualKey_authorization",t)}static getAuthorization(){return sessionStorage.getItem("D3000_VirtualKey_authorization")||""}static clearAuthorization(){sessionStorage.removeItem("D3000_VirtualKey_authorization")}static hasAuthorization(){const t=sessionStorage.getItem("D3000_VirtualKey_authorization")||"";return t.length>0}static getVersion(){return"1.2.4"}static getTicks(){const t=621355968e9,e=1e4;return t+(new Date).getTime()*e}static encryptPassword(t,e){const i=[];for(let s=0;s<e.length;s++)if(s<t.length){const a=e.charCodeAt(s)+t.charCodeAt(s)-35;i.push(a.toString())}else{const t=e.charCodeAt(s)+5;i.push(t.toString())}return i.join(" ")+" "}static encryptPK(t){return t.replace(/-/g,"")}static decryptPK(t){if(32!==t.length)return t;let e=t.substring(0,8);return e+="-",e+=t.substring(8,12),e+="-",e+=t.substring(12,16),e+="-",e+=t.substring(16,20),e+="-",e+=t.substring(20),e}}},d294:function(t,e,i){"use strict";var s=i("a014"),a=i.n(s);a.a},d314:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("q-layout",{attrs:{view:"lHh Lpr lFf"}},[i("q-header",{attrs:{elevated:""}},[i("q-toolbar",[i("q-btn",{attrs:{flat:"",dense:"",round:"",icon:"keyboard_backspace"},on:{click:t.onBack}}),i("q-toolbar-title",[t._v(t._s(t.title))])],1)],1),i("q-page-container",[i("q-page",t._l(t.list,(function(e,s){return i("q-list",{key:s,staticClass:"text-h6",attrs:{bordered:"",separator:""}},[i("q-item",[i("q-item-section",[i("q-item-label",[t._v(t._s(e.area))]),i("q-item-label",{attrs:{caption:""}},[t._v(t._s(e.currentTotal+"/"+e.restrictTotal))])],1),i("q-item-section",{attrs:{avatar:""}},[i("q-linear-progress",{staticClass:"q-mt-sm",attrs:{size:"30px",value:e.percent,color:e.color}},[i("div",{staticClass:"absolute-full flex flex-center"},[i("q-badge",{attrs:{color:"white","text-color":"accent",label:(100*e.percent).toFixed()+"%"}})],1)])],1)],1)],1)})),1)],1)],1)},a=[],o=i("2b0e"),r=i("44ef"),n=o["a"].extend({name:"AreaDensity",data(){return{title:"Area Density",buildingPK:"",list:new Array,idleTimebegin:0,idleTimeoutId:0}},methods:{notifyError(t){this.$q.notify({type:"negative",message:t})},startIdleTimout(){this.idleTimeoutId=window.setTimeout(()=>{this.doIdleWork()},1e3)},doIdleWork(){const t=Math.floor(((new Date).getTime()-this.idleTimebegin)/6e4);t>3?this.onBack():this.startIdleTimout()},onBack(){this.$router.back()},getAreaDensity(){this.$q.loading.show(),r["a"].GetAreaPeopleList(this.buildingPK).then(t=>{if(this.$q.loading.hide(),t.data.ok){for(const e of t.data.result){const t=e.currentTotal/e.restrictTotal,i={area:e.area,restrictTotal:e.restrictTotal,currentTotal:e.currentTotal,percent:t,color:"green"};i.color=t<.5?"green":t>=.5&&t<=.8?"yellow":"red",this.list.push(i)}this.idleTimebegin=(new Date).getTime(),this.startIdleTimout()}else this.notifyError(t.data.message),this.onBack()}).catch(t=>{this.$q.loading.hide(),this.notifyError(t.message),this.onBack()})}},mounted(){const t=this.$route.params.id;if(!t)return this.notifyError("The parameter is not valid."),void this.onBack();this.buildingPK=t,this.getAreaDensity()},beforeDestroy(){this.idleTimeoutId&&clearTimeout(this.idleTimeoutId)}}),l=n,d=(i("f621"),i("2877")),c=Object(d["a"])(l,s,a,!1,null,"307ac236",null);e["default"]=c.exports},d386:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-layout",{attrs:{view:"lHh Lpr lFf"}},[s("q-header",{attrs:{elevated:""}},[s("q-toolbar",[s("q-btn",{attrs:{flat:"",dense:"",round:"",icon:"keyboard_backspace"},on:{click:t.onBack}}),s("q-toolbar-title",[t._v(t._s(t.title))])],1)],1),s("q-page-container",[s("q-page",{staticClass:"q-pa-sm"},[t._l(t.listEast,(function(e){return s("div",{directives:[{name:"show",rawName:"v-show",value:"E"===t.direction,expression:"direction === 'E'"}],key:e.leftId,staticClass:"q-pa-xs"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-5"},[s("q-btn",{directives:[{name:"show",rawName:"v-show",value:e.leftId>0,expression:"item.leftId > 0"}],staticClass:"button el-button text-subtitle1 text-weight-bold",attrs:{"text-color":"black",label:e.leftName},on:{click:function(i){return t.onElevator(e.leftId)}}})],1),s("div",{staticClass:"col"}),s("div",{staticClass:"col-5 column items-end"},[s("q-btn",{directives:[{name:"show",rawName:"v-show",value:e.rightId>0,expression:"item.rightId > 0"}],staticClass:"button er-button text-subtitle1 text-weight-bold",attrs:{"text-color":"black",label:e.rightName},on:{click:function(i){return t.onElevator(e.rightId)}}})],1)])])})),t._l(t.listWest,(function(e){return s("div",{directives:[{name:"show",rawName:"v-show",value:"W"===t.direction,expression:"direction === 'W'"}],key:e.leftId,staticClass:"q-pa-xs"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-5"},[s("q-btn",{directives:[{name:"show",rawName:"v-show",value:e.leftId>0,expression:"item.leftId > 0"}],staticClass:"button wl-button text-subtitle1 text-weight-bold",attrs:{"text-color":"black",label:e.leftName},on:{click:function(i){return t.onElevator(e.leftId)}}})],1),s("div",{staticClass:"col"}),s("div",{staticClass:"col-5 column  items-end"},[s("q-btn",{directives:[{name:"show",rawName:"v-show",value:e.rightId>0,expression:"item.rightId > 0"}],staticClass:"button wr-button text-subtitle1 text-weight-bold",attrs:{"text-color":"black",label:e.rightName},on:{click:function(i){return t.onElevator(e.rightId)}}})],1)])])})),s("div",{directives:[{name:"show",rawName:"v-show",value:"N"===t.direction,expression:"direction === 'N'"}]},[s("div",{staticClass:"q-pa-sm q-gutter-sm row button-wrapper"},t._l(t.listNorthUp,(function(e){return s("div",{key:e.id,staticClass:"col"},[s("q-btn",{directives:[{name:"show",rawName:"v-show",value:e.id>0,expression:"item.id > 0"}],staticClass:"button nu-button text-subtitle1 text-weight-bold",attrs:{"text-color":"black",label:e.name},on:{click:function(i){return t.onElevator(e.id)}}})],1)})),0),s("div",{staticClass:"q-pa-sm q-gutter-sm fixed-bottom row button-wrapper"},t._l(t.listNorthDown,(function(e){return s("div",{key:e.id,staticClass:"col"},[s("q-btn",{directives:[{name:"show",rawName:"v-show",value:e.id>0,expression:"item.id > 0"}],staticClass:"button nd-button text-subtitle1 text-weight-bold",attrs:{"text-color":"black",label:e.name},on:{click:function(i){return t.onElevator(e.id)}}})],1)})),0)]),s("div",{directives:[{name:"show",rawName:"v-show",value:"S"===t.direction,expression:"direction === 'S'"}]},[s("div",{staticClass:"q-pa-sm q-gutter-sm row button-wrapper"},t._l(t.listSouthUp,(function(e){return s("div",{key:e.id,staticClass:"col"},[s("q-btn",{directives:[{name:"show",rawName:"v-show",value:e.id>0,expression:"item.id > 0"}],staticClass:"button su-button text-subtitle1 text-weight-bold",attrs:{"text-color":"black",label:e.name},on:{click:function(i){return t.onElevator(e.id)}}})],1)})),0),s("div",{staticClass:"q-pa-sm q-gutter-sm fixed-bottom row button-wrapper"},t._l(t.listSouthDown,(function(e){return s("div",{key:e.id,staticClass:"col"},[s("q-btn",{directives:[{name:"show",rawName:"v-show",value:e.id>0,expression:"item.id > 0"}],staticClass:"button sd-button text-subtitle1 text-weight-bold",attrs:{"text-color":"black",label:e.name},on:{click:function(i){return t.onElevator(e.id)}}})],1)})),0)]),s("div",[s("q-avatar",{staticClass:"fixed-center",attrs:{size:"100px",rounded:""}},[s("img",{attrs:{src:i("bbb4"),draggable:"false"}})])],1)],2)],1)],1)},a=[],o=i("2b0e"),r=i("b178"),n=i("d257"),l=i("6462"),d=o["a"].extend({name:"MapWest",data(){return{title:"Elevator Map",cardPK:"",buildingPK:"",groupId:0,listEast:new Array,listWest:new Array,listNorthUp:new Array,listNorthDown:new Array,listSouthUp:new Array,listSouthDown:new Array,direction:"W"}},methods:{notifyError(t){this.$q.notify({type:"negative",message:t})},onBack(){this.$router.back()},getList(){const t=this.$store.getters["FloorStore/GET_LAYOUT"],e=t.leftLayout,i=t.rightLayout;for(let s=0;s<e.length;s++)e[s].id>0&&this.listNorthDown.push(e[s]);for(let s=0;s<i.length;s++)i[s].id>0&&this.listNorthUp.push(i[s]);for(let s=e.length-1;s>=0;s--)e[s].id>0&&this.listSouthUp.push(e[s]);for(let s=i.length-1;s>=0;s--)i[s].id>0&&this.listSouthDown.push(i[s]);for(let s=0;s<e.length;s++)this.listWest.push({leftId:e[s].id,leftName:e[s].name,rightId:i[s].id,rightName:i[s].name});for(let s=i.length-1;s>=0;s--)this.listEast.push({leftId:i[s].id,leftName:i[s].name,rightId:e[s].id,rightName:e[s].name})},onElevator(t){this.$q.loading.show(),l["a"].OpenFloor(this.cardPK,this.buildingPK,t).then(t=>{this.$q.loading.hide(),t.data.ok?(this.$store.commit("FloorStore/REMOVE_FLOOR",this.groupId),this.onBack()):(this.notifyError(t.data.message),this.onBack())}).catch(t=>{this.$q.loading.hide(),this.notifyError(t.message),this.onBack()})},compass(t){t<68||t>292?this.direction="N":t>112&&t<248?this.direction="S":t>=68&&t<=112?this.direction="E":t>=248&&t<=292&&(this.direction="W")}},mounted(){const t=this.$route.params.buildingPK,e=this.$route.params.groupId;if(!t||!e)return this.notifyError("The parameter is not valid."),void this.onBack();this.buildingPK=t,this.groupId=Number.parseInt(e),this.cardPK=n["a"].getRemeberMe(),this.getList(),this.$q.platform.is.ios?window.addEventListener("deviceorientation",Object(r["f"])(t=>{if("webkitCompassHeading"in t){const e=t["webkitCompassHeading"]||0;this.compass(e)}else this.compass(t.alpha||0)},300),!1):window.addEventListener("deviceorientationabsolute",Object(r["f"])(t=>{null!==t.alpha&&this.compass(360-t.alpha)},300),!1)}}),c=d,h=(i("73c9"),i("2877")),u=Object(h["a"])(c,s,a,!1,null,"703f17f5",null);e["default"]=u.exports},d59c:function(t,e,i){},dc61:function(t,e,i){},df0f:function(t,e,i){t.exports=i.p+"img/numbers.png"},e202:function(t,e,i){},e29b:function(t,e,i){},e30d:function(t,e,i){},e34b:function(t,e,i){},e425:function(t,e,i){},e6c7:function(t,e,i){},eb99:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("q-layout",{attrs:{view:"lHh Lpr lFf"}},[i("q-header",{attrs:{elevated:""}},[i("q-toolbar",[i("q-btn",{attrs:{flat:"",dense:"",round:"",icon:"keyboard_backspace"},on:{click:t.onBack}}),i("q-toolbar-title",[t._v(t._s(t.title))])],1)],1),i("q-page-container",{staticClass:"q-pl-md q-pr-md"},[i("q-page",[0===t.srcFloorName.length?i("div",{staticClass:"row q-gutter-y-lg reverse-wrap button-wrapper justify-center"},t._l(t.list,(function(e,s){return i("div",{key:s,staticClass:"col-4"},[i("q-btn",{staticClass:"button text-subtitle1 text-weight-bold",attrs:{"text-color":"black",label:e.floorName},on:{click:function(i){return t.onSrcFloor(e.floorId,e.floorName)}}})],1)})),0):i("div",{staticClass:"row q-gutter-y-lg reverse-wrap button-wrapper justify-center"},t._l(t.list,(function(e,s){return i("div",{key:s,staticClass:"col-4"},[e.authorized&&e.floorId!==t.srcFloor?i("q-btn",{staticClass:"button text-subtitle1 text-weight-bold",attrs:{"text-color":"black",label:e.floorName},on:{click:function(i){return t.onDstFloor(e.floorId,e.floorName)}}}):i("q-btn",{staticClass:"button text-subtitle1 text-weight-bold",class:{"src-floor":e.floorId===t.srcFloor,"not-authorized-floor":!e.authorized},attrs:{label:e.floorName,icon:e.icon}})],1)})),0)])],1)],1)},a=[],o=i("2b0e"),r=i("d257"),n=i("6462"),l=o["a"].extend({name:"FloorList",data(){return{title:"Select your location",cardPK:"",buildingPK:"",groupId:0,srcFloor:-9999,srcFloorName:"",list:new Array,idleTimebegin:0,idleTimeoutId:0}},methods:{notifyError(t){this.$q.notify({type:"negative",message:t})},startIdleTimout(){this.idleTimeoutId=window.setTimeout(()=>{this.doIdleWork()},1e3)},doIdleWork(){const t=Math.floor(((new Date).getTime()-this.idleTimebegin)/6e4);t>3?this.onBack():this.startIdleTimout()},onBack(){this.$router.back()},getList(){this.$q.loading.show(),n["a"].GetFloorList(this.cardPK,this.buildingPK,this.groupId).then(t=>{if(this.$q.loading.hide(),t.data.ok){for(const e of t.data.result)this.list.push({pk:e.pk,floorId:e.floorId,floorName:e.floorName,authorized:e.authorized,icon:""});this.idleTimebegin=(new Date).getTime(),this.startIdleTimout()}else this.notifyError(t.data.message),this.onBack()}).catch(t=>{this.$q.loading.hide(),this.notifyError(t.message),this.onBack()})},onSrcFloor(t,e){this.title="Select your destination floor",this.srcFloor=t,this.srcFloorName=e;for(const i of this.list)i.floorId!==this.srcFloor?i.authorized||(i.icon="block"):i.icon="accessibility"},onDstFloor(t,e){this.idleTimebegin=(new Date).getTime(),t!==this.srcFloor?(this.$q.loading.show(),n["a"].OpenCallUpDown({cardPK:this.cardPK,buildingPK:this.buildingPK,groupId:this.groupId,srcFloor:this.srcFloor,dstFloor:t}).then(i=>{this.$q.loading.hide(),this.idleTimebegin=(new Date).getTime(),i.data.ok?(this.$store.commit("FloorStore/ADD_FLOOR",{groupId:this.groupId,srcFloor:this.srcFloor,dstFloor:t,srcFloorName:this.srcFloorName,dstFloorName:e,selectTime:(new Date).getTime()}),"NoUp"===i.data.message?this.$q.dialog({title:"Warning",message:"The call buttons have not been wired.  Please push the UP button to call the elevator."}).onOk(()=>{this.onBack()}):"NoDown"===i.data.message?this.$q.dialog({title:"Warning",message:"The call buttons have not been wired.  Please push the DOWN button to call the elevator."}).onOk(()=>{this.onBack()}):this.onBack()):this.notifyError(i.data.message)}).catch(t=>{this.notifyError(t.message),this.$q.loading.hide(),this.idleTimebegin=(new Date).getTime()})):this.onBack()}},mounted(){const t=this.$route.params.id,e=this.$route.params.group;if(!t||!e)return this.notifyError("The parameter is not valid."),void this.onBack();this.buildingPK=t,this.groupId=Number.parseInt(e),this.cardPK=r["a"].getRemeberMe(),this.getList()},beforeDestroy(){this.idleTimeoutId&&clearTimeout(this.idleTimeoutId)}}),d=l,c=(i("8be5"),i("2877")),h=Object(c["a"])(d,s,a,!1,null,"c56d7e50",null);e["default"]=h.exports},ec95:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-layout",{attrs:{view:"lHh Lpr lFf"}},[s("q-header",{attrs:{elevated:""}},[s("q-toolbar",[s("q-btn",{attrs:{flat:"",dense:"",round:"",icon:"menu"},on:{click:function(e){t.leftDrawerOpen=!t.leftDrawerOpen}}}),s("q-toolbar-title",[t._v(t._s(t.title))]),s("q-btn",{attrs:{flat:"",dense:"",round:"",icon:"gps_fixed"},on:{click:t.onSearchBuilding}})],1)],1),s("q-footer",{attrs:{elevated:""}},[s("q-toolbar",{staticClass:"row justify-around bg-primary text-white"},[s("q-btn",{attrs:{flat:"",dense:"",stack:"",icon:"sim_card",label:"Reader"},on:{click:t.onCategoryList}}),s("q-btn",{staticClass:"bicode",attrs:{flat:"",dense:"",stack:"",icon:"camera",label:"QRCode"},on:{click:t.onScanReader}}),s("q-btn",{attrs:{flat:"",dense:"",stack:"",icon:"star",label:"Favorite"},on:{click:t.onFavorite}})],1)],1),s("q-drawer",{ref:"drawer",attrs:{"show-if-above":"",bordered:"","content-class":"bg-primary text-white"},model:{value:t.leftDrawerOpen,callback:function(e){t.leftDrawerOpen=e},expression:"leftDrawerOpen"}},[s("q-list",[s("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{clickable:""},on:{click:t.onLogout}},[s("q-item-section",{attrs:{avatar:""}},[s("q-icon",{attrs:{name:"person"}})],1),s("q-item-section",[s("q-item-label",[t._v("Register")])],1)],1),s("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{clickable:""},on:{click:t.onAbout}},[s("q-item-section",{attrs:{avatar:""}},[s("q-icon",{attrs:{name:"info"}})],1),s("q-item-section",[s("q-item-label",[t._v("About")])],1)],1)],1)],1),s("q-page-container",[s("q-page",{staticClass:"flex text-center bg-grey-1"},[s("div",{staticStyle:{width:"100%"}},[s("div",{staticClass:"bg"},[s("img",{staticStyle:{"margin-top":"20px"},attrs:{src:i("5d7e")}})]),t.photo&&t.photo.length>0?s("q-avatar",{staticClass:"photo",attrs:{size:"80px"}},[s("img",{attrs:{src:"data:image/jpeg;base64,"+t.photo}})]):s("q-avatar",{staticClass:"photo",attrs:{icon:"person",color:"white","text-color":"blue-grey-2",size:"80px"}}),s("h6",{staticClass:"text-blue-grey-4"},[t._v("Welcome")]),s("h4",{staticClass:"text-grey-9",staticStyle:{"margin-bottom":"20px"}},[t._v("\n          "+t._s(t.firstName+" "+t.lastName)+"\n        ")]),s("div",{staticClass:"area-temp"},[s("q-btn",{staticClass:"q-mr-xl",attrs:{flat:"",dense:"",stack:"",icon:"people"},on:{click:t.onAreaDensity}},[t._v("\n            Area"),s("br"),t._v("Density\n          ")]),s("q-btn",{attrs:{flat:"",dense:"",stack:"",icon:"watch_later"},on:{click:t.onTempAccess}},[t._v("\n            Temp"),s("br"),t._v("Access\n          ")])],1)],1)])],1)],1)},a=[],o=i("2b0e"),r=i("d257"),n=i("b178");class l{static scanQRCode(t){n["d"].is.cordova?cordova.plugins.barcodeScanner.scan(e=>{e.cancelled||t(e.text)},t=>{l.showError("Scanning failed: "+t.message)},{preferFrontCamera:!1,showFlipCameraButton:!0,showTorchButton:!0,torchOn:!1,saveHistory:!0,prompt:"Place a barcode inside the scan area",resultDisplayDuration:500,formats:"QR_CODE",orientation:"portrait",disableAnimations:!0,disableSuccessBeep:!1}):l.showError("Scanning must be in mobile.")}static takePicture(t){n["d"].is.cordova?l.takePictureByCordova(t):n["d"].is.desktop?l.takePictureByDesktop(t):l.takePictureByMobile(t)}static showError(t){n["a"].create({title:"Error",message:t})}static takePictureByCordova(t){const e=navigator.camera;e?e.getPicture(t,()=>{},{quality:45,destinationType:0,sourceType:1,allowEdit:!0,encodingType:0,targetWidth:250,targetHeight:250}):l.showError("The camera does not exist in the cordova.")}static takePictureByDesktop(t){const e=document.createElement("input");e.setAttribute("type","file"),e.setAttribute("accept","image/*;capture=camera"),e.addEventListener("change",e=>{const i=e.currentTarget;if(!i||!i.files)return;const s=i.files[0];if(!s)return;const a=new FileReader;a.addEventListener("load",e=>{if(!e.target||!e.target.result)return;const i=e.target.result,s=document.createElement("canvas"),a=document.createElement("img");a.addEventListener("error",()=>{alert("Fail to load image(desktop).")}),a.addEventListener("load",()=>{const e=250;s.width=e,s.height=e;const i=s.getContext("2d");if(!i)return;let o,r;i.clearRect(0,0,e,e);let n=0,l=0;a.width>a.height?(o=Math.round(e*a.width/a.height),r=e,n=-Math.round((o-e)/2)):(r=Math.round(e*a.height/a.width),o=e,l=-Math.round((r-e)/2)),i.drawImage(a,n,l,o,r);const d=s.toDataURL("image/jpeg",.5),c=d.substr(23);t(c)},!1),a.setAttribute("src",i)}),a.readAsDataURL(s)}),e.click()}static takePictureByMobile(t){const e=document.createElement("input");e.setAttribute("type","file"),e.setAttribute("accept","image/*;capture=camera"),e.addEventListener("change",e=>{const i=e.currentTarget;if(!i||!i.files)return;const s=i.files[0];if(!s)return;const a=document.createElement("img");a.addEventListener("error",()=>{alert("Fail to load image(mobile).")}),a.addEventListener("load",()=>{window.URL.revokeObjectURL(a.src);const e=document.createElement("canvas"),i=250;e.width=i,e.height=i;const s=e.getContext("2d");if(!s)return;let o,r;s.clearRect(0,0,i,i);let n=0,l=0;a.width>a.height?(o=Math.round(i*a.width/a.height),r=i,n=-Math.round((o-i)/2)):(r=Math.round(i*a.height/a.width),o=i,l=-Math.round((r-i)/2)),s.drawImage(a,n,l,o,r);const d=e.toDataURL("image/jpeg",.5),c=d.substr(23);t(c)},!1),a.setAttribute("src",window.URL.createObjectURL(s))}),e.click()}}var d=i("3553"),c=i("44ef"),h=i("6462");class u{static getActivatedShortcuts(){try{cordova.plugins.SiriShortcuts.getActivatedShortcut({clear:!0},t=>{if(!t)return null;const e=t.persistentIdentifier.split("|");return 3!==e.length?null:{shortCutType:e[0],buildingPK:e[1],userInfo:t.userInfo}},t=>(n["c"].create({type:"negative",message:t}),null))}catch(t){return n["c"].create({type:"negative",message:t.message}),null}}static OpenDoor(t,e){n["b"].show(),d["a"].OpenDoor(t,e).then(t=>{n["b"].hide(),t.data.ok?n["c"].create({type:"positive",message:"This action is complete"}):n["c"].create({type:"negative",message:t.data.message})}).catch(t=>{n["c"].create({type:"negative",message:t.message}),n["b"].hide()})}static openElevator(t,e,i,s,a,o){n["b"].show(),h["a"].OpenCallUpDown({cardPK:t,buildingPK:e,groupId:i,srcFloor:s,dstFloor:a}).then(t=>{n["b"].hide(),t.data.ok?"NoUp"===t.data.message?n["a"].create({title:"Warning",message:"The call buttons have not been wired.  Please push the UP button to call the elevator."}).onOk(()=>{u.loadMap(e,i,s,o)}):"NoDown"===t.data.message?n["a"].create({title:"Warning",message:"The call buttons have not been wired.  Please push the DOWN button to call the elevator."}).onOk(()=>{u.loadMap(e,i,s,o)}):u.loadMap(e,i,s,o):n["c"].create({type:"negative",message:t.data.message})}).catch(t=>{n["c"].create({type:"negative",message:t.message}),n["b"].hide()})}static loadMap(t,e,i,s){n["b"].show(),c["a"].GetElevatorLayout(t,e,i).then(i=>{n["b"].hide(),i.data.ok?s(t,e,i.data.result):n["c"].create({type:"negative",message:i.data.message})}).catch(t=>{n["b"].hide(),n["c"].create({type:"negative",message:t.message})})}}var g=o["a"].extend({name:"Dashboard",data(){return{leftDrawerOpen:!1,title:"Home",workingBuilding:{pk:""},cardPK:"",firstName:"",lastName:"",photo:"",navigateTo:""}},methods:{notifyError(t){this.$q.notify({type:"negative",message:t})},onAbout(){this.$router.push({name:"About"})},onLogout(){this.$q.dialog({dark:!1,title:"Confirmation",message:"Are you sure to register a new credential?",cancel:!0,persistent:!0}).onOk(()=>{sessionStorage.clear(),localStorage.clear(),this.$router.push({name:"Login"})})},onAreaDensity(){0!==this.workingBuilding.pk.length?this.$router.push({name:"AreaDensity",params:{id:this.workingBuilding.pk}}):this.notifyError("You are not near by a building.")},onTempAccess(){0!==this.workingBuilding.pk.length?this.$router.push({name:"TempAccessList",params:{id:this.workingBuilding.pk}}):this.notifyError("You are not near by a building.")},getGPSPosition(t){try{this.$q.loading.show(),navigator.geolocation.getCurrentPosition(e=>{this.$q.loading.hide(),t(e.coords.latitude,e.coords.longitude)},t=>{this.$q.loading.hide(),this.notifyError("The location service must be enabled.("+t.message+")")},{maximumAge:3e5,timeout:3e4,enableHighAccuracy:!0})}catch(e){this.$q.loading.hide(),this.notifyError(e.message)}},onSearchBuilding(){this.getGPSPosition((t,e)=>{this.getBuildingList(t,e,!0)})},getBuildingList(t,e,i){this.$q.loading.show(),c["a"].GetBuildingList(this.cardPK,t,e).then(t=>{this.$q.loading.hide(),t.data.ok?this.selectBuilding(t.data.result,i):this.notifyError(t.data.message)}).catch(t=>{this.$q.loading.hide(),this.notifyError(t.message)})},selectBuilding(t,e){if(0===t.length)return this.notifyError("You are not near by a building."),this.workingBuilding.pk="",void(this.title="Home");if(1===t.length)return this.workingBuilding.pk=t[0].pk,void(this.title=t[0].address);const i=new Array;for(const s of t)i.push({label:s.address,value:s.pk});this.$q.dialog({title:"Select a building",message:"",options:{type:"radio",model:i[0].value,items:i},cancel:e,persistent:!0}).onOk(t=>{for(const e of i)e.value===t&&(this.workingBuilding.pk=e.value,this.title=e.label)})},onCategoryList(){0!==this.workingBuilding.pk.length?(this.$store.commit("CachedStore/ADD_APGE","Category"),this.$router.push({name:"Category",params:{id:this.workingBuilding.pk}})):this.notifyError("You are not near by a building.")},onFavorite(){0!==this.workingBuilding.pk.length?this.$router.push({name:"FavoriteList",params:{id:this.workingBuilding.pk}}):this.notifyError("You are not near by a building.")},onScanReader(){if(this.$q.platform.is.cordova)l.scanQRCode(t=>{const e=t.lastIndexOf("/"),i=t.substring(e+1);i.length<32?this.notifyError("The parameter is not valid."):this.getGPSPosition((t,e)=>{this.scanReader(i,t,e)})});else{const t="https://d3000disttest.azurewebsites.net/VisitorScan/#/ReaderDetail/35A24C3EE6DF429886CCFE42F7DC4AEB",e=t.lastIndexOf("/"),i=t.substring(e+1);i.length<32?this.notifyError("The parameter is not valid."):this.getGPSPosition((t,e)=>{this.scanReader(i,t,e)})}},scanReader(t,e,i){const s=r["a"].decryptPK(t.substring(0,32));this.$q.loading.show(),d["a"].OpenByReader({cardPK:this.cardPK,readerPK:s,latitude:e,longitude:i}).then(t=>{this.$q.loading.hide(),t.data.ok?this.$q.notify({type:"positive",message:t.data.message}):this.notifyError(t.data.message)}).catch(t=>{this.notifyError(t.message),this.$q.loading.hide()})},showShortCuts(t,e,i){this.$q.loading.show(),c["a"].GetBuilding({cardPK:this.cardPK,buildingPK:t.buildingPK,latitude:e,longitude:i}).then(e=>{if(this.$q.loading.hide(),e.data.ok)switch(this.workingBuilding.pk=t.buildingPK,this.title=e.data.result.address,t.shortCutType){case"com.redcoats.virtualkey.openelevator":{const e=t.userInfo;u.openElevator(e.cardPK,e.buildingPK,e.groupId,e.srcFloor,e.dstFloor,(t,e,i)=>{switch(this.$store.commit("FloorStore/ADD_LAYOUT",{leftLayout:i.left,rightLayout:i.right}),i.heading){case 0:this.$router.push({name:"MapNorth",params:{buildingPK:t,groupId:e.toString()}});break;case 1:this.$router.push({name:"MapEast",params:{buildingPK:t,groupId:e.toString()}});break;case 2:this.$router.push({name:"MapSouth",params:{buildingPK:t,groupId:e.toString()}});break;case 3:this.$router.push({name:"MapWest",params:{buildingPK:t,groupId:e.toString()}});break;default:this.$router.push({name:"MapNorth",params:{buildingPK:t,groupId:e.toString()}});break}})}break;case"com.redcoats.virtualkey.opendoor":{const e=t.userInfo;u.OpenDoor(e.doorPK,e.cardPK)}break;default:this.notifyError("We can not identify the shortcut "+this.title);break}else this.notifyError(e.data.message)}).catch(t=>{this.$q.loading.hide(),this.notifyError(t.message)})}},mounted(){const t=r["a"].getRemeberMe();if(!t)return void this.$router.replace({name:"Login"});const e=this.$store.getters["UserStore/GET_USER"];if(e.pk){this.cardPK=e.pk,this.firstName=e.firstName,this.lastName=e.lastName,this.photo=e.photo;let t=!1;if(this.$q.platform.is.ios){const e=u.getActivatedShortcuts();e&&(t=!0,this.getGPSPosition((t,i)=>{this.showShortCuts(e,t,i)}))}t||this.workingBuilding.pk||this.getGPSPosition((t,e)=>{this.getBuildingList(t,e,!1)})}else this.$router.replace({name:"Login"})}}),p=g,m=(i("1001"),i("88fb"),i("2877")),b=Object(m["a"])(p,s,a,!1,null,"6b2a43da",null);e["default"]=b.exports},ecb6:function(t,e,i){"use strict";var s=i("2fd9"),a=i.n(s);a.a},ef09:function(t,e,i){"use strict";var s=i("980d"),a=i.n(s);a.a},f11e:function(t,e,i){"use strict";var s=i("94b5"),a=i.n(s);a.a},f23e:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-layout",{attrs:{view:"lHh Lpr lFf"}},[s("q-header",{attrs:{elevated:""}},[s("q-toolbar",[s("q-btn",{attrs:{flat:"",dense:"",round:"",icon:"keyboard_backspace"},on:{click:t.onBack}}),s("q-toolbar-title",[t._v(t._s(t.title))])],1)],1),s("q-page-container",[s("q-page",[s("div",{staticClass:"text row q-mt-lg q-mb-md text-h5 font-weight-bold text-blue-grey-4 justify-center"},[t._v("\n        "+t._s(t.area)+"\n      ")]),t._l(t.list,(function(e,a){return s("q-list",{key:a,staticClass:"text-h6",attrs:{bordered:"",separator:""}},[s("q-slide-item",{attrs:{"left-color":"white"},on:{left:function(i){return t.onOpenDoor(e.pk,i)}},scopedSlots:t._u([e.canEnterIn?{key:"left",fn:function(){return[s("q-item",{staticClass:"slide-item-wrapper"},[s("q-avatar",{staticClass:"slide-icon q-mt-xs",attrs:{color:"green",size:"40px"}},[s("img",{attrs:{src:i("6f8d"),draggable:"false"}})]),s("q-item-section",{staticClass:"open-door-name text-h6 text-black q-ml-md"},[t._v("\n                "+t._s(e.name.length>7?e.name.substring(0,6)+"...":e.name)+"\n              ")])],1)]},proxy:!0}:null],null,!0)},[s("q-item",[s("q-item-section",{attrs:{avatar:""}},[s("q-avatar",{class:{"green-lock":e.status,"primary-lock":!e.status},attrs:{color:e.status?"green":"primary","text-color":"white",icon:e.status?"lock_open":"lock"}})],1),s("q-item-section",{class:{"canNot-enterIn":!e.canEnterIn}},[t._v(t._s(e.canEnterIn?e.name:e.name+" (Currently At Capacity)"))]),s("q-item-section",{attrs:{side:""}},[s("q-item-label",{attrs:{caption:""}},[t._v("Swipe")]),s("q-item-section",{attrs:{avatar:""}},[s("q-avatar",{staticClass:"arrow",attrs:{rounded:""}},[s("img",{attrs:{src:i("c5d4"),draggable:"false"}})])],1)],1)],1)],1)],1)}))],2)],1)],1)},a=[],o=i("2b0e"),r=i("d257"),n=i("3553"),l=o["a"].extend({name:"TempAccessList",data(){return{title:"",area:"",cardPK:"",buildingPK:"",list:new Array,idleTimebegin:0,idleTimeoutId:0}},methods:{notifyError(t){this.$q.notify({type:"negative",message:t})},startIdleTimout(){this.idleTimeoutId=window.setTimeout(()=>{this.doIdleWork()},1e3)},doIdleWork(){const t=Math.floor(((new Date).getTime()-this.idleTimebegin)/6e4);if(t>3)this.onBack();else{for(const t of this.list)if(t.status&&t.unLockBegin>0){const e=Math.floor(((new Date).getTime()-t.unLockBegin)/1e3);e>5&&(t.status=!1,t.reset());break}this.startIdleTimout()}},onBack(){this.$router.back()},getGPSPosition(t){try{this.$q.loading.show(),navigator.geolocation.getCurrentPosition(e=>{this.$q.loading.hide(),t(e.coords.latitude,e.coords.longitude)},t=>{this.$q.loading.hide(),this.notifyError("The location service must be enabled.("+t.message+")"),this.onBack()},{maximumAge:3e5,timeout:3e4,enableHighAccuracy:!0})}catch(e){this.$q.loading.hide(),this.notifyError(e.message),this.onBack()}},getListByTempAccess(t,e){this.$q.loading.show(),n["a"].GetListByTemp({cardPK:this.cardPK,buildingPK:this.buildingPK,latitude:t,longitude:e}).then(t=>{if(this.$q.loading.hide(),t.data.ok){this.title=t.data.address,this.area="Temp Access List";for(const e of t.data.result){const t=e.isUnLock?(new Date).getTime():0;this.list.push({pk:e.pk,name:e.name,canEnterIn:!0,status:e.isUnLock,unLockBegin:t,reset:()=>({})})}this.idleTimebegin=(new Date).getTime(),this.startIdleTimout()}else this.notifyError(t.data.message),this.onBack()}).catch(t=>{this.$q.loading.hide(),this.notifyError(t.message),this.onBack()})},onOpenDoor(t,{reset:e}){this.idleTimebegin=(new Date).getTime();const i=this.getByPK(t);i&&!i.status?(this.$q.loading.show(),i.unLockBegin=0,i.reset=e,n["a"].OpenDoor(t,this.cardPK).then(t=>{this.$q.loading.hide(),this.idleTimebegin=(new Date).getTime(),t.data.ok?(i.status=!0,i.unLockBegin=(new Date).getTime()):(i.status=!1,e(),this.notifyError(t.data.message))}).catch(t=>{this.notifyError(t.message),this.$q.loading.hide(),i.status=!1,e(),this.idleTimebegin=(new Date).getTime()})):e()},getByPK(t){for(const e of this.list)if(e.pk===t)return e}},mounted(){const t=this.$route.params.id;if(!t)return this.notifyError("The parameter is not valid."),void this.onBack();this.cardPK=r["a"].getRemeberMe(),this.buildingPK=t,this.getGPSPosition((t,e)=>{this.getListByTempAccess(t,e)})},beforeDestroy(){this.idleTimeoutId&&clearTimeout(this.idleTimeoutId)}}),d=l,c=(i("3284"),i("2877")),h=Object(c["a"])(d,s,a,!1,null,"2a1209f6",null);e["default"]=h.exports},f5a8:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("q-layout",{attrs:{view:"lHh Lpr lFf"}},[i("q-header",{attrs:{elevated:""}},[i("q-toolbar",[i("q-btn",{attrs:{flat:"",dense:"",round:"",icon:"keyboard_backspace"},on:{click:t.onBack}}),i("q-toolbar-title",[t._v(t._s(t.title))])],1)],1),i("q-page-container",{staticClass:"q-pl-md q-pr-md"},[i("q-page",[i("div",{staticClass:"row q-gutter-y-md reverse-wrap button-wrapper justify-center"},t._l(t.list,(function(e,s){return i("div",{key:s,staticClass:"col-12"},[i("q-btn",{staticClass:"button text-subtitle1 text-weight-bold",attrs:{"text-color":"black",label:e.floorName},on:{click:function(i){return t.onFloor(e.floorId,e.floorMaskName)}}})],1)})),0)])],1)],1)},a=[],o=i("2b0e"),r=i("44ef"),n=o["a"].extend({name:"SrcFloorList",data(){return{title:"Select your location",buildingPK:"",groupId:0,list:new Array,idleTimebegin:0,idleTimeoutId:0}},methods:{notifyError(t){this.$q.notify({type:"negative",message:t})},startIdleTimout(){this.idleTimeoutId=window.setTimeout(()=>{this.doIdleWork()},1e3)},doIdleWork(){const t=Math.floor(((new Date).getTime()-this.idleTimebegin)/6e4);t>3?this.onBack():this.startIdleTimout()},onBack(){this.$router.back()},getList(){this.$q.loading.show(),r["a"].GetFloorList(this.buildingPK,this.groupId).then(t=>{this.$q.loading.hide(),t.data.ok?(this.list=t.data.result,this.idleTimebegin=(new Date).getTime(),this.startIdleTimout()):(this.notifyError(t.data.message),this.onBack())}).catch(t=>{this.$q.loading.hide(),this.notifyError(t.message),this.onBack()})},onFloor(t,e){this.$router.replace({name:"DstFloorList",params:{id:this.buildingPK,group:this.groupId.toString(),srcFloor:t.toString(),srcFloorName:e}})}},mounted(){const t=this.$route.params.id,e=this.$route.params.group;if(!t||!e)return this.notifyError("The parameter is not valid."),void this.onBack();this.buildingPK=t,this.groupId=Number.parseInt(e),this.getList()},beforeDestroy(){this.idleTimeoutId&&clearTimeout(this.idleTimeoutId)}}),l=n,d=(i("d294"),i("2877")),c=Object(d["a"])(l,s,a,!1,null,"1f89e463",null);e["default"]=c.exports},f621:function(t,e,i){"use strict";var s=i("dc61"),a=i.n(s);a.a},fc00:function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var s=i("2c75");class a{static Add(t){return s["a"].post("BizFavorite_Add",t)}static GetList(t){return s["a"].post("BizFavorite_GetList",t)}static Remove(t,e){const i={cardPK:t,doors:e};return s["a"].post("BizFavorite_Remove",i)}static RenameList(t){return s["a"].post("BizFavorite_RenameList",t)}static SortList(t,e,i){const a={cardPK:t,buildingPK:e,doors:i};return s["a"].post("BizFavorite_SortList",a)}}}}]);