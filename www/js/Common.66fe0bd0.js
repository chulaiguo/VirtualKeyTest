(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[1],{"013f":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("q-layout",[i("q-page-container",[i("q-page",{staticClass:"flex flex-center login-page"},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.appUpdater.isLatest,expression:"appUpdater.isLatest"}],staticClass:"form-wrap"},[i("q-form",{staticClass:"q-gutter-sm",on:{submit:t.onLogin}},[i("div",{staticClass:"logo"}),i("q-input",{attrs:{dark:"",color:"white",label:"Sitecode",rules:[function(t){return t&&t.length>0||"Please input your sitecode"}]},model:{value:t.sitecode,callback:function(e){t.sitecode=e},expression:"sitecode"}}),i("q-input",{attrs:{dark:"",color:"white",label:"Encoded",rules:[function(t){return t&&t.length>0||"Please input your encoded"}]},model:{value:t.encoded,callback:function(e){t.encoded=e},expression:"encoded"}}),i("q-input",{attrs:{dark:"",color:"white",label:"First Name",rules:[function(t){return t&&t.length>0||"Please input your first name"}]},model:{value:t.firstName,callback:function(e){t.firstName=e},expression:"firstName"}}),i("q-input",{attrs:{dark:"",color:"white",label:"Last Name",rules:[function(t){return t&&t.length>0||"Please input your last name"}]},model:{value:t.lastName,callback:function(e){t.lastName=e},expression:"lastName"}}),i("q-input",{attrs:{dark:"",color:"white",label:"Email",rules:[function(t){return t&&t.length>0||"Please input your email address"}]},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}}),i("div",[i("q-btn",{staticClass:"full-width",attrs:{label:"Register",type:"submit",color:"white","text-color":"black"}})],1)],1),i("div",{staticClass:"version"},[i("p",[t._v(t._s("Version: "+t.appUpdater.version))])])],1),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.appUpdater.isLatest,expression:"!appUpdater.isLatest"}]},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.appUpdater.isAndroid,expression:"appUpdater.isAndroid"}],staticStyle:{"text-align":"center"}},[i("h5",{staticStyle:{"margin-bottom":"0"}},[t._v(t._s(t.appUpdater.updateTitle))]),i("q-linear-progress",{staticStyle:{height:"20px"},attrs:{value:t.appUpdater.downloadProcessValue/100,rounded:""}},[i("div",{staticClass:"absolute-full flex flex-center"},[i("q-badge",{attrs:{color:"white","text-color":"accent",label:t.appUpdater.downloadProcessValue+"%"}})],1)])],1),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.appUpdater.isAndroid,expression:"!appUpdater.isAndroid"}],staticStyle:{"text-align":"center"}},[i("h5",{staticStyle:{"margin-bottom":"0"}},[t._v(t._s(t.appUpdater.updateTitle))]),i("q-linear-progress",{staticStyle:{height:"20px"},attrs:{value:t.appUpdater.downloadProcessValue/100,rounded:""}},[i("div",{staticClass:"absolute-full flex flex-center"},[i("q-badge",{attrs:{color:"white","text-color":"accent",label:t.appUpdater.downloadProcessValue+"%"}})],1)])],1)])])],1)],1)},r=[],s=i("2b0e"),n=i("bc3a"),o=i.n(n),c=i("9d10"),d=i("d257"),u=s["a"].extend({name:"Login",data(){return{sitecode:"",encoded:"",firstName:"",lastName:"",email:"",appUpdater:{isLatest:!1,isAndroid:!1,updateTitle:"Checking new version ...",updateBaseUrl:"https://rciupdatetest.azurewebsites.net/RCAppsHome",appName:"VirtualKey",version:"1.0.0",downloadProcessValue:0}}},methods:{showError(t){this.$q.dialog({title:"Error",message:t})},onLogin(){this.$q.loading.show(),c["a"].Register({sitecode:this.sitecode,encoded:this.encoded,firstName:this.firstName,lastName:this.lastName,email:this.email}).then(t=>{this.$q.loading.hide(),t.data.ok?(d["a"].setAuthorization(t.data.authorization),d["a"].setCard({pk:t.data.cardPK,firstName:this.firstName,lastName:this.lastName,email:this.email}),this.$router.push({name:"Activate"})):this.showError(t.data.message)}).catch(t=>{this.$q.loading.hide(),this.showError(t.message)})},autoLogin(){const t=d["a"].getRemeberMe();if(!t)return;this.$q.loading.show();const e="D3000.VirtualKey",i=d["a"].getTicks().toString(),a=d["a"].encryptPassword(i,"7E57C707-F028-45C1-9F80-625A70A60D11");c["a"].Login({userId:e,password:a,ticks:i,cardPK:t}).then(e=>{this.$q.loading.hide(),e.data.ok?(d["a"].setAuthorization(e.data.authorization),d["a"].setCard({pk:t,firstName:e.data.entity.firstName,lastName:e.data.entity.lastName,email:e.data.entity.email}),this.$router.replace({name:"Dashboard"})):this.showError(e.data.message)}).catch(t=>{this.$q.loading.hide(),this.showError(t.message),console.log("3")})},checkVersion(t){this.$q.platform.is.android?this.appUpdater.isAndroid=!0:this.appUpdater.isAndroid=!1,this.appUpdater.isAndroid?this.checkAndroidVersion(e=>{e?this.updateApp():t()}):this.checkIOSVersion(e=>{e?this.updateApp():t()})},checkAndroidVersion(t){const e=`${this.appUpdater.updateBaseUrl}/${this.appUpdater.appName}/${this.appUpdater.appName}.txt`;o.a.get(e).then(e=>{const i=e.data.Version;i!=this.appUpdater.version?(this.appUpdater.updateTitle="Downloading new version...",t(!0)):t(!1)}).catch(t=>{this.showUpdateError(t.message)})},checkIOSVersion(t){const e=`${this.appUpdater.updateBaseUrl}/${this.appUpdater.appName}/${this.appUpdater.appName}.plist`;o.a.get(e).then(e=>{let i="";const a=e.data.split(/\r\n|[\r\n]/);for(let t=0;t<a.length;t++){const e=a[t];if(e.endsWith("<key>bundle-version</key>")&&t+1<a.length){const e=a[t+1].indexOf("<string>");i=a[t+1].substring(e+8,e+8+5)}}i.length>0&&i!=this.appUpdater.version?(this.appUpdater.updateTitle="Updating the App, please wait...",t(!0)):t(!1)}).catch(t=>{this.showUpdateError(t.message)})},updateApp(){if(this.appUpdater.isAndroid){const t=(new Date).getTime(),e=`${this.appUpdater.updateBaseUrl}/${this.appUpdater.appName}/${this.appUpdater.appName}.apk?v=${t}`;this.updateAndroid(e)}else{const t=`itms-services://?action=download-manifest&url=${this.appUpdater.updateBaseUrl}/${this.appUpdater.appName}/${this.appUpdater.appName}.plist`;this.updateIOS(t)}},updateAndroid(t){const e=this;window.resolveLocalFileSystemURL(cordova.file.externalDataDirectory,(function(i){i.getFile(e.appUpdater.appName+".apk",{create:!0,exclusive:!1},(function(i){o()({method:"GET",url:t,responseType:"blob",onDownloadProgress(t){t.lengthComputable&&e.$nextTick(()=>{e.appUpdater.downloadProcessValue=Math.round(t.loaded/t.total*100)})}}).then(t=>{const e=new Blob([t.data],{type:"application/vnd.android.package-archive"});i.createWriter((function(t){t.onwriteend=function(){cordova.plugins.fileOpener2.open(i.toInternalURL(),"application/vnd.android.package-archive")},t.write(e)}))}).catch(t=>{e.showUpdateError("download error: "+t.message)})}),t=>{e.showUpdateError("error getting file! "+t.message)})}),t=>{e.showUpdateError("error getting persistent fs! "+t.code)})},updateIOS(t){cordova.InAppBrowser.open(t,"_system","location=no"),this.simulateDownloadIOS()},simulateDownloadIOS(){setTimeout(()=>{this.appUpdater.downloadProcessValue>=100?cordova.plugins.exit():(this.$nextTick(()=>{this.appUpdater.downloadProcessValue+=10}),this.simulateDownloadIOS())},1e3)},showUpdateError(t){navigator.notification.alert(t,()=>{cordova.plugins.exit()})}},mounted(){this.appUpdater.isLatest=!0,this.autoLogin()}}),l=u,p=(i("4807"),i("2c53"),i("2877")),h=Object(p["a"])(l,a,r,!1,null,"9bcb821e",null);e["default"]=h.exports},"21e4":function(t,e,i){"use strict";var a=i("2ae5"),r=i.n(a);r.a},"2ae5":function(t,e,i){},"2c53":function(t,e,i){"use strict";var a=i("b47d"),r=i.n(a);r.a},"2c75":function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var a=i("bc3a"),r=i.n(a);r.a.defaults.timeout=5e4,r.a.defaults.baseURL="https://d3000apitest.azurewebsites.net/api/Virtualkey/",r.a.interceptors.request.use((function(t){const e=sessionStorage.getItem("D3000_VirtualKey_authorization")||"";return e&&(t.headers.Authorization="Basic "+e),t.url=t.url+"?access_token=73FBF94A-3F5E-7190-9252-95924D4DBBD1",t}),(function(t){return Promise.reject(t)})),r.a.interceptors.response.use((function(t){return t}),(function(t){return Promise.reject(t)}));class s{static post(t,e,i){return r.a.post(t,e,i)}}},4807:function(t,e,i){"use strict";var a=i("7d92"),r=i.n(a);r.a},6674:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("q-layout",{attrs:{view:"lHh Lpr lFf"}},[i("q-header",{attrs:{elevated:""}},[i("q-toolbar",[i("q-btn",{attrs:{flat:"",dense:"",round:"",icon:"keyboard_backspace"},on:{click:t.onBack}}),i("q-toolbar-title",[t._v(t._s(t.title))])],1)],1),i("q-page-container",[i("q-page",t._l(t.list,(function(e,a){return i("q-list",{key:a,attrs:{bordered:"",separator:""}},[i("q-slide-item",{on:{left:function(i){return t.onOpenDoor(e.pk,e.isUnLock)},right:function(i){return t.onOpenDoor(e.pk,e.isUnLock)}},scopedSlots:t._u([{key:"left",fn:function(){return[i("div",{staticClass:"row items-center"},[i("q-icon",{attrs:{left:"",name:"lock_open"}}),t._v(" Opening...\n            ")],1)]},proxy:!0},{key:"right",fn:function(){return[i("div",{staticClass:"row items-center"},[t._v("\n              Opening..."),i("q-icon",{attrs:{left:"",name:"lock_open"}})],1)]},proxy:!0}],null,!0)},[i("q-item",[i("q-item-section",{attrs:{avatar:""}},[i("q-avatar",{attrs:{color:"primary","text-color":"white",icon:"lock"}})],1),i("q-item-section",{on:{click:function(i){return t.onOpenDoor(e.pk,e.isUnLock)}}},[t._v(t._s(e.name))])],1)],1)],1)})),1)],1)],1)},r=[],s=i("2b0e"),n=i("d257"),o=i("2c75");class c{static GetDoorList(t){return o["a"].post("BizReader_GetDoorList",t)}static OpenDoor(t,e){const i={doorPK:t,isUnLock:e};return o["a"].post("BizReader_OpenDoor",i)}}var d=s["a"].extend({name:"ReaderDetail",data(){return{title:"",cardPK:"",readerType:"",readerPK:"",watchGPSID:0,list:new Array}},methods:{notifyError(t){this.$q.notify(t)},showError(t){this.$q.dialog({title:"Error",message:t})},onBack(){this.$router.replace({name:"Dashboard"})},getGPSPosition(t){try{this.$q.loading.show(),this.watchGPSID=navigator.geolocation.watchPosition(e=>{this.$q.platform.is.ios&&e.coords.accuracy>30||(navigator.geolocation.clearWatch(this.watchGPSID),this.$q.loading.hide(),t(e.coords.latitude,e.coords.longitude))},t=>{this.$q.loading.hide(),this.showError("The location service must be enabled.("+t.message+")"),this.$router.replace({name:"Dashboard"})},{maximumAge:6e4,timeout:3e4,enableHighAccuracy:!0})}catch(e){this.$q.loading.hide(),this.showError(e.message),this.$router.replace({name:"Dashboard"})}},getDoorList(t,e){this.$q.loading.show(),c.GetDoorList({cardPK:this.cardPK,readerPK:this.readerPK,readerType:this.readerType,latitude:t,longitude:e}).then(t=>{this.$q.loading.hide(),t.data.ok?(this.title=t.data.address,this.list=t.data.result):(this.showError(t.data.message),this.$router.replace({name:"Dashboard"}))}).catch(t=>{this.$q.loading.hide(),this.showError(t.message),this.$router.replace({name:"Dashboard"})})},onOpenDoor(t,e){this.$q.loading.show(),c.OpenDoor(t,e).then(t=>{this.$q.loading.hide(),t.data.ok?(this.showError("The door has been opened."),this.$router.replace({name:"Dashboard"})):(this.showError(t.data.message),this.$router.replace({name:"Dashboard"}))}).catch(t=>{this.showError(t.message),this.$q.loading.hide(),this.$router.replace({name:"Dashboard"})})}},mounted(){const t=this.$route.params.id;if(!t||t.length<33)return this.showError("The parameter does not valid."),void this.$router.replace({name:"Dashboard"});this.readerType=t.substring(32),this.readerPK=n["a"].decryptPK(t.substring(0,32));const e=n["a"].getCard();this.cardPK=e.pk,this.getDoorList(0,0)}}),u=d,l=i("2877"),p=Object(l["a"])(u,a,r,!1,null,"2bc862ed",null);e["default"]=p.exports},"7d92":function(t,e,i){},"9d10":function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var a=i("2c75");class r{static Activate(t,e){const i={email:t,verifyCode:e};return a["a"].post("BizLogin_Activate",i)}static Login(t){return a["a"].post("BizLogin_Login",t)}static Register(t){return a["a"].post("BizLogin_Register",t)}static SendVerifyCode(t){const e={email:t};return a["a"].post("BizLogin_SendVerifyCode",e)}}},b47d:function(t,e,i){},c19d:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("q-layout",[i("q-page-container",[i("q-page",{staticClass:"flex flex-center"},[i("div",[i("div",{staticClass:"input-content"},[i("input",{directives:[{name:"model",rawName:"v-model.trim.number",value:t.input1,expression:"input1",modifiers:{trim:!0,number:!0}}],ref:"input1",attrs:{type:"number",maxlength:"1"},domProps:{value:t.input1},on:{keydown:function(e){return t.keydown1(e)},keyup:function(e){return t.keyup1(e)},input:function(e){e.target.composing||(t.input1=t._n(e.target.value.trim()))},blur:function(e){return t.$forceUpdate()}}}),i("input",{directives:[{name:"model",rawName:"v-model.trim.number",value:t.input2,expression:"input2",modifiers:{trim:!0,number:!0}}],ref:"input2",attrs:{type:"number",maxlength:"1"},domProps:{value:t.input2},on:{keydown:function(e){return t.keydown2(e)},keyup:function(e){return t.keyup2(e)},input:function(e){e.target.composing||(t.input2=t._n(e.target.value.trim()))},blur:function(e){return t.$forceUpdate()}}}),i("input",{directives:[{name:"model",rawName:"v-model.trim.number",value:t.input3,expression:"input3",modifiers:{trim:!0,number:!0}}],ref:"input3",attrs:{type:"number",maxlength:"1"},domProps:{value:t.input3},on:{keydown:function(e){return t.keydown3(e)},keyup:function(e){return t.keyup3(e)},input:function(e){e.target.composing||(t.input3=t._n(e.target.value.trim()))},blur:function(e){return t.$forceUpdate()}}}),i("input",{directives:[{name:"model",rawName:"v-model.trim.number",value:t.input4,expression:"input4",modifiers:{trim:!0,number:!0}}],ref:"input4",attrs:{type:"number",maxlength:"1"},domProps:{value:t.input4},on:{keydown:function(e){return t.keydown4(e)},keyup:function(e){return t.keyup4(e)},input:function(e){e.target.composing||(t.input4=t._n(e.target.value.trim()))},blur:function(e){return t.$forceUpdate()}}}),i("input",{directives:[{name:"model",rawName:"v-model.trim.number",value:t.input5,expression:"input5",modifiers:{trim:!0,number:!0}}],ref:"input5",attrs:{type:"number",maxlength:"1"},domProps:{value:t.input5},on:{keydown:function(e){return t.keydown5(e)},keyup:function(e){return t.keyup5(e)},input:function(e){e.target.composing||(t.input5=t._n(e.target.value.trim()))},blur:function(e){return t.$forceUpdate()}}}),i("input",{directives:[{name:"model",rawName:"v-model.trim.number",value:t.input6,expression:"input6",modifiers:{trim:!0,number:!0}}],ref:"input6",attrs:{type:"number",maxlength:"1"},domProps:{value:t.input6},on:{keydown:function(e){return t.keydown6(e)},keyup:function(e){return t.keyup6(e)},input:function(e){e.target.composing||(t.input6=t._n(e.target.value.trim()))},blur:function(e){return t.$forceUpdate()}}})]),i("div",{staticClass:"resend text-center"},[i("q-btn",{attrs:{disable:t.timeoutSeconds>0,color:0===t.timeoutSeconds?"secondary":"dark",icon:"mail","icon-right":"send",label:0===t.timeoutSeconds?"Resend Verify code":"Resend Verify code ("+t.timeoutSeconds+")"},on:{click:t.onResendVerifyCode}})],1),i("div",{staticClass:"activate"},[i("q-btn",{staticClass:"full-width",attrs:{label:"Activate",type:"submit",color:"primary"},on:{click:t.onLogin}})],1)])])],1)],1)},r=[],s=i("2b0e"),n=i("9d10"),o=i("d257"),c=s["a"].extend({name:"Activate",data(){return{pk:"",email:"",input1:"",input2:"",input3:"",input4:"",input5:"",input6:"",timeoutSeconds:60}},methods:{showError(t){this.$q.dialog({title:"Error",message:t})},onResendVerifyCode(){this.$q.loading.show(),n["a"].SendVerifyCode(this.email).then(t=>{this.$q.loading.hide(),t.data.ok?(this.timeoutSeconds=60,this.startResendTimout()):this.showError(t.data.message)}).catch(t=>{this.$q.loading.hide(),this.showError(t.message)})},onLogin(){if(0===this.input1.length||0===this.input2.length||0===this.input3.length||0===this.input4.length||0===this.input5.length||0===this.input6.length)return void this.showError("Please input the verify code firstly.");this.$q.loading.show();const t=this.input1+this.input2+this.input3+this.input4+this.input5+this.input6;n["a"].Activate(this.email,t).then(t=>{this.$q.loading.hide(),t.data.ok?(o["a"].setRemeberMe(this.pk),this.$router.replace({name:"Dashboard"})):this.showError(t.data.message)}).catch(t=>{this.$q.loading.hide(),this.showError(t.message)})},startResendTimout(){setTimeout(()=>{this.setResendTimout()},1e3)},setResendTimout(){this.timeoutSeconds-=1,this.timeoutSeconds>0&&this.startResendTimout()},keydown1(t){8===t.keyCode&&(this.input1.length>0?this.input1="":this.$nextTick(()=>{this.$refs.input1.focus(),this.input1=""}))},keydown2(t){8===t.keyCode&&(this.input2.length>0?this.input2="":this.$nextTick(()=>{this.$refs.input1.focus(),this.input1=""}))},keydown3(t){8===t.keyCode&&(this.input3.length>0?this.input3="":this.$nextTick(()=>{this.$refs.input2.focus(),this.input2=""}))},keydown4(t){8===t.keyCode&&(this.input4.length>0?this.input4="":this.$nextTick(()=>{this.$refs.input3.focus(),this.input3=""}))},keydown5(t){8===t.keyCode&&(this.input5.length>0?this.input5="":this.$nextTick(()=>{this.$refs.input4.focus(),this.input4=""}))},keydown6(t){8===t.keyCode&&(this.input6.length>0?this.input6="":this.$nextTick(()=>{this.$refs.input5.focus(),this.input5=""}))},keyup1(t){8!==t.keyCode&&this.$nextTick(()=>{this.$refs.input2.focus(),this.input1=this.input1.toString().slice(-1)})},keyup2(t){8!==t.keyCode&&this.$nextTick(()=>{this.$refs.input3.focus(),this.input2=this.input2.toString().slice(-1)})},keyup3(t){8!==t.keyCode&&this.$nextTick(()=>{this.$refs.input4.focus(),this.input3=this.input3.toString().slice(-1)})},keyup4(t){8!==t.keyCode&&this.$nextTick(()=>{this.$refs.input5.focus(),this.input4=this.input4.toString().slice(-1)})},keyup5(t){8!==t.keyCode&&this.$nextTick(()=>{this.$refs.input6.focus(),this.input5=this.input5.toString().slice(-1)})},keyup6(t){8!==t.keyCode&&this.$nextTick(()=>{this.$refs.input6.blur(),this.input6=this.input6.toString().slice(-1)})}},mounted(){const t=o["a"].getCard();this.pk=t.pk,this.email=t.email,this.startResendTimout(),this.$refs.input1.focus()}}),d=c,u=(i("21e4"),i("2877")),l=Object(u["a"])(d,a,r,!1,null,"994940f2",null);e["default"]=l.exports},d257:function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));class a{static setCard(t){localStorage.setItem("D3000_VirtualKey_card",JSON.stringify(t))}static getCard(){const t=localStorage.getItem("D3000_VirtualKey_card")||"";if(t.length>0){const e=JSON.parse(t);return{pk:e.pk,firstName:e.firstName,lastName:e.lastName,email:e.email}}return{pk:"",firstName:"",lastName:"",email:""}}static setRemeberMe(t){localStorage.setItem("D3000_VirtualKey_key",t)}static getRemeberMe(){return localStorage.getItem("D3000_VirtualKey_key")||""}static clearRemeberMe(){localStorage.removeItem("D3000_VirtualKey_key")}static setAuthorization(t){sessionStorage.setItem("D3000_VirtualKey_authorization",t)}static getAuthorization(){return sessionStorage.getItem("D3000_VirtualKey_authorization")||""}static clearAuthorization(){sessionStorage.removeItem("D3000_VirtualKey_authorization")}static hasAuthorization(){const t=sessionStorage.getItem("D3000_VirtualKey_authorization")||"";return t.length>0}static getTicks(){const t=621355968e9,e=1e4;return t+(new Date).getTime()*e}static encryptPassword(t,e){const i=[];for(let a=0;a<e.length;a++)if(a<t.length){const r=e.charCodeAt(a)+t.charCodeAt(a)-35;i.push(r.toString())}else{const t=e.charCodeAt(a)+5;i.push(t.toString())}return i.join(" ")+" "}static encryptPK(t){return t.replace(/-/g,"")}static decryptPK(t){if(32!==t.length)return t;let e=t.substring(0,8);return e+="-",e+=t.substring(8,12),e+="-",e+=t.substring(12,16),e+="-",e+=t.substring(16,20),e+="-",e+=t.substring(20),e}}},ec95:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("q-layout",{attrs:{view:"lHh Lpr lFf"}},[i("q-header",{attrs:{elevated:""}},[i("q-toolbar",[i("q-btn",{attrs:{flat:"",dense:"",round:"",icon:"menu"},on:{click:function(e){t.leftDrawerOpen=!t.leftDrawerOpen}}}),i("q-toolbar-title",[t._v("Home")])],1)],1),i("q-drawer",{ref:"drawer",attrs:{"show-if-above":"",bordered:""},model:{value:t.leftDrawerOpen,callback:function(e){t.leftDrawerOpen=e},expression:"leftDrawerOpen"}},[i("q-list",[i("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{clickable:""},on:{click:t.onLogout}},[i("q-item-section",{attrs:{avatar:""}},[i("q-icon",{attrs:{name:"person"}})],1),i("q-item-section",[i("q-item-label",[t._v("Logout")])],1)],1)],1)],1),i("q-page-container",[i("q-page",{staticClass:"text-center"},[i("div",[i("h4",[t._v("Welcome")]),i("h5",[t._v(t._s(t.firstName+" "+t.lastName))]),i("q-list",{attrs:{bordered:"",separator:""}},[i("q-slide-item",{on:{top:t.onScanReader,bottom:t.onScanReader},scopedSlots:t._u([{key:"top",fn:function(){return[i("div",{staticClass:"row items-center"},[i("q-icon",{attrs:{name:"camera",size:"xl"}}),t._v(" Scaning...\n              ")],1)]},proxy:!0},{key:"bottom",fn:function(){return[i("div",{staticClass:"row items-center"},[i("q-icon",{attrs:{name:"camera",size:"xl"}}),t._v(" Scaning...\n              ")],1)]},proxy:!0}])},[i("q-item",{staticStyle:{height:"300px"}},[i("q-item-section",{on:{click:t.onScanReader}},[i("div",[i("q-avatar",{attrs:{color:"primary","text-color":"white",icon:"camera_alt"}}),i("div",{staticStyle:{"margin-top":"20px"}},[t._v("Slide to Scan Reader")])],1)])],1)],1)],1)],1)])],1)],1)},r=[],s=i("2b0e"),n=i("d257"),o=i("b178");class c{static scanQRCode(t){o["b"].is.cordova?cordova.plugins.barcodeScanner.scan(e=>{e.cancelled||t(e.text)},t=>{c.showError("Scanning failed: "+t.message)},{preferFrontCamera:!1,showFlipCameraButton:!0,showTorchButton:!0,torchOn:!1,saveHistory:!0,prompt:"Place a barcode inside the scan area",resultDisplayDuration:500,formats:"QR_CODE",orientation:"portrait",disableAnimations:!0,disableSuccessBeep:!1}):c.showError("Scanning must be in mobile.")}static takePicture(t){o["b"].is.cordova?c.takePictureByCordova(t):o["b"].is.desktop?c.takePictureByDesktop(t):c.takePictureByMobile(t)}static showError(t){o["a"].create({title:"Error",message:t})}static takePictureByCordova(t){const e=navigator.camera;e?e.getPicture(t,()=>{},{quality:45,destinationType:0,sourceType:1,allowEdit:!0,encodingType:0,targetWidth:250,targetHeight:250}):c.showError("The camera does not exist in the cordova.")}static takePictureByDesktop(t){const e=document.createElement("input");e.setAttribute("type","file"),e.setAttribute("accept","image/*;capture=camera"),e.addEventListener("change",e=>{const i=e.currentTarget;if(!i||!i.files)return;const a=i.files[0];if(!a)return;const r=new FileReader;r.addEventListener("load",e=>{if(!e.target||!e.target.result)return;const i=e.target.result,a=document.createElement("canvas"),r=document.createElement("img");r.addEventListener("error",()=>{alert("Fail to load image(desktop).")}),r.addEventListener("load",()=>{const e=250;a.width=e,a.height=e;const i=a.getContext("2d");if(!i)return;let s,n;i.clearRect(0,0,e,e);let o=0,c=0;r.width>r.height?(s=Math.round(e*r.width/r.height),n=e,o=-Math.round((s-e)/2)):(n=Math.round(e*r.height/r.width),s=e,c=-Math.round((n-e)/2)),i.drawImage(r,o,c,s,n);const d=a.toDataURL("image/jpeg",.5),u=d.substr(23);t(u)},!1),r.setAttribute("src",i)}),r.readAsDataURL(a)}),e.click()}static takePictureByMobile(t){const e=document.createElement("input");e.setAttribute("type","file"),e.setAttribute("accept","image/*;capture=camera"),e.addEventListener("change",e=>{const i=e.currentTarget;if(!i||!i.files)return;const a=i.files[0];if(!a)return;const r=document.createElement("img");r.addEventListener("error",()=>{alert("Fail to load image(mobile).")}),r.addEventListener("load",()=>{window.URL.revokeObjectURL(r.src);const e=document.createElement("canvas"),i=250;e.width=i,e.height=i;const a=e.getContext("2d");if(!a)return;let s,n;a.clearRect(0,0,i,i);let o=0,c=0;r.width>r.height?(s=Math.round(i*r.width/r.height),n=i,o=-Math.round((s-i)/2)):(n=Math.round(i*r.height/r.width),s=i,c=-Math.round((n-i)/2)),a.drawImage(r,o,c,s,n);const d=e.toDataURL("image/jpeg",.5),u=d.substr(23);t(u)},!1),r.setAttribute("src",window.URL.createObjectURL(a))}),e.click()}}var d=s["a"].extend({name:"Dashboard",data(){return{leftDrawerOpen:!1,firstName:"",lastName:""}},methods:{showError(t){this.$q.dialog({title:"Error",message:t})},onLogout(){sessionStorage.clear(),localStorage.clear(),this.$router.push({name:"Login"})},onScanReader(){if(this.$q.platform.is.cordova)c.scanQRCode(t=>{const e=t.lastIndexOf("/"),i=t.substring(e+1);this.$router.push({name:"ReaderDetail",params:{id:i}})});else{const t="https://d3000disttest.azurewebsites.net/VisitorScan/#/ReaderDetail/35A24C3EE6DF429886CCFE42F7DC4AEB2",e=t.lastIndexOf("/"),i=t.substring(e+1);this.$router.push({name:"ReaderDetail",params:{id:i}})}}},mounted(){const t=n["a"].getCard();this.firstName=t.firstName,this.lastName=t.lastName}}),u=d,l=i("2877"),p=Object(l["a"])(u,a,r,!1,null,"4b26de04",null);e["default"]=p.exports}}]);